====
---- QUERY: TPCDS-Q27
select i_item_id,
       s_state, grouping(s_state) g_state,
       avg(ss_quantity) agg1,
       avg(ss_list_price) agg2,
       avg(ss_coupon_amt) agg3,
       avg(ss_sales_price) agg4
from store_sales, customer_demographics, date_dim, store, item
where ss_sold_date_sk = d_date_sk and
      ss_item_sk = i_item_sk and
      ss_store_sk = s_store_sk and
      ss_cdemo_sk = cd_demo_sk and
      cd_gender = 'M' and
      cd_marital_status = 'S' and
      cd_education_status = 'College' and
      d_year = 2002 and
      s_state in ('TN')
group by rollup (i_item_id, s_state)
order by i_item_id
        ,s_state
limit 100
---- RESULTS
'AAAAAAAAAAABAAAA','TN',0,46,114.720000,0.000000,32.120000
'AAAAAAAAAAABAAAA','NULL',1,46,114.720000,0.000000,32.120000
'AAAAAAAAAAAEAAAA','TN',0,100,77.970000,0.000000,57.690000
'AAAAAAAAAAAEAAAA','NULL',1,100,77.970000,0.000000,57.690000
'AAAAAAAAAABAAAAA','TN',0,6,48.890000,13.610000,2.440000
'AAAAAAAAAABAAAAA','NULL',1,6,48.890000,13.610000,2.440000
'AAAAAAAAAACAAAAA','TN',0,62,32.213333,0.000000,5.506667
'AAAAAAAAAACAAAAA','NULL',1,62,32.213333,0.000000,5.506667
'AAAAAAAAAACDAAAA','TN',0,97,161.780000,0.000000,55.000000
'AAAAAAAAAACDAAAA','NULL',1,97,161.780000,0.000000,55.000000
'AAAAAAAAAADBAAAA','TN',0,28,136.010000,575.760000,73.440000
'AAAAAAAAAADBAAAA','NULL',1,28,136.010000,575.760000,73.440000
'AAAAAAAAAADCAAAA','TN',0,64,116.140000,0.000000,108.010000
'AAAAAAAAAADCAAAA','NULL',1,64,116.140000,0.000000,108.010000
'AAAAAAAAAAEBAAAA','TN',0,9,5.430000,0.000000,5.210000
'AAAAAAAAAAEBAAAA','NULL',1,9,5.430000,0.000000,5.210000
'AAAAAAAAAAEDAAAA','TN',0,45.5,87.635000,0.000000,51.840000
'AAAAAAAAAAEDAAAA','NULL',1,45.5,87.635000,0.000000,51.840000
'AAAAAAAAAAGBAAAA','TN',0,29,101.940000,0.000000,100.920000
'AAAAAAAAAAGBAAAA','NULL',1,29,101.940000,0.000000,100.920000
'AAAAAAAAAAGCAAAA','TN',0,97,65.270000,0.000000,21.530000
'AAAAAAAAAAGCAAAA','NULL',1,97,65.270000,0.000000,21.530000
'AAAAAAAAAAGEAAAA','TN',0,55,73.875000,0.000000,71.000000
'AAAAAAAAAAGEAAAA','NULL',1,55,73.875000,0.000000,71.000000
'AAAAAAAAAAHAAAAA','TN',0,20,134.300000,0.000000,119.520000
'AAAAAAAAAAHAAAAA','NULL',1,20,134.300000,0.000000,119.520000
'AAAAAAAAAAHBAAAA','TN',0,97,7.400000,0.000000,6.730000
'AAAAAAAAAAHBAAAA','NULL',1,97,7.400000,0.000000,6.730000
'AAAAAAAAAAHDAAAA','TN',0,69,5.620000,0.000000,0.330000
'AAAAAAAAAAHDAAAA','NULL',1,69,5.620000,0.000000,0.330000
'AAAAAAAAAAIAAAAA','TN',0,87,106.980000,0.000000,27.810000
'AAAAAAAAAAIAAAAA','NULL',1,87,106.980000,0.000000,27.810000
'AAAAAAAAAAKBAAAA','TN',0,84.5,66.175000,847.835000,57.380000
'AAAAAAAAAAKBAAAA','NULL',1,84.5,66.175000,847.835000,57.380000
'AAAAAAAAAALAAAAA','TN',0,6,32.280000,0.000000,7.420000
'AAAAAAAAAALAAAAA','NULL',1,6,32.280000,0.000000,7.420000
'AAAAAAAAAALCAAAA','TN',0,98,34.310000,55.300000,1.710000
'AAAAAAAAAALCAAAA','NULL',1,98,34.310000,55.300000,1.710000
'AAAAAAAAAALDAAAA','TN',0,59,129.470000,713.900000,22.000000
'AAAAAAAAAALDAAAA','NULL',1,59,129.470000,713.900000,22.000000
'AAAAAAAAAANAAAAA','TN',0,74,60.875000,0.000000,13.200000
'AAAAAAAAAANAAAAA','NULL',1,74,60.875000,0.000000,13.200000
'AAAAAAAAAANBAAAA','TN',0,96,130.790000,1864.510000,129.480000
'AAAAAAAAAANBAAAA','NULL',1,96,130.790000,1864.510000,129.480000
'AAAAAAAAAAOAAAAA','TN',0,85,130.340000,0.000000,122.510000
'AAAAAAAAAAOAAAAA','NULL',1,85,130.340000,0.000000,122.510000
'AAAAAAAAAAOCAAAA','TN',0,14,64.575000,0.000000,33.975000
'AAAAAAAAAAOCAAAA','NULL',1,14,64.575000,0.000000,33.975000
'AAAAAAAAAAODAAAA','TN',0,84,30.500000,0.000000,28.970000
'AAAAAAAAAAODAAAA','NULL',1,84,30.500000,0.000000,28.970000
'AAAAAAAAAAPBAAAA','TN',0,45,118.890000,2380.595000,84.715000
'AAAAAAAAAAPBAAAA','NULL',1,45,118.890000,2380.595000,84.715000
'AAAAAAAAABAAAAAA','TN',0,97,124.750000,0.000000,74.850000
'AAAAAAAAABAAAAAA','NULL',1,97,124.750000,0.000000,74.850000
'AAAAAAAAABABAAAA','TN',0,31,29.980000,17.090000,27.580000
'AAAAAAAAABABAAAA','NULL',1,31,29.980000,17.090000,27.580000
'AAAAAAAAABAEAAAA','TN',0,34,17.210000,0.000000,13.420000
'AAAAAAAAABAEAAAA','NULL',1,34,17.210000,0.000000,13.420000
'AAAAAAAAABCBAAAA','TN',0,38,131.375000,0.000000,52.320000
'AAAAAAAAABCBAAAA','NULL',1,38,131.375000,0.000000,52.320000
'AAAAAAAAABDAAAAA','TN',0,31.5,68.345000,0.000000,63.275000
'AAAAAAAAABDAAAAA','NULL',1,31.5,68.345000,0.000000,63.275000
'AAAAAAAAABDBAAAA','TN',0,56,103.850000,1624.170000,59.190000
'AAAAAAAAABDBAAAA','NULL',1,56,103.850000,1624.170000,59.190000
'AAAAAAAAABDDAAAA','TN',0,67.33333333333333,119.420000,23.186667,38.720000
'AAAAAAAAABDDAAAA','NULL',1,67.33333333333333,119.420000,23.186667,38.720000
'AAAAAAAAABDEAAAA','TN',0,61,85.950000,2282.360000,44.605000
'AAAAAAAAABDEAAAA','NULL',1,61,85.950000,2282.360000,44.605000
'AAAAAAAAABEDAAAA','TN',0,61,85.140000,0.000000,50.230000
'AAAAAAAAABEDAAAA','NULL',1,61,85.140000,0.000000,50.230000
'AAAAAAAAABFBAAAA','TN',0,31,23.550000,0.000000,13.650000
'AAAAAAAAABFBAAAA','NULL',1,31,23.550000,0.000000,13.650000
'AAAAAAAAABFCAAAA','TN',0,83,15.500000,0.000000,0.000000
'AAAAAAAAABFCAAAA','NULL',1,83,15.500000,0.000000,0.000000
'AAAAAAAAABGAAAAA','TN',0,64,35.080000,0.000000,3.150000
'AAAAAAAAABGAAAAA','NULL',1,64,35.080000,0.000000,3.150000
'AAAAAAAAABGBAAAA','TN',0,40,25.070000,0.000000,16.040000
'AAAAAAAAABGBAAAA','NULL',1,40,25.070000,0.000000,16.040000
'AAAAAAAAABGEAAAA','TN',0,39.5,56.765000,14.255000,36.005000
'AAAAAAAAABGEAAAA','NULL',1,39.5,56.765000,14.255000,36.005000
'AAAAAAAAABHAAAAA','TN',0,93,74.800000,0.000000,21.690000
'AAAAAAAAABHAAAAA','NULL',1,93,74.800000,0.000000,21.690000
'AAAAAAAAABHCAAAA','TN',0,31.5,79.835000,181.380000,61.935000
'AAAAAAAAABHCAAAA','NULL',1,31.5,79.835000,181.380000,61.935000
'AAAAAAAAABIBAAAA','TN',0,48,170.890000,0.000000,140.120000
'AAAAAAAAABIBAAAA','NULL',1,48,170.890000,0.000000,140.120000
'AAAAAAAAABJAAAAA','TN',0,46.5,82.325000,0.000000,44.985000
'AAAAAAAAABJAAAAA','NULL',1,46.5,82.325000,0.000000,44.985000
'AAAAAAAAABJBAAAA','TN',0,76,12.400000,0.000000,3.960000
'AAAAAAAAABJBAAAA','NULL',1,76,12.400000,0.000000,3.960000
'AAAAAAAAABJDAAAA','TN',0,34,118.505000,0.000000,61.205000
'AAAAAAAAABJDAAAA','NULL',1,34,118.505000,0.000000,61.205000
'AAAAAAAAABKAAAAA','TN',0,65,8.775000,0.000000,5.180000
'AAAAAAAAABKAAAAA','NULL',1,65,8.775000,0.000000,5.180000
'AAAAAAAAABKCAAAA','TN',0,26,51.570000,0.000000,41.250000
'AAAAAAAAABKCAAAA','NULL',1,26,51.570000,0.000000,41.250000
'AAAAAAAAABLBAAAA','TN',0,61.5,149.120000,0.000000,82.540000
'AAAAAAAAABLBAAAA','NULL',1,61.5,149.120000,0.000000,82.540000
'AAAAAAAAABMAAAAA','TN',0,14,109.970000,0.000000,10.990000
'AAAAAAAAABMAAAAA','NULL',1,14,109.970000,0.000000,10.990000
---- TYPES
STRING, STRING, TINYINT, DOUBLE, DECIMAL, DECIMAL, DECIMAL
====
