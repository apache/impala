====
---- QUERY: TPCDS-Q39.1
-- RESULT MISMATCH FROM ORIGINAL
-- ADD ROUND()s TO 4th, 5th, 9th, 10th COLUMNS, TAKE ACTUAL RESULTS AS EXPECTED.
with inv as
(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy
       ,stdev,mean, case mean when 0 then null else stdev/mean end cov
 from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy
            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean
      from inventory
          ,item
          ,warehouse
          ,date_dim
      where inv_item_sk = i_item_sk
        and inv_warehouse_sk = w_warehouse_sk
        and inv_date_sk = d_date_sk
        and d_year =2001
      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo
 where case mean when 0 then 0 else stdev/mean end > 1)
select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy
        ,round(inv1.mean, 2), round(inv1.cov, 8)
        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy
        ,round(inv2.mean, 2), round(inv2.cov, 8)
from inv inv1,inv inv2
where inv1.i_item_sk = inv2.i_item_sk
  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk
  and inv1.d_moy=1
  and inv2.d_moy=1+1
order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov
        ,inv2.d_moy,inv2.mean, inv2.cov
;
---- RESULTS
1,265,1,324.75,1.24383918,1,265,2,329.00,1.01515813
1,363,1,499.50,1.03194157,1,363,2,321.00,1.14117668
1,679,1,373.75,1.09554981,1,679,2,417.50,1.04297099
1,695,1,450.75,1.08358883,1,695,2,368.75,1.13564941
1,789,1,357.25,1.03450938,1,789,2,410.00,1.02842219
1,815,1,216.50,1.17022709,1,815,2,150.50,1.30572815
1,827,1,271.75,1.10468901,1,827,2,424.75,1.16531986
1,1041,1,382.50,1.28480840,1,1041,2,424.75,1.00057727
1,1569,1,212.00,1.63021352,1,1569,2,239.25,1.26415133
1,1623,1,338.25,1.12854833,1,1623,2,261.33,1.27178090
1,2581,1,448.50,1.06042904,1,2581,2,476.25,1.03629847
1,2705,1,246.25,1.01203084,1,2705,2,294.67,1.07421341
1,3131,1,393.75,1.00376140,1,3131,2,480.50,1.06691450
1,3291,1,374.50,1.19518983,1,3291,2,265.25,1.57297211
1,3687,1,279.75,1.42609091,1,3687,2,157.25,1.45343409
1,4955,1,495.25,1.03182962,1,4955,2,322.50,1.16938423
1,5627,1,282.75,1.56570324,1,5627,2,297.50,1.20842868
1,7017,1,175.50,1.04274542,1,7017,2,321.33,1.01833569
1,7317,1,366.33,1.02546640,1,7317,2,378.00,1.21725132
1,7569,1,430.50,1.08743969,1,7569,2,360.25,1.04700556
1,7999,1,166.25,1.79242317,1,7999,2,375.33,1.00809226
1,8319,1,306.75,1.16153780,1,8319,2,276.00,1.14209964
1,8443,1,327.75,1.25671837,1,8443,2,332.50,1.00441673
1,8583,1,319.50,1.02410889,1,8583,2,310.25,1.23588138
1,8591,1,398.00,1.14781687,1,8591,2,355.75,1.00244721
1,8611,1,300.50,1.51915452,1,8611,2,243.75,1.23421228
1,9081,1,367.00,1.08789321,1,9081,2,435.00,1.03305308
1,9357,1,351.67,1.19029226,1,9357,2,427.00,1.04385830
1,9449,1,406.25,1.01831831,1,9449,2,175.00,1.05447798
1,9713,1,242.50,1.10350444,1,9713,2,393.00,1.20847461
1,9809,1,479.00,1.01896025,1,9809,2,317.50,1.06141421
1,9993,1,417.75,1.00998327,1,9993,2,204.50,1.55287075
1,10127,1,239.75,1.05617706,1,10127,2,359.25,1.18579804
1,11159,1,407.25,1.07855072,1,11159,2,250.00,1.33475791
1,11277,1,211.25,1.26158583,1,11277,2,330.75,1.08087680
1,11937,1,344.50,1.08580403,1,11937,2,200.33,1.06385271
1,12373,1,387.75,1.10149048,1,12373,2,306.00,1.07617444
1,12471,1,365.25,1.06075702,1,12471,2,327.25,1.05475606
1,12625,1,279.00,1.30165605,1,12625,2,443.25,1.06049588
1,12751,1,280.75,1.10833058,1,12751,2,369.33,1.34165044
1,12779,1,331.00,1.04169021,1,12779,2,359.00,1.02897806
1,13077,1,367.67,1.34552390,1,13077,2,358.67,1.51324291
1,13191,1,260.25,1.06356963,1,13191,2,405.00,1.01979992
1,13561,1,335.25,1.26096170,1,13561,2,240.00,1.05136045
1,13935,1,311.75,1.03992897,1,13935,2,275.00,1.03675272
1,14687,1,358.00,1.43693569,1,14687,2,187.00,1.54936315
1,14719,1,209.00,1.04115096,1,14719,2,489.00,1.37661688
1,15345,1,148.50,1.52957840,1,15345,2,246.50,1.50879877
1,15427,1,482.75,1.01242389,1,15427,2,333.25,1.27247701
1,15647,1,201.67,1.28579319,1,15647,2,249.25,1.36481730
1,16079,1,280.50,1.24447574,1,16079,2,361.25,1.07378057
1,16223,1,245.67,1.06011490,1,16223,2,412.67,1.06712311
1,16289,1,171.00,1.08726331,1,16289,2,316.50,1.36953067
1,16451,1,300.00,1.25165076,1,16451,2,467.50,1.29623639
1,17051,1,349.75,1.13464238,1,17051,2,319.75,1.03793549
2,71,1,221.50,1.56397411,2,71,2,309.00,1.49170579
2,833,1,363.33,1.04228138,2,833,2,158.75,1.21308917
2,969,1,282.00,1.13743403,2,969,2,386.00,1.13710012
2,1401,1,249.00,1.32062377,2,1401,2,296.67,1.28681219
2,1681,1,337.75,1.05215660,2,1681,2,252.75,1.03179107
2,1991,1,356.00,1.13367900,2,1991,2,273.25,1.33241964
2,2031,1,407.50,1.02098768,2,2031,2,418.75,1.00533886
2,2481,1,319.75,1.11602666,2,2481,2,378.33,1.05971853
2,2725,1,349.75,1.11487049,2,2725,2,265.67,1.54629721
2,3073,1,385.00,1.10208458,2,3073,2,231.75,1.08849891
2,3769,1,334.00,1.19542966,2,3769,2,335.00,1.04946496
2,4085,1,327.75,1.10054139,2,4085,2,281.75,1.01876081
2,4995,1,282.25,1.26041833,2,4995,2,248.00,1.25482290
2,5099,1,418.67,1.06809009,2,5099,2,428.67,1.03523728
2,5211,1,157.00,1.06955174,2,5211,2,270.25,1.19402008
2,5769,1,341.25,1.27231327,2,5769,2,267.00,1.18157918
2,6103,1,194.33,1.51606702,2,6103,2,158.50,1.27436986
2,6243,1,168.50,1.07321081,2,6243,2,386.75,1.08329026
2,6489,1,268.00,1.69563724,2,6489,2,389.00,1.41057805
2,6585,1,183.75,1.11519376,2,6585,2,353.75,1.09397071
2,6767,1,341.00,1.09316398,2,6767,2,235.00,1.13995439
2,7411,1,460.00,1.06282933,2,7411,2,297.50,1.00057654
2,8489,1,126.75,1.34164630,2,8489,2,398.25,1.00411248
2,8633,1,218.50,1.46451897,2,8633,2,230.25,1.31169630
2,8807,1,417.25,1.02581129,2,8807,2,356.25,1.10797306
2,8883,1,249.25,1.11122718,2,8883,2,189.25,1.01007549
2,9253,1,413.33,1.16066599,2,9253,2,465.00,1.02424458
2,9467,1,108.25,1.09112239,2,9467,2,107.00,1.03092204
2,9561,1,190.50,1.03030325,2,9561,2,271.00,1.20583495
2,9575,1,452.50,1.04944922,2,9575,2,155.75,1.15340567
2,9903,1,322.75,1.07610801,2,9903,2,387.33,1.26124068
2,10535,1,324.33,1.05711040,2,10535,2,310.25,1.00406350
2,10955,1,356.00,1.15828133,2,10955,2,339.00,1.07025321
2,12089,1,212.00,1.08275011,2,12089,2,173.33,1.07398122
2,12633,1,402.75,1.00713621,2,12633,2,367.00,1.12705356
2,12765,1,308.00,1.11884769,2,12765,2,347.00,1.15717446
2,13077,1,277.00,1.23233608,2,13077,2,223.50,1.13940034
2,13687,1,361.25,1.01073417,2,13687,2,468.25,1.00984292
2,14025,1,371.75,1.01501361,2,14025,2,141.00,1.25431703
2,14117,1,298.50,1.02512380,2,14117,2,220.25,1.41526845
2,14347,1,366.00,1.03278929,2,14347,2,369.75,1.01857399
2,14697,1,397.75,1.00812054,2,14697,2,328.75,1.16084956
2,14987,1,146.75,1.02900406,2,14987,2,436.50,1.04476815
2,15321,1,527.00,1.21026626,2,15321,2,298.75,1.13090984
2,15347,1,243.00,1.22262398,2,15347,2,310.75,1.20365849
2,15533,1,223.00,1.09651113,2,15533,2,330.00,1.49674885
2,15839,1,353.00,1.50636844,2,15839,2,255.50,1.23623932
2,16107,1,376.00,1.01332463,2,16107,2,364.75,1.06886780
2,16749,1,200.00,1.09447095,2,16749,2,438.25,1.03606466
2,17329,1,321.33,1.30932795,2,17329,2,490.25,1.07565806
2,17417,1,321.75,1.13067648,2,17417,2,534.00,1.00107252
3,1049,1,252.50,1.10906411,3,1049,2,457.25,1.02398412
3,1415,1,247.50,1.13216178,3,1415,2,369.75,1.09546796
3,2199,1,185.75,1.20281256,3,2199,2,300.75,1.07678451
3,2403,1,270.75,1.32587057,3,2403,2,384.00,1.09039872
3,2541,1,364.75,1.07921353,3,2541,2,550.50,1.05455889
3,2727,1,303.75,1.03016470,3,2727,2,219.25,1.38220918
3,3207,1,383.75,1.08545880,3,3207,2,258.25,1.21133925
3,3373,1,404.50,1.01433741,3,3373,2,171.25,1.28566540
3,3969,1,234.25,1.04228318,3,3969,2,217.25,1.42154907
3,4407,1,438.50,1.06566635,3,4407,2,330.75,1.02444040
3,6051,1,289.75,1.26388809,3,6051,2,439.00,1.10457692
3,6521,1,381.00,1.00156829,3,6521,2,437.75,1.03651493
3,6691,1,377.00,1.10907373,3,6691,2,380.50,1.05813013
3,6757,1,282.50,1.08950094,3,6757,2,345.25,1.22638287
3,6915,1,420.67,1.04683456,3,6915,2,292.50,1.25061711
3,7207,1,329.67,1.59544822,3,7207,2,414.50,1.01791971
3,7889,1,318.50,1.28790300,3,7889,2,291.33,1.00429253
3,8559,1,356.25,1.00651935,3,8559,2,393.50,1.01288317
3,8829,1,364.25,1.07928523,3,8829,2,350.25,1.11339122
3,9555,1,377.00,1.13084693,3,9555,2,444.75,1.01715882
3,9623,1,331.33,1.15512893,3,9623,2,284.67,1.03037244
3,9813,1,343.75,1.05169538,3,9813,2,384.67,1.08150059
3,9881,1,351.50,1.17888206,3,9881,2,287.75,1.09093861
3,10035,1,378.25,1.02163995,3,10035,2,364.25,1.15679227
3,10509,1,420.25,1.05486269,3,10509,2,368.25,1.18206334
3,10547,1,182.33,1.53256415,3,10547,2,320.25,1.30244184
3,10743,1,233.25,1.27930224,3,10743,2,110.25,1.10720463
3,11477,1,264.25,1.09535300,3,11477,2,278.50,1.03279098
3,11959,1,358.00,1.06848353,3,11959,2,268.50,1.00898568
3,12043,1,169.25,1.03309381,3,12043,2,377.25,1.01619625
3,12157,1,326.33,1.00223187,3,12157,2,396.33,1.02878181
3,12433,1,199.75,1.30725892,3,12433,2,478.50,1.01647421
3,12867,1,278.25,1.64038001,3,12867,2,350.75,1.20069333
3,13499,1,281.00,1.14319655,3,13499,2,446.75,1.03315203
3,14589,1,266.50,1.11432439,3,14589,2,334.33,1.14531468
3,15207,1,300.25,1.48446113,3,15207,2,564.00,1.00048087
3,15395,1,258.25,1.05138769,3,15395,2,307.50,1.13822532
3,15973,1,477.50,1.20393259,3,15973,2,286.00,1.28722942
3,16233,1,260.67,1.12042355,3,16233,2,210.50,1.17881433
3,16267,1,456.00,1.00422635,3,16267,2,364.33,1.48188554
3,16605,1,394.25,1.11374136,3,16605,2,296.25,1.28858927
3,16949,1,155.75,1.11861773,3,16949,2,229.50,1.02894692
3,17319,1,364.75,1.27093644,3,17319,2,359.25,1.15787514
4,947,1,247.50,1.69331818,4,947,2,203.33,1.20543315
4,1895,1,354.75,1.23973415,4,1895,2,383.75,1.08930770
4,3429,1,358.50,1.06655934,4,3429,2,346.00,1.25194893
4,4559,1,215.00,1.24323299,4,4559,2,360.75,1.03335459
4,4773,1,328.25,1.05098366,4,4773,2,330.50,1.00625806
4,4885,1,151.00,1.32055704,4,4885,2,377.25,1.04890352
4,4915,1,289.25,1.08639295,4,4915,2,368.00,1.06965855
4,5043,1,476.00,1.01559643,4,5043,2,244.25,1.35628937
4,5095,1,334.00,1.22588613,4,5095,2,390.25,1.06217881
4,5193,1,263.33,1.25017095,4,5193,2,323.00,1.09796162
4,5975,1,434.00,1.02336145,4,5975,2,359.75,1.19793569
4,6251,1,285.00,1.12153803,4,6251,2,335.50,1.16021925
4,6389,1,280.75,1.20492361,4,6389,2,259.33,1.48165506
4,6487,1,452.75,1.07106266,4,6487,2,350.50,1.17164757
4,6619,1,430.00,1.00072626,4,6619,2,226.25,1.54855745
4,7191,1,260.75,1.00126668,4,7191,2,195.25,1.53726755
4,7427,1,239.50,1.41835671,4,7427,2,373.25,1.04297920
4,8453,1,314.75,1.02597149,4,8453,2,376.75,1.00990239
4,8781,1,518.50,1.10055000,4,8781,2,521.00,1.12377047
4,9571,1,314.00,1.21685782,4,9571,2,309.00,1.08921674
4,9587,1,248.00,1.49818873,4,9587,2,248.00,1.00649878
4,10333,1,321.00,1.14861071,4,10333,2,317.00,1.04692263
4,10969,1,186.67,1.10442062,4,10969,2,307.00,1.10947641
4,10993,1,446.00,1.00923763,4,10993,2,206.67,1.23553335
4,11571,1,342.50,1.14262840,4,11571,2,304.67,1.03199432
4,11979,1,225.33,1.46706562,4,11979,2,438.25,1.13899270
4,13409,1,312.33,1.34275025,4,13409,2,336.25,1.10819783
4,13443,1,417.75,1.02177961,4,13443,2,334.00,1.30764309
4,13567,1,271.50,1.00876216,4,13567,2,370.00,1.45576861
4,13683,1,318.75,1.01498277,4,13683,2,363.50,1.07811546
4,14143,1,367.00,1.04417994,4,14143,2,290.00,1.19330608
4,14401,1,342.75,1.18365590,4,14401,2,344.25,1.20670831
4,14693,1,447.25,1.05166749,4,14693,2,498.00,1.35173826
4,14877,1,414.33,1.17077239,4,14877,2,282.50,1.58305829
4,15063,1,378.25,1.11281926,4,15063,2,444.00,1.06327777
4,15275,1,335.50,1.15363829,4,15275,2,292.67,1.29783137
4,15509,1,296.33,1.02467405,4,15509,2,317.67,1.44703646
4,15969,1,423.00,1.04728755,4,15969,2,342.50,1.25117694
4,16627,1,485.50,1.01514609,4,16627,2,161.25,1.35332527
4,16641,1,521.50,1.10506621,4,16641,2,221.50,1.03085905
4,16751,1,549.50,1.08221438,4,16751,2,223.33,1.33778976
5,75,1,333.00,1.26563188,5,75,2,226.00,1.03580785
5,125,1,441.67,1.09597146,5,125,2,331.50,1.00811483
5,431,1,159.00,1.10617948,5,431,2,304.00,1.12242254
5,671,1,403.33,1.00560141,5,671,2,281.33,1.33668352
5,745,1,466.75,1.01090655,5,745,2,351.00,1.11472129
5,1701,1,374.00,1.08644582,5,1701,2,385.00,1.33063087
5,2521,1,360.75,1.09924823,5,2521,2,265.50,1.17240777
5,2855,1,406.00,1.40376371,5,2855,2,183.25,1.06622499
5,3137,1,271.25,1.57545322,5,3137,2,380.00,1.08342034
5,3279,1,299.50,1.05366972,5,3279,2,276.75,1.44588781
5,3467,1,294.00,1.14772946,5,3467,2,349.67,1.16742237
5,4463,1,338.00,1.06993201,5,4463,2,273.50,1.23697973
5,4719,1,340.50,1.05718578,5,4719,2,423.67,1.02550002
5,4739,1,281.33,1.02429715,5,4739,2,383.50,1.03343374
5,4839,1,310.25,1.03590344,5,4839,2,232.00,1.29541938
5,4979,1,359.50,1.10464081,5,4979,2,323.75,1.17042510
5,5401,1,219.25,1.27738702,5,5401,2,203.00,1.09156752
5,5635,1,370.00,1.02270546,5,5635,2,351.67,1.37776645
5,5797,1,403.00,1.02348823,5,5797,2,457.50,1.00370401
5,5901,1,360.25,1.12596313,5,5901,2,376.00,1.00950384
5,6129,1,419.25,1.01691802,5,6129,2,359.50,1.04788894
5,6213,1,351.67,1.20562125,5,6213,2,361.50,1.11684081
5,6479,1,301.33,1.27800104,5,6479,2,395.75,1.17797435
5,7333,1,227.00,1.46113460,5,7333,2,243.75,1.17891625
5,7923,1,358.00,1.10467709,5,7923,2,342.33,1.16077811
5,8737,1,217.25,1.07421364,5,8737,2,403.50,1.04420805
5,8945,1,344.25,1.14148377,5,8945,2,298.00,1.00083670
5,8993,1,399.00,1.18737229,5,8993,2,371.75,1.13163538
5,10667,1,288.00,1.34536402,5,10667,2,289.50,1.09522380
5,10771,1,394.75,1.04806801,5,10771,2,323.25,1.23773488
5,10949,1,383.00,1.11256774,5,10949,2,378.25,1.12554061
5,11107,1,446.50,1.26534898,5,11107,2,258.50,1.55361256
5,11795,1,395.50,1.01044732,5,11795,2,430.75,1.13106259
5,12017,1,347.75,1.16823794,5,12017,2,308.00,1.15932280
5,12027,1,456.25,1.02629401,5,12027,2,390.33,1.11427701
5,13583,1,430.33,1.04238393,5,13583,2,256.25,1.54103483
5,13651,1,272.33,1.16952312,5,13651,2,330.50,1.19018735
5,13783,1,419.50,1.05846997,5,13783,2,339.50,1.06809095
5,13859,1,318.00,1.14222390,5,13859,2,380.25,1.05644962
5,14537,1,206.00,1.22834400,5,14537,2,357.75,1.03879827
5,15309,1,276.33,1.29875906,5,15309,2,409.00,1.01024062
5,15883,1,385.33,1.01247775,5,15883,2,173.25,1.35622382
5,15935,1,293.50,1.01876594,5,15935,2,271.25,1.40009475
5,15949,1,241.50,1.14866599,5,15949,2,235.00,1.40728879
5,16037,1,327.25,1.13076173,5,16037,2,412.67,1.18302002
5,16291,1,380.50,1.05495950,5,16291,2,411.67,1.03492140
5,16459,1,370.00,1.27564991,5,16459,2,265.75,1.29881917
5,16901,1,305.25,1.10430105,5,16901,2,186.50,1.02312693
5,17199,1,376.50,1.10389698,5,17199,2,374.00,1.08730312
5,17387,1,298.33,1.38487417,5,17387,2,327.67,1.36708758
5,17717,1,283.75,1.15571566,5,17717,2,235.25,1.14162394
5,17927,1,217.50,1.35499643,5,17927,2,250.75,1.07092131
5,17943,1,209.75,1.37170713,5,17943,2,428.00,1.10907993
---- TYPES
INT, BIGINT, INT, DOUBLE, DOUBLE, INT, BIGINT, INT, DOUBLE, DOUBLE
====
