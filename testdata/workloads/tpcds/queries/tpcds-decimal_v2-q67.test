====
---- QUERY: TPCDS-Q67
select  *
from (select i_category
            ,i_class
            ,i_brand
            ,i_product_name
            ,d_year
            ,d_qoy
            ,d_moy
            ,s_store_id
            ,sumsales
            ,rank() over (partition by i_category order by sumsales desc) rk
      from (select i_category
                  ,i_class
                  ,i_brand
                  ,i_product_name
                  ,d_year
                  ,d_qoy
                  ,d_moy
                  ,s_store_id
                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales
            from store_sales
                ,date_dim
                ,store
                ,item
       where  ss_sold_date_sk=d_date_sk
          and ss_item_sk=i_item_sk
          and ss_store_sk = s_store_sk
          and d_month_seq between 1212 and 1212+11
       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2
where rk <= 100
order by i_category
        ,i_class
        ,i_brand
        ,i_product_name
        ,d_year
        ,d_qoy
        ,d_moy
        ,s_store_id
        ,sumsales
        ,rk
limit 100;
---- RESULTS
'Books','arts','amalgmaxi #10','NULL',NULL,NULL,NULL,'NULL',771942.81,94
'Books','arts','amalgmaxi #12','NULL',NULL,NULL,NULL,'NULL',1404915.39,28
'Books','arts','amalgmaxi #2','NULL',NULL,NULL,NULL,'NULL',843070.19,86
'Books','arts','NULL','NULL',NULL,NULL,NULL,'NULL',4506213.38,17
'Books','business','importomaxi #12','NULL',NULL,NULL,NULL,'NULL',976588.70,69
'Books','business','importomaxi #2','NULL',NULL,NULL,NULL,'NULL',1070176.27,59
'Books','business','importomaxi #4','NULL',NULL,NULL,NULL,'NULL',985988.99,66
'Books','business','importomaxi #6','NULL',NULL,NULL,NULL,'NULL',759660.32,95
'Books','business','importomaxi #8','NULL',NULL,NULL,NULL,'NULL',998679.05,63
'Books','business','NULL','NULL',NULL,NULL,NULL,'NULL',5357940.76,15
'Books','computers','exportimaxi #10','NULL',NULL,NULL,NULL,'NULL',892700.18,77
'Books','computers','exportimaxi #12','NULL',NULL,NULL,NULL,'NULL',1334760.61,34
'Books','computers','exportimaxi #2','NULL',NULL,NULL,NULL,'NULL',1491893.77,26
'Books','computers','exportimaxi #4','NULL',NULL,NULL,NULL,'NULL',1375974.23,31
'Books','computers','exportimaxi #6','NULL',NULL,NULL,NULL,'NULL',864545.72,80
'Books','computers','exportimaxi #8','NULL',NULL,NULL,NULL,'NULL',1227706.86,43
'Books','computers','NULL','NULL',NULL,NULL,NULL,'NULL',7187581.37,3
'Books','cooking','amalgunivamalg #10','NULL',NULL,NULL,NULL,'NULL',828936.66,89
'Books','cooking','amalgunivamalg #12','NULL',NULL,NULL,NULL,'NULL',1199051.96,49
'Books','cooking','amalgunivamalg #4','NULL',NULL,NULL,NULL,'NULL',1215546.70,46
'Books','cooking','amalgunivamalg #6','NULL',NULL,NULL,NULL,'NULL',978464.05,68
'Books','cooking','amalgunivamalg #8','NULL',NULL,NULL,NULL,'NULL',893562.91,76
'Books','cooking','NULL','NULL',NULL,NULL,NULL,'NULL',5648185.86,13
'Books','entertainments','edu packmaxi #10','NULL',NULL,NULL,NULL,'NULL',1063523.23,60
'Books','entertainments','edu packmaxi #12','NULL',NULL,NULL,NULL,'NULL',812807.75,91
'Books','entertainments','edu packmaxi #2','NULL',NULL,NULL,NULL,'NULL',850707.47,83
'Books','entertainments','edu packmaxi #4','NULL',NULL,NULL,NULL,'NULL',1132602.81,56
'Books','entertainments','edu packmaxi #6','NULL',NULL,NULL,NULL,'NULL',871965.57,79
'Books','entertainments','edu packmaxi #8','NULL',NULL,NULL,NULL,'NULL',894401.25,75
'Books','entertainments','NULL','NULL',NULL,NULL,NULL,'NULL',5705551.13,11
'Books','fiction','scholarunivamalg #10','NULL',NULL,NULL,NULL,'NULL',1080330.14,58
'Books','fiction','scholarunivamalg #12','NULL',NULL,NULL,NULL,'NULL',1063243.41,61
'Books','fiction','scholarunivamalg #2','NULL',NULL,NULL,NULL,'NULL',1931852.77,18
'Books','fiction','scholarunivamalg #6','NULL',NULL,NULL,NULL,'NULL',990232.80,65
'Books','fiction','scholarunivamalg #8','NULL',NULL,NULL,NULL,'NULL',1357801.34,32
'Books','fiction','NULL','NULL',NULL,NULL,NULL,'NULL',6758618.52,7
'Books','history','scholarmaxi #10','NULL',NULL,NULL,NULL,'NULL',1159896.65,51
'Books','history','scholarmaxi #12','NULL',NULL,NULL,NULL,'NULL',1377383.04,30
'Books','history','scholarmaxi #2','NULL',NULL,NULL,NULL,'NULL',1880968.59,19
'Books','history','scholarmaxi #6','NULL',NULL,NULL,NULL,'NULL',1321161.65,37
'Books','history','scholarmaxi #8','NULL',NULL,NULL,NULL,'NULL',951861.54,72
'Books','history','NULL','NULL',NULL,NULL,NULL,'NULL',7175822.76,4
'Books','home repair','importounivamalg #10','NULL',NULL,NULL,NULL,'NULL',975176.77,71
'Books','home repair','importounivamalg #12','NULL',NULL,NULL,NULL,'NULL',851531.36,82
'Books','home repair','importounivamalg #2','NULL',NULL,NULL,NULL,'NULL',1553230.30,22
'Books','home repair','importounivamalg #4','NULL',NULL,NULL,NULL,'NULL',834733.96,88
'Books','home repair','importounivamalg #6','NULL',NULL,NULL,NULL,'NULL',672760.54,100
'Books','home repair','importounivamalg #8','NULL',NULL,NULL,NULL,'NULL',1748378.72,21
'Books','home repair','NULL','NULL',NULL,NULL,NULL,'NULL',6635811.65,8
'Books','mystery','corpunivamalg #10','NULL',NULL,NULL,NULL,'NULL',862402.84,81
'Books','mystery','corpunivamalg #12','NULL',NULL,NULL,NULL,'NULL',1132883.60,55
'Books','mystery','corpunivamalg #2','NULL',NULL,NULL,NULL,'NULL',843818.57,84
'Books','mystery','corpunivamalg #6','NULL',NULL,NULL,NULL,'NULL',1002261.69,62
'Books','mystery','corpunivamalg #8','NULL',NULL,NULL,NULL,'NULL',727595.71,98
'Books','mystery','NULL','NULL',NULL,NULL,NULL,'NULL',5139547.86,16
'Books','parenting','corpmaxi #10','NULL',NULL,NULL,NULL,'NULL',1297132.15,40
'Books','parenting','corpmaxi #12','NULL',NULL,NULL,NULL,'NULL',994252.14,64
'Books','parenting','corpmaxi #2','NULL',NULL,NULL,NULL,'NULL',817919.30,90
'Books','parenting','corpmaxi #4','NULL',NULL,NULL,NULL,'NULL',1137537.84,53
'Books','parenting','corpmaxi #6','NULL',NULL,NULL,NULL,'NULL',1756990.35,20
'Books','parenting','corpmaxi #8','NULL',NULL,NULL,NULL,'NULL',786459.87,92
'Books','parenting','NULL','NULL',NULL,NULL,NULL,'NULL',6790291.65,5
'Books','reference','brandmaxi #10','NULL',NULL,NULL,NULL,'NULL',901096.84,74
'Books','reference','brandmaxi #12','NULL',NULL,NULL,NULL,'NULL',1331752.35,35
'Books','reference','brandmaxi #2','NULL',NULL,NULL,NULL,'NULL',975383.60,70
'Books','reference','brandmaxi #4','NULL',NULL,NULL,NULL,'NULL',1492547.50,24
'Books','reference','brandmaxi #6','NULL',NULL,NULL,NULL,'NULL',1277662.78,41
'Books','reference','brandmaxi #8','NULL',NULL,NULL,NULL,'NULL',1354720.24,33
'Books','reference','NULL','NULL',NULL,NULL,NULL,'NULL',7333163.31,2
'Books','romance','namelessmaxi #10','NULL',NULL,NULL,NULL,'NULL',749766.99,96
'Books','romance','namelessmaxi #12','NULL',NULL,NULL,NULL,'NULL',1297611.04,39
'Books','romance','namelessmaxi #2','NULL',NULL,NULL,NULL,'NULL',1208741.34,47
'Books','romance','namelessmaxi #4','NULL',NULL,NULL,NULL,'NULL',1303175.14,38
'Books','romance','namelessmaxi #6','NULL',NULL,NULL,NULL,'NULL',1329372.02,36
'Books','romance','namelessmaxi #8','NULL',NULL,NULL,NULL,'NULL',872633.95,78
'Books','romance','NULL','NULL',NULL,NULL,NULL,'NULL',6761300.48,6
'Books','science','maximaxi #10','NULL',NULL,NULL,NULL,'NULL',843554.63,85
'Books','science','maximaxi #2','NULL',NULL,NULL,NULL,'NULL',837350.77,87
'Books','science','maximaxi #6','NULL',NULL,NULL,NULL,'NULL',1492461.17,25
'Books','science','maximaxi #8','NULL',NULL,NULL,NULL,'NULL',1200421.62,48
'Books','science','NULL','NULL',NULL,NULL,NULL,'NULL',5457882.47,14
'Books','self-help','exportiunivamalg #10','NULL',NULL,NULL,NULL,'NULL',1161828.20,50
'Books','self-help','exportiunivamalg #2','NULL',NULL,NULL,NULL,'NULL',1094139.27,57
'Books','self-help','exportiunivamalg #4','NULL',NULL,NULL,NULL,'NULL',777051.93,93
'Books','self-help','exportiunivamalg #6','NULL',NULL,NULL,NULL,'NULL',1404452.50,29
'Books','self-help','exportiunivamalg #8','NULL',NULL,NULL,NULL,'NULL',739121.55,97
'Books','self-help','NULL','NULL',NULL,NULL,NULL,'NULL',5652129.32,12
'Books','sports','edu packunivamalg #10','NULL',NULL,NULL,NULL,'NULL',1240893.26,42
'Books','sports','edu packunivamalg #12','NULL',NULL,NULL,NULL,'NULL',914992.76,73
'Books','sports','edu packunivamalg #4','NULL',NULL,NULL,NULL,'NULL',1137120.66,54
'Books','sports','edu packunivamalg #6','NULL',NULL,NULL,NULL,'NULL',1503138.10,23
'Books','sports','edu packunivamalg #8','NULL',NULL,NULL,NULL,'NULL',1222640.97,44
'Books','sports','NULL','NULL',NULL,NULL,NULL,'NULL',6435144.67,9
'Books','travel','univunivamalg #10','NULL',NULL,NULL,NULL,'NULL',705516.40,99
'Books','travel','univunivamalg #12','NULL',NULL,NULL,NULL,'NULL',1144238.62,52
'Books','travel','univunivamalg #2','NULL',NULL,NULL,NULL,'NULL',980611.95,67
'Books','travel','univunivamalg #4','NULL',NULL,NULL,NULL,'NULL',1220300.37,45
'Books','travel','univunivamalg #8','NULL',NULL,NULL,NULL,'NULL',1459320.64,27
'Books','travel','NULL','NULL',NULL,NULL,NULL,'NULL',6168021.72,10
'Books','NULL','NULL','NULL',NULL,NULL,NULL,'NULL',98805619.53,1
---- TYPES
STRING, STRING, STRING, STRING, INT, INT, INT, STRING, DECIMAL, BIGINT
====
