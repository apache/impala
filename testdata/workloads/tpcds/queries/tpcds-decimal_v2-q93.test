====
---- QUERY: TPCDS-Q93
SELECT ss_customer_sk,
       sum(act_sales) sumsales
FROM
  (SELECT ss_item_sk,
          ss_ticket_number,
          ss_customer_sk,
          CASE
              WHEN sr_return_quantity IS NOT NULL THEN (ss_quantity-sr_return_quantity)*ss_sales_price
              ELSE (ss_quantity*ss_sales_price)
          END act_sales
   FROM store_sales
   LEFT OUTER JOIN store_returns ON (sr_item_sk = ss_item_sk
                                     AND sr_ticket_number = ss_ticket_number) ,reason
   WHERE sr_reason_sk = r_reason_sk
     AND r_reason_desc = 'reason 28') t
GROUP BY ss_customer_sk
ORDER BY sumsales,
         ss_customer_sk
LIMIT 100
---- RESULTS
148,0.00
357,0.00
501,0.00
620,0.00
1159,0.00
1393,0.00
2149,0.00
2191,0.00
2346,0.00
2496,0.00
3071,0.00
3886,0.00
3914,0.00
4010,0.00
4086,0.00
4173,0.00
4314,0.00
4519,0.00
5166,0.00
5175,0.00
5432,0.00
5799,0.00
5972,0.00
5980,0.00
6584,0.00
6969,0.00
7141,0.00
7238,0.00
7656,0.00
7774,0.00
8017,0.00
9383,0.00
9500,0.00
9815,0.00
10311,0.00
10471,0.00
10682,0.00
10723,0.00
11223,0.00
11283,0.00
11491,0.00
11502,0.00
11745,0.00
11889,0.00
12015,0.00
12644,0.00
13168,0.00
13209,0.00
13840,0.00
14091,0.00
14423,0.00
14429,0.00
14554,0.00
14867,0.00
15211,0.00
15589,0.00
15882,0.00
15986,0.00
16325,0.00
16988,0.00
17179,0.00
17335,0.00
18294,0.00
18523,0.00
18618,0.00
18951,0.00
19406,0.00
19543,0.00
19755,0.00
19762,0.00
20178,0.00
20374,0.00
20898,0.00
20968,0.00
20980,0.00
21300,0.00
21419,0.00
21579,0.00
23531,0.00
23804,0.00
24281,0.00
24284,0.00
24330,0.00
24548,0.00
25052,0.00
25146,0.00
25517,0.00
25608,0.00
26351,0.00
26651,0.00
26777,0.00
26853,0.00
26932,0.00
27605,0.00
27904,0.00
28048,0.00
28613,0.00
28794,0.00
28798,0.00
28803,0.00
---- TYPES
INT, DECIMAL
====
