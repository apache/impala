====
---- QUERY: TPCDS-Q52
SELECT
  d.d_year,
  i.i_brand_id AS brand_id,
  i.i_brand AS brand,
  SUM(ss_ext_sales_price) AS ext_price
FROM store_sales ss
JOIN date_dim d
  ON (ss.ss_sold_date_sk = d.d_date_sk)
JOIN item i
  ON (ss.ss_item_sk = i.i_item_sk)
WHERE
  i.i_manager_id = 1
  AND d.d_moy = 12
  AND d.d_year = 1998
GROUP BY
  d.d_year,
  i.i_brand,
  i.i_brand_id
ORDER BY
  d_year,
  ext_price DESC,
  brand_id
LIMIT 100;
---- RESULTS
1998,2001002,'amalgimporto #2',17501.98994064331
1998,2004002,'edu packimporto #2',14472.43003845215
1998,5004002,'edu packscholar #2',14284.98046875
1998,5001002,'amalgscholar #2',12435.76953125
1998,1002002,'importoamalg #2',11943.72001647949
1998,4004002,'edu packedu pack #2',9636.469573974609
1998,3002001,'importoexporti #1',6423.429946899414
1998,7016001,'corpnameless #1',6320.140045166016
1998,5001001,'amalgscholar #1',5882.179931640625
1998,10009015,'maxiunivamalg #15',5734.820068359375
1998,6011001,'amalgbrand #1',5659.64990234375
1998,2002001,'importoimporto #1',5432.18017578125
1998,8004003,'edu packnameless #3',5272.869873046875
1998,6002005,'importocorp #5',5271.9501953125
1998,5004001,'edu packscholar #1',4905.18017578125
1998,4001001,'amalgedu pack #1',4733.839965820312
1998,10012011,'importoamalgamalg #11',4587.31005859375
1998,7009010,'maxibrand #10',4423.5
1998,9015009,'scholarunivamalg #9',4343.740112304688
1998,8014005,'edu packmaxi #5',3859.589965820312
1998,6005001,'scholarcorp #1',3437.969955444336
1998,10013015,'exportiamalgamalg #15',3335.260009765625
1998,1003002,'exportiamalg #2',3138.030029296875
1998,9016003,'corpunivamalg #3',3014.72998046875
1998,5003001,'exportischolar #1',2643.159912109375
1998,10013013,'exportiamalgamalg #13',2600.429931640625
1998,1004001,'edu packamalg #1',2446.659912109375
1998,1003001,'exportiamalg #1',2388.039947509766
1998,6006007,'corpcorp #7',2381.18994140625
1998,10004004,'edu packunivamalg #4',1953.669979095459
1998,2003001,'exportiimporto #1',1940.849975585938
1998,1004002,'edu packamalg #2',1582.040023803711
1998,10003016,'exportiunivamalg #16',1461.97004699707
1998,6007003,'brandcorp #3',1437.27001953125
1998,3002002,'importoexporti #2',1371.75
1998,8004009,'edu packnameless #9',1020.280029296875
1998,1002001,'importoamalg #1',693.7999877929688
1998,3003001,'exportiexporti #1',690.5599975585938
1998,6012005,'importobrand #5',646.9699745178223
1998,3003002,'exportiexporti #2',542.7899932861328
1998,1001001,'amalgamalg #1',386.25
1998,7010003,'univnameless #3',335.7200012207031
1998,9012005,'importounivamalg #5',333.7000122070312
1998,3001001,'amalgexporti #1',329.2799987792969
1998,5002001,'importoscholar #1',299.760009765625
1998,7010009,'univnameless #9',297.5
1998,6015006,'scholarbrand #6',250.2400054931641
1998,8013007,'exportimaxi #7',208
1998,6009003,'maxicorp #3',198.8999938964844
1998,7001005,'amalgbrand #5',146.6999969482422
1998,7007004,'brandbrand #4',68.54000091552734
1998,4001002,'amalgedu pack #2',63.41999816894531
1998,7012010,'importonameless #10',26.60000038146973
---- TYPES
INT, INT, STRING, DOUBLE
====