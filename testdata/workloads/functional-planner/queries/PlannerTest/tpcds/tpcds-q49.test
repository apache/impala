# TPCDS-Q49

SELECT channel,
       item,
       return_ratio,
       return_rank,
       currency_rank
FROM
  (SELECT 'web' AS channel,
          web.item,
          web.return_ratio,
          web.return_rank,
          web.currency_rank
   FROM
     (SELECT item,
             return_ratio,
             currency_ratio,
             rank() OVER (
                          ORDER BY return_ratio) AS return_rank,
                         rank() OVER (
                                      ORDER BY currency_ratio) AS currency_rank
      FROM
        (SELECT ws.ws_item_sk AS item,
                (cast(sum(coalesce(wr.wr_return_quantity,0)) AS decimal(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) AS decimal(15,4))) AS return_ratio,
                (cast(sum(coalesce(wr.wr_return_amt,0)) AS decimal(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) AS decimal(15,4))) AS currency_ratio
         FROM web_sales ws
         LEFT OUTER JOIN web_returns wr ON (ws.ws_order_number = wr.wr_order_number
                                            AND ws.ws_item_sk = wr.wr_item_sk) ,date_dim
         WHERE wr.wr_return_amt > 10000
           AND ws.ws_net_profit > 1
           AND ws.ws_net_paid > 0
           AND ws.ws_quantity > 0
           AND ws_sold_date_sk = d_date_sk
           AND d_year = 2001
           AND d_moy = 12
         GROUP BY ws.ws_item_sk) in_web) web
   WHERE (web.return_rank <= 10
          OR web.currency_rank <= 10)
   UNION SELECT 'catalog' AS channel,
                catalog.item,
                catalog.return_ratio,
                catalog.return_rank,
                catalog.currency_rank
   FROM
     (SELECT item,
             return_ratio,
             currency_ratio,
             rank() OVER (
                          ORDER BY return_ratio) AS return_rank,
                         rank() OVER (
                                      ORDER BY currency_ratio) AS currency_rank
      FROM
        (SELECT cs.cs_item_sk AS item,
                (cast(sum(coalesce(cr.cr_return_quantity,0)) AS decimal(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) AS decimal(15,4))) AS return_ratio,
                (cast(sum(coalesce(cr.cr_return_amount,0)) AS decimal(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) AS decimal(15,4))) AS currency_ratio
         FROM catalog_sales cs
         LEFT OUTER JOIN catalog_returns cr ON (cs.cs_order_number = cr.cr_order_number
                                                AND cs.cs_item_sk = cr.cr_item_sk) ,date_dim
         WHERE cr.cr_return_amount > 10000
           AND cs.cs_net_profit > 1
           AND cs.cs_net_paid > 0
           AND cs.cs_quantity > 0
           AND cs_sold_date_sk = d_date_sk
           AND d_year = 2001
           AND d_moy = 12
         GROUP BY cs.cs_item_sk) in_cat) CATALOG
   WHERE (catalog.return_rank <= 10
          OR catalog.currency_rank <=10)
   UNION SELECT 'store' AS channel,
                store.item,
                store.return_ratio,
                store.return_rank,
                store.currency_rank
   FROM
     (SELECT item,
             return_ratio,
             currency_ratio,
             rank() OVER (
                          ORDER BY return_ratio) AS return_rank,
                         rank() OVER (
                                      ORDER BY currency_ratio) AS currency_rank
      FROM
        (SELECT sts.ss_item_sk AS item,
                (cast(sum(coalesce(sr.sr_return_quantity,0)) AS decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) AS decimal(15,4))) AS return_ratio,
                (cast(sum(coalesce(sr.sr_return_amt,0)) AS decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) AS decimal(15,4))) AS currency_ratio
         FROM store_sales sts
         LEFT OUTER JOIN store_returns sr ON (sts.ss_ticket_number = sr.sr_ticket_number
                                              AND sts.ss_item_sk = sr.sr_item_sk) ,date_dim
         WHERE sr.sr_return_amt > 10000
           AND sts.ss_net_profit > 1
           AND sts.ss_net_paid > 0
           AND sts.ss_quantity > 0
           AND ss_sold_date_sk = d_date_sk
           AND d_year = 2001
           AND d_moy = 12
         GROUP BY sts.ss_item_sk) in_store) store
   WHERE (store.return_rank <= 10
          OR store.currency_rank <= 10) ) sq1
ORDER BY 1,
         4,
         5,
         2
LIMIT 100;

---- PLAN
Max Per-Host Resource Reservation: Memory=37.31MB Threads=4
Per-Host Resource Estimates: Memory=457MB
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=456.88MB mem-reservation=37.31MB thread-reservation=4 runtime-filters-memory=3.00MB
PLAN-ROOT SINK
|  output exprs: channel, item, return_ratio, return_rank, currency_rank
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
35:TOP-N [LIMIT=100]
|  order by: channel ASC, return_rank ASC, currency_rank ASC, item ASC
|  mem-estimate=5.08KB mem-reservation=0B thread-reservation=0
|  tuple-ids=26 row-size=52B cardinality=100
|  in pipelines: 35(GETNEXT), 34(OPEN)
|
34:AGGREGATE [FINALIZE]
|  group by: channel, item, return_ratio, return_rank, currency_rank
|  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=24 row-size=52B cardinality=2.99K
|  in pipelines: 34(GETNEXT), 09(OPEN), 20(OPEN), 31(OPEN)
|
00:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=24 row-size=52B cardinality=2.99K
|  in pipelines: 09(GETNEXT), 20(GETNEXT), 31(GETNEXT)
|
|--33:SELECT
|  |  predicates: (rank() <= CAST(10 AS BIGINT) OR rank() <= CAST(10 AS BIGINT))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=58,55 row-size=104B cardinality=1.71K
|  |  in pipelines: 31(GETNEXT)
|  |
|  32:ANALYTIC
|  |  functions: rank()
|  |  order by: (CAST(sum(coalesce(sr.sr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  |  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  |  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=58,55 row-size=104B cardinality=17.05K
|  |  in pipelines: 31(GETNEXT)
|  |
|  31:SORT
|  |  order by: (CAST(sum(coalesce(sr.sr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  |  materialized: (CAST(sum(coalesce(sr.sr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_net_paid, 0)) AS DECIMAL(15,4)))
|  |  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=58 row-size=96B cardinality=17.05K
|  |  in pipelines: 31(GETNEXT), 29(OPEN)
|  |
|  30:ANALYTIC
|  |  functions: rank()
|  |  order by: (CAST(sum(coalesce(sr.sr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  |  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=56,53 row-size=80B cardinality=17.05K
|  |  in pipelines: 29(GETNEXT)
|  |
|  29:SORT
|  |  order by: (CAST(sum(coalesce(sr.sr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  materialized: (CAST(sum(coalesce(sr.sr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_quantity, 0)) AS DECIMAL(15,4)))
|  |  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=56 row-size=72B cardinality=17.05K
|  |  in pipelines: 29(GETNEXT), 28(OPEN)
|  |
|  28:AGGREGATE [FINALIZE]
|  |  output: sum(CAST(coalesce(sr.sr_return_quantity, CAST(0 AS INT)) AS BIGINT)), sum(CAST(coalesce(sts.ss_quantity, CAST(0 AS INT)) AS BIGINT)), sum(coalesce(sr.sr_return_amt, CAST(0 AS DECIMAL(7,2)))), sum(coalesce(sts.ss_net_paid, CAST(0 AS DECIMAL(7,2))))
|  |  group by: sts.ss_item_sk
|  |  mem-estimate=10.00MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=19 row-size=56B cardinality=17.05K
|  |  in pipelines: 28(GETNEXT), 23(OPEN)
|  |
|  27:HASH JOIN [INNER JOIN]
|  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  runtime filters: RF004[bloom] <- d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=16,17N,18 row-size=68B cardinality=17.05K
|  |  in pipelines: 23(GETNEXT), 25(OPEN)
|  |
|  |--25:SCAN HDFS [tpcds_parquet.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     mem-estimate=48.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=18 row-size=12B cardinality=108
|  |     in pipelines: 25(GETNEXT)
|  |
|  26:HASH JOIN [LEFT OUTER JOIN]
|  |  hash predicates: sts.ss_item_sk = sr.sr_item_sk, sts.ss_ticket_number = sr.sr_ticket_number
|  |  fk/pk conjuncts: sts.ss_item_sk = sr.sr_item_sk, sts.ss_ticket_number = sr.sr_ticket_number
|  |  other predicates: sr.sr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=16,17N row-size=56B cardinality=17.05K(filtered from 288.04K)
|  |  in pipelines: 23(GETNEXT), 24(OPEN)
|  |
|  |--24:SCAN HDFS [tpcds_parquet.store_returns sr]
|  |     HDFS partitions=1/1 files=1 size=15.43MB
|  |     predicates: sr.sr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  |     stored statistics:
|  |       table: rows=287.51K size=15.43MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=287.51K
|  |     parquet statistics predicates: sr.sr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  |     parquet dictionary predicates: sr.sr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |     tuple-ids=17 row-size=24B cardinality=28.75K
|  |     in pipelines: 24(GETNEXT)
|  |
|  23:SCAN HDFS [tpcds_parquet.store_sales sts]
|     HDFS partitions=1824/1824 files=1824 size=200.96MB
|     predicates: sts.ss_net_paid > CAST(0 AS DECIMAL(3,0)), sts.ss_net_profit > CAST(1 AS DECIMAL(3,0)), sts.ss_quantity > CAST(0 AS INT)
|     runtime filters: RF004[bloom] -> ss_sold_date_sk
|     stored statistics:
|       table: rows=2.88M size=200.96MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K est-scan-range=109(filtered from 1824)
|     parquet statistics predicates: sts.ss_net_paid > CAST(0 AS DECIMAL(3,0)), sts.ss_net_profit > CAST(1 AS DECIMAL(3,0)), sts.ss_quantity > CAST(0 AS INT)
|     parquet dictionary predicates: sts.ss_net_paid > CAST(0 AS DECIMAL(3,0)), sts.ss_net_profit > CAST(1 AS DECIMAL(3,0)), sts.ss_quantity > CAST(0 AS INT)
|     mem-estimate=80.00MB mem-reservation=4.00MB thread-reservation=1
|     tuple-ids=16 row-size=32B cardinality=17.05K(filtered from 288.04K)
|     in pipelines: 23(GETNEXT)
|
|--22:SELECT
|  |  predicates: (rank() <= CAST(10 AS BIGINT) OR rank() <= CAST(10 AS BIGINT))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=47,44 row-size=104B cardinality=853
|  |  in pipelines: 20(GETNEXT)
|  |
|  21:ANALYTIC
|  |  functions: rank()
|  |  order by: (CAST(sum(coalesce(cr.cr_return_amount, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  |  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  |  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=47,44 row-size=104B cardinality=8.53K
|  |  in pipelines: 20(GETNEXT)
|  |
|  20:SORT
|  |  order by: (CAST(sum(coalesce(cr.cr_return_amount, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  |  materialized: (CAST(sum(coalesce(cr.cr_return_amount, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_net_paid, 0)) AS DECIMAL(15,4)))
|  |  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=47 row-size=96B cardinality=8.53K
|  |  in pipelines: 20(GETNEXT), 18(OPEN)
|  |
|  19:ANALYTIC
|  |  functions: rank()
|  |  order by: (CAST(sum(coalesce(cr.cr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  |  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=45,42 row-size=80B cardinality=8.53K
|  |  in pipelines: 18(GETNEXT)
|  |
|  18:SORT
|  |  order by: (CAST(sum(coalesce(cr.cr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  materialized: (CAST(sum(coalesce(cr.cr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_quantity, 0)) AS DECIMAL(15,4)))
|  |  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=45 row-size=72B cardinality=8.53K
|  |  in pipelines: 18(GETNEXT), 17(OPEN)
|  |
|  17:AGGREGATE [FINALIZE]
|  |  output: sum(CAST(coalesce(cr.cr_return_quantity, CAST(0 AS INT)) AS BIGINT)), sum(CAST(coalesce(cs.cs_quantity, CAST(0 AS INT)) AS BIGINT)), sum(coalesce(cr.cr_return_amount, CAST(0 AS DECIMAL(7,2)))), sum(coalesce(cs.cs_net_paid, CAST(0 AS DECIMAL(7,2))))
|  |  group by: cs.cs_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=11 row-size=56B cardinality=8.53K
|  |  in pipelines: 17(GETNEXT), 12(OPEN)
|  |
|  16:HASH JOIN [INNER JOIN]
|  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  runtime filters: RF002[bloom] <- d_date_sk, RF003[min_max] <- d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=8,9N,10 row-size=68B cardinality=8.53K
|  |  in pipelines: 12(GETNEXT), 14(OPEN)
|  |
|  |--14:SCAN HDFS [tpcds_parquet.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     mem-estimate=48.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=10 row-size=12B cardinality=108
|  |     in pipelines: 14(GETNEXT)
|  |
|  15:HASH JOIN [LEFT OUTER JOIN]
|  |  hash predicates: cs.cs_item_sk = cr.cr_item_sk, cs.cs_order_number = cr.cr_order_number
|  |  fk/pk conjuncts: cs.cs_item_sk = cr.cr_item_sk, cs.cs_order_number = cr.cr_order_number
|  |  other predicates: cr.cr_return_amount > CAST(10000 AS DECIMAL(5,0))
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=8,9N row-size=56B cardinality=85.31K(filtered from 144.16K)
|  |  in pipelines: 12(GETNEXT), 13(OPEN)
|  |
|  |--13:SCAN HDFS [tpcds_parquet.catalog_returns cr]
|  |     HDFS partitions=1/1 files=1 size=10.62MB
|  |     predicates: cr.cr_return_amount > CAST(10000 AS DECIMAL(5,0))
|  |     stored statistics:
|  |       table: rows=144.07K size=10.62MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=144.07K
|  |     parquet statistics predicates: cr.cr_return_amount > CAST(10000 AS DECIMAL(5,0))
|  |     parquet dictionary predicates: cr.cr_return_amount > CAST(10000 AS DECIMAL(5,0))
|  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |     tuple-ids=9 row-size=24B cardinality=14.41K
|  |     in pipelines: 13(GETNEXT)
|  |
|  12:SCAN HDFS [tpcds_parquet.catalog_sales cs]
|     HDFS partitions=1/1 files=3 size=96.62MB
|     predicates: cs.cs_net_paid > CAST(0 AS DECIMAL(3,0)), cs.cs_net_profit > CAST(1 AS DECIMAL(3,0)), cs.cs_quantity > CAST(0 AS INT)
|     runtime filters: RF003[min_max] -> cs_sold_date_sk, RF002[bloom] -> cs_sold_date_sk
|     stored statistics:
|       table: rows=1.44M size=96.62MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=650.14K
|     parquet statistics predicates: cs.cs_net_paid > CAST(0 AS DECIMAL(3,0)), cs.cs_net_profit > CAST(1 AS DECIMAL(3,0)), cs.cs_quantity > CAST(0 AS INT)
|     parquet dictionary predicates: cs.cs_net_paid > CAST(0 AS DECIMAL(3,0)), cs.cs_net_profit > CAST(1 AS DECIMAL(3,0)), cs.cs_quantity > CAST(0 AS INT)
|     mem-estimate=288.00MB mem-reservation=16.00MB thread-reservation=1
|     tuple-ids=8 row-size=32B cardinality=85.31K(filtered from 144.16K)
|     in pipelines: 12(GETNEXT)
|
11:SELECT
|  predicates: (rank() <= CAST(10 AS BIGINT) OR rank() <= CAST(10 AS BIGINT))
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=36,33 row-size=104B cardinality=429
|  in pipelines: 09(GETNEXT)
|
10:ANALYTIC
|  functions: rank()
|  order by: (CAST(sum(coalesce(wr.wr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=36,33 row-size=104B cardinality=4.29K
|  in pipelines: 09(GETNEXT)
|
09:SORT
|  order by: (CAST(sum(coalesce(wr.wr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  materialized: (CAST(sum(coalesce(wr.wr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_net_paid, 0)) AS DECIMAL(15,4)))
|  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=36 row-size=96B cardinality=4.29K
|  in pipelines: 09(GETNEXT), 07(OPEN)
|
08:ANALYTIC
|  functions: rank()
|  order by: (CAST(sum(coalesce(wr.wr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_quantity, 0)) AS DECIMAL(15,4))) ASC
|  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=34,31 row-size=80B cardinality=4.29K
|  in pipelines: 07(GETNEXT)
|
07:SORT
|  order by: (CAST(sum(coalesce(wr.wr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_quantity, 0)) AS DECIMAL(15,4))) ASC
|  materialized: (CAST(sum(coalesce(wr.wr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_quantity, 0)) AS DECIMAL(15,4)))
|  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=34 row-size=72B cardinality=4.29K
|  in pipelines: 07(GETNEXT), 06(OPEN)
|
06:AGGREGATE [FINALIZE]
|  output: sum(CAST(coalesce(wr.wr_return_quantity, CAST(0 AS INT)) AS BIGINT)), sum(CAST(coalesce(ws.ws_quantity, CAST(0 AS INT)) AS BIGINT)), sum(coalesce(wr.wr_return_amt, CAST(0 AS DECIMAL(7,2)))), sum(coalesce(ws.ws_net_paid, CAST(0 AS DECIMAL(7,2))))
|  group by: ws.ws_item_sk
|  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=3 row-size=56B cardinality=4.29K
|  in pipelines: 06(GETNEXT), 01(OPEN)
|
05:HASH JOIN [INNER JOIN]
|  hash predicates: ws_sold_date_sk = d_date_sk
|  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  runtime filters: RF000[bloom] <- d_date_sk, RF001[min_max] <- d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,1N,2 row-size=68B cardinality=4.29K
|  in pipelines: 01(GETNEXT), 03(OPEN)
|
|--03:SCAN HDFS [tpcds_parquet.date_dim]
|     HDFS partitions=1/1 files=1 size=2.15MB
|     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.15MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|     mem-estimate=48.00MB mem-reservation=512.00KB thread-reservation=1
|     tuple-ids=2 row-size=12B cardinality=108
|     in pipelines: 03(GETNEXT)
|
04:HASH JOIN [LEFT OUTER JOIN]
|  hash predicates: ws.ws_item_sk = wr.wr_item_sk, ws.ws_order_number = wr.wr_order_number
|  fk/pk conjuncts: ws.ws_item_sk = wr.wr_item_sk, ws.ws_order_number = wr.wr_order_number
|  other predicates: wr.wr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,1N row-size=56B cardinality=42.85K(filtered from 71.94K)
|  in pipelines: 01(GETNEXT), 02(OPEN)
|
|--02:SCAN HDFS [tpcds_parquet.web_returns wr]
|     HDFS partitions=1/1 files=1 size=5.66MB
|     predicates: wr.wr_return_amt > CAST(10000 AS DECIMAL(5,0))
|     stored statistics:
|       table: rows=71.76K size=5.66MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=71.76K
|     parquet statistics predicates: wr.wr_return_amt > CAST(10000 AS DECIMAL(5,0))
|     parquet dictionary predicates: wr.wr_return_amt > CAST(10000 AS DECIMAL(5,0))
|     mem-estimate=64.00MB mem-reservation=2.00MB thread-reservation=1
|     tuple-ids=1 row-size=24B cardinality=7.18K
|     in pipelines: 02(GETNEXT)
|
01:SCAN HDFS [tpcds_parquet.web_sales ws]
   HDFS partitions=1/1 files=2 size=45.09MB
   predicates: ws.ws_net_paid > CAST(0 AS DECIMAL(3,0)), ws.ws_net_profit > CAST(1 AS DECIMAL(3,0)), ws.ws_quantity > CAST(0 AS INT)
   runtime filters: RF001[min_max] -> ws_sold_date_sk, RF000[bloom] -> ws_sold_date_sk
   stored statistics:
     table: rows=719.38K size=45.09MB
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=644.77K
   parquet statistics predicates: ws.ws_net_paid > CAST(0 AS DECIMAL(3,0)), ws.ws_net_profit > CAST(1 AS DECIMAL(3,0)), ws.ws_quantity > CAST(0 AS INT)
   parquet dictionary predicates: ws.ws_net_paid > CAST(0 AS DECIMAL(3,0)), ws.ws_net_profit > CAST(1 AS DECIMAL(3,0)), ws.ws_quantity > CAST(0 AS INT)
   mem-estimate=192.00MB mem-reservation=16.00MB thread-reservation=1
   tuple-ids=0 row-size=32B cardinality=42.85K(filtered from 71.94K)
   in pipelines: 01(GETNEXT)
---- DISTRIBUTEDPLAN
Max Per-Host Resource Reservation: Memory=108.81MB Threads=22
Per-Host Resource Estimates: Memory=1.06GB
F15:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=24.61MB mem-reservation=15.94MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: channel, item, return_ratio, return_rank, currency_rank
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
35:TOP-N [LIMIT=100]
|  order by: channel ASC, return_rank ASC, currency_rank ASC, item ASC
|  mem-estimate=5.08KB mem-reservation=0B thread-reservation=0
|  tuple-ids=26 row-size=52B cardinality=100
|  in pipelines: 35(GETNEXT), 34(OPEN)
|
34:AGGREGATE [FINALIZE]
|  group by: channel, item, return_ratio, return_rank, currency_rank
|  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=24 row-size=52B cardinality=2.99K
|  in pipelines: 34(GETNEXT), 09(OPEN), 20(OPEN), 31(OPEN)
|
00:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=24 row-size=52B cardinality=2.99K
|  in pipelines: 09(GETNEXT), 20(GETNEXT), 31(GETNEXT)
|
|--33:SELECT
|  |  predicates: (rank() <= CAST(10 AS BIGINT) OR rank() <= CAST(10 AS BIGINT))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=58,55 row-size=104B cardinality=1.71K
|  |  in pipelines: 31(GETNEXT)
|  |
|  32:ANALYTIC
|  |  functions: rank()
|  |  order by: (CAST(sum(coalesce(sr.sr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  |  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  |  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=58,55 row-size=104B cardinality=17.05K
|  |  in pipelines: 31(GETNEXT)
|  |
|  31:SORT
|  |  order by: (CAST(sum(coalesce(sr.sr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  |  materialized: (CAST(sum(coalesce(sr.sr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_net_paid, 0)) AS DECIMAL(15,4)))
|  |  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=58 row-size=96B cardinality=17.05K
|  |  in pipelines: 31(GETNEXT), 29(OPEN)
|  |
|  30:ANALYTIC
|  |  functions: rank()
|  |  order by: (CAST(sum(coalesce(sr.sr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  |  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=56,53 row-size=80B cardinality=17.05K
|  |  in pipelines: 29(GETNEXT)
|  |
|  50:MERGING-EXCHANGE [UNPARTITIONED]
|  |  order by: (CAST(sum(coalesce(sr.sr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  mem-estimate=627.73KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=56 row-size=72B cardinality=17.05K
|  |  in pipelines: 29(GETNEXT)
|  |
|  F13:PLAN FRAGMENT [HASH(sts.ss_item_sk)] hosts=3 instances=3
|  Per-Host Resources: mem-estimate=16.00MB mem-reservation=7.94MB thread-reservation=1
|  29:SORT
|  |  order by: (CAST(sum(coalesce(sr.sr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  materialized: (CAST(sum(coalesce(sr.sr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_quantity, 0)) AS DECIMAL(15,4)))
|  |  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=56 row-size=72B cardinality=17.05K
|  |  in pipelines: 29(GETNEXT), 49(OPEN)
|  |
|  49:AGGREGATE [FINALIZE]
|  |  output: sum:merge(coalesce(sr.sr_return_quantity, 0)), sum:merge(coalesce(sts.ss_quantity, 0)), sum:merge(coalesce(sr.sr_return_amt, 0)), sum:merge(coalesce(sts.ss_net_paid, 0))
|  |  group by: sts.ss_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=19 row-size=56B cardinality=17.05K
|  |  in pipelines: 49(GETNEXT), 23(OPEN)
|  |
|  48:EXCHANGE [HASH(sts.ss_item_sk)]
|  |  mem-estimate=490.90KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=19 row-size=56B cardinality=17.05K
|  |  in pipelines: 23(GETNEXT)
|  |
|  F10:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  Per-Host Resources: mem-estimate=96.52MB mem-reservation=11.81MB thread-reservation=2 runtime-filters-memory=1.00MB
|  28:AGGREGATE [STREAMING]
|  |  output: sum(CAST(coalesce(sr.sr_return_quantity, CAST(0 AS INT)) AS BIGINT)), sum(CAST(coalesce(sts.ss_quantity, CAST(0 AS INT)) AS BIGINT)), sum(coalesce(sr.sr_return_amt, CAST(0 AS DECIMAL(7,2)))), sum(coalesce(sts.ss_net_paid, CAST(0 AS DECIMAL(7,2))))
|  |  group by: sts.ss_item_sk
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=19 row-size=56B cardinality=17.05K
|  |  in pipelines: 23(GETNEXT)
|  |
|  27:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  runtime filters: RF004[bloom] <- d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=16,17N,18 row-size=68B cardinality=17.05K
|  |  in pipelines: 23(GETNEXT), 25(OPEN)
|  |
|  |--47:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=18 row-size=12B cardinality=108
|  |  |  in pipelines: 25(GETNEXT)
|  |  |
|  |  F12:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=48.06MB mem-reservation=512.00KB thread-reservation=2
|  |  25:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     mem-estimate=48.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=18 row-size=12B cardinality=108
|  |     in pipelines: 25(GETNEXT)
|  |
|  26:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
|  |  hash predicates: sts.ss_item_sk = sr.sr_item_sk, sts.ss_ticket_number = sr.sr_ticket_number
|  |  fk/pk conjuncts: sts.ss_item_sk = sr.sr_item_sk, sts.ss_ticket_number = sr.sr_ticket_number
|  |  other predicates: sr.sr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=16,17N row-size=56B cardinality=17.05K(filtered from 288.04K)
|  |  in pipelines: 23(GETNEXT), 24(OPEN)
|  |
|  |--46:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=701.85KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=17 row-size=24B cardinality=28.75K
|  |  |  in pipelines: 24(GETNEXT)
|  |  |
|  |  F11:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=96.11MB mem-reservation=4.00MB thread-reservation=2
|  |  24:SCAN HDFS [tpcds_parquet.store_returns sr, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=15.43MB
|  |     predicates: sr.sr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  |     stored statistics:
|  |       table: rows=287.51K size=15.43MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=287.51K
|  |     parquet statistics predicates: sr.sr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  |     parquet dictionary predicates: sr.sr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |     tuple-ids=17 row-size=24B cardinality=28.75K
|  |     in pipelines: 24(GETNEXT)
|  |
|  23:SCAN HDFS [tpcds_parquet.store_sales sts, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=200.96MB
|     predicates: sts.ss_net_paid > CAST(0 AS DECIMAL(3,0)), sts.ss_net_profit > CAST(1 AS DECIMAL(3,0)), sts.ss_quantity > CAST(0 AS INT)
|     runtime filters: RF004[bloom] -> ss_sold_date_sk
|     stored statistics:
|       table: rows=2.88M size=200.96MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K est-scan-range=109(filtered from 1824)
|     parquet statistics predicates: sts.ss_net_paid > CAST(0 AS DECIMAL(3,0)), sts.ss_net_profit > CAST(1 AS DECIMAL(3,0)), sts.ss_quantity > CAST(0 AS INT)
|     parquet dictionary predicates: sts.ss_net_paid > CAST(0 AS DECIMAL(3,0)), sts.ss_net_profit > CAST(1 AS DECIMAL(3,0)), sts.ss_quantity > CAST(0 AS INT)
|     mem-estimate=80.00MB mem-reservation=4.00MB thread-reservation=1
|     tuple-ids=16 row-size=32B cardinality=17.05K(filtered from 288.04K)
|     in pipelines: 23(GETNEXT)
|
|--22:SELECT
|  |  predicates: (rank() <= CAST(10 AS BIGINT) OR rank() <= CAST(10 AS BIGINT))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=47,44 row-size=104B cardinality=853
|  |  in pipelines: 20(GETNEXT)
|  |
|  21:ANALYTIC
|  |  functions: rank()
|  |  order by: (CAST(sum(coalesce(cr.cr_return_amount, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  |  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  |  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=47,44 row-size=104B cardinality=8.53K
|  |  in pipelines: 20(GETNEXT)
|  |
|  20:SORT
|  |  order by: (CAST(sum(coalesce(cr.cr_return_amount, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  |  materialized: (CAST(sum(coalesce(cr.cr_return_amount, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_net_paid, 0)) AS DECIMAL(15,4)))
|  |  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=47 row-size=96B cardinality=8.53K
|  |  in pipelines: 20(GETNEXT), 18(OPEN)
|  |
|  19:ANALYTIC
|  |  functions: rank()
|  |  order by: (CAST(sum(coalesce(cr.cr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  |  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=45,42 row-size=80B cardinality=8.53K
|  |  in pipelines: 18(GETNEXT)
|  |
|  45:MERGING-EXCHANGE [UNPARTITIONED]
|  |  order by: (CAST(sum(coalesce(cr.cr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  mem-estimate=427.95KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=45 row-size=72B cardinality=8.53K
|  |  in pipelines: 18(GETNEXT)
|  |
|  F08:PLAN FRAGMENT [HASH(cs.cs_item_sk)] hosts=3 instances=3
|  Per-Host Resources: mem-estimate=16.00MB mem-reservation=7.94MB thread-reservation=1
|  18:SORT
|  |  order by: (CAST(sum(coalesce(cr.cr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  materialized: (CAST(sum(coalesce(cr.cr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_quantity, 0)) AS DECIMAL(15,4)))
|  |  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=45 row-size=72B cardinality=8.53K
|  |  in pipelines: 18(GETNEXT), 44(OPEN)
|  |
|  44:AGGREGATE [FINALIZE]
|  |  output: sum:merge(coalesce(cr.cr_return_quantity, 0)), sum:merge(coalesce(cs.cs_quantity, 0)), sum:merge(coalesce(cr.cr_return_amount, 0)), sum:merge(coalesce(cs.cs_net_paid, 0))
|  |  group by: cs.cs_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=11 row-size=56B cardinality=8.53K
|  |  in pipelines: 44(GETNEXT), 12(OPEN)
|  |
|  43:EXCHANGE [HASH(cs.cs_item_sk)]
|  |  mem-estimate=335.51KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=11 row-size=56B cardinality=8.53K
|  |  in pipelines: 12(GETNEXT)
|  |
|  F05:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  Per-Host Resources: mem-estimate=303.58MB mem-reservation=22.88MB thread-reservation=2 runtime-filters-memory=1.00MB
|  17:AGGREGATE [STREAMING]
|  |  output: sum(CAST(coalesce(cr.cr_return_quantity, CAST(0 AS INT)) AS BIGINT)), sum(CAST(coalesce(cs.cs_quantity, CAST(0 AS INT)) AS BIGINT)), sum(coalesce(cr.cr_return_amount, CAST(0 AS DECIMAL(7,2)))), sum(coalesce(cs.cs_net_paid, CAST(0 AS DECIMAL(7,2))))
|  |  group by: cs.cs_item_sk
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=11 row-size=56B cardinality=8.53K
|  |  in pipelines: 12(GETNEXT)
|  |
|  16:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  runtime filters: RF002[bloom] <- d_date_sk, RF003[min_max] <- d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=8,9N,10 row-size=68B cardinality=8.53K
|  |  in pipelines: 12(GETNEXT), 14(OPEN)
|  |
|  |--42:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=10 row-size=12B cardinality=108
|  |  |  in pipelines: 14(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=48.06MB mem-reservation=512.00KB thread-reservation=2
|  |  14:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     mem-estimate=48.00MB mem-reservation=512.00KB thread-reservation=1
|  |     tuple-ids=10 row-size=12B cardinality=108
|  |     in pipelines: 14(GETNEXT)
|  |
|  15:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
|  |  hash predicates: cs.cs_item_sk = cr.cr_item_sk, cs.cs_order_number = cr.cr_order_number
|  |  fk/pk conjuncts: cs.cs_item_sk = cr.cr_item_sk, cs.cs_order_number = cr.cr_order_number
|  |  other predicates: cr.cr_return_amount > CAST(10000 AS DECIMAL(5,0))
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=8,9N row-size=56B cardinality=85.31K(filtered from 144.16K)
|  |  in pipelines: 12(GETNEXT), 13(OPEN)
|  |
|  |--41:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=365.66KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=9 row-size=24B cardinality=14.41K
|  |  |  in pipelines: 13(GETNEXT)
|  |  |
|  |  F06:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=96.11MB mem-reservation=4.00MB thread-reservation=2
|  |  13:SCAN HDFS [tpcds_parquet.catalog_returns cr, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=10.62MB
|  |     predicates: cr.cr_return_amount > CAST(10000 AS DECIMAL(5,0))
|  |     stored statistics:
|  |       table: rows=144.07K size=10.62MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=144.07K
|  |     parquet statistics predicates: cr.cr_return_amount > CAST(10000 AS DECIMAL(5,0))
|  |     parquet dictionary predicates: cr.cr_return_amount > CAST(10000 AS DECIMAL(5,0))
|  |     mem-estimate=96.00MB mem-reservation=4.00MB thread-reservation=1
|  |     tuple-ids=9 row-size=24B cardinality=14.41K
|  |     in pipelines: 13(GETNEXT)
|  |
|  12:SCAN HDFS [tpcds_parquet.catalog_sales cs, RANDOM]
|     HDFS partitions=1/1 files=3 size=96.62MB
|     predicates: cs.cs_net_paid > CAST(0 AS DECIMAL(3,0)), cs.cs_net_profit > CAST(1 AS DECIMAL(3,0)), cs.cs_quantity > CAST(0 AS INT)
|     runtime filters: RF003[min_max] -> cs_sold_date_sk, RF002[bloom] -> cs_sold_date_sk
|     stored statistics:
|       table: rows=1.44M size=96.62MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=650.14K
|     parquet statistics predicates: cs.cs_net_paid > CAST(0 AS DECIMAL(3,0)), cs.cs_net_profit > CAST(1 AS DECIMAL(3,0)), cs.cs_quantity > CAST(0 AS INT)
|     parquet dictionary predicates: cs.cs_net_paid > CAST(0 AS DECIMAL(3,0)), cs.cs_net_profit > CAST(1 AS DECIMAL(3,0)), cs.cs_quantity > CAST(0 AS INT)
|     mem-estimate=288.00MB mem-reservation=16.00MB thread-reservation=1
|     tuple-ids=8 row-size=32B cardinality=85.31K(filtered from 144.16K)
|     in pipelines: 12(GETNEXT)
|
11:SELECT
|  predicates: (rank() <= CAST(10 AS BIGINT) OR rank() <= CAST(10 AS BIGINT))
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=36,33 row-size=104B cardinality=429
|  in pipelines: 09(GETNEXT)
|
10:ANALYTIC
|  functions: rank()
|  order by: (CAST(sum(coalesce(wr.wr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=36,33 row-size=104B cardinality=4.29K
|  in pipelines: 09(GETNEXT)
|
09:SORT
|  order by: (CAST(sum(coalesce(wr.wr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  materialized: (CAST(sum(coalesce(wr.wr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_net_paid, 0)) AS DECIMAL(15,4)))
|  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=36 row-size=96B cardinality=4.29K
|  in pipelines: 09(GETNEXT), 07(OPEN)
|
08:ANALYTIC
|  functions: rank()
|  order by: (CAST(sum(coalesce(wr.wr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_quantity, 0)) AS DECIMAL(15,4))) ASC
|  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=34,31 row-size=80B cardinality=4.29K
|  in pipelines: 07(GETNEXT)
|
40:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: (CAST(sum(coalesce(wr.wr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_quantity, 0)) AS DECIMAL(15,4))) ASC
|  mem-estimate=302.68KB mem-reservation=0B thread-reservation=0
|  tuple-ids=34 row-size=72B cardinality=4.29K
|  in pipelines: 07(GETNEXT)
|
F03:PLAN FRAGMENT [HASH(ws.ws_item_sk)] hosts=2 instances=2
Per-Host Resources: mem-estimate=16.00MB mem-reservation=7.94MB thread-reservation=1
07:SORT
|  order by: (CAST(sum(coalesce(wr.wr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_quantity, 0)) AS DECIMAL(15,4))) ASC
|  materialized: (CAST(sum(coalesce(wr.wr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_quantity, 0)) AS DECIMAL(15,4)))
|  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=34 row-size=72B cardinality=4.29K
|  in pipelines: 07(GETNEXT), 39(OPEN)
|
39:AGGREGATE [FINALIZE]
|  output: sum:merge(coalesce(wr.wr_return_quantity, 0)), sum:merge(coalesce(ws.ws_quantity, 0)), sum:merge(coalesce(wr.wr_return_amt, 0)), sum:merge(coalesce(ws.ws_net_paid, 0))
|  group by: ws.ws_item_sk
|  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=3 row-size=56B cardinality=4.29K
|  in pipelines: 39(GETNEXT), 01(OPEN)
|
38:EXCHANGE [HASH(ws.ws_item_sk)]
|  mem-estimate=237.20KB mem-reservation=0B thread-reservation=0
|  tuple-ids=3 row-size=56B cardinality=4.29K
|  in pipelines: 01(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=207.34MB mem-reservation=22.88MB thread-reservation=2 runtime-filters-memory=1.00MB
06:AGGREGATE [STREAMING]
|  output: sum(CAST(coalesce(wr.wr_return_quantity, CAST(0 AS INT)) AS BIGINT)), sum(CAST(coalesce(ws.ws_quantity, CAST(0 AS INT)) AS BIGINT)), sum(coalesce(wr.wr_return_amt, CAST(0 AS DECIMAL(7,2)))), sum(coalesce(ws.ws_net_paid, CAST(0 AS DECIMAL(7,2))))
|  group by: ws.ws_item_sk
|  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=3 row-size=56B cardinality=4.29K
|  in pipelines: 01(GETNEXT)
|
05:HASH JOIN [INNER JOIN, BROADCAST]
|  hash predicates: ws_sold_date_sk = d_date_sk
|  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  runtime filters: RF000[bloom] <- d_date_sk, RF001[min_max] <- d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,1N,2 row-size=68B cardinality=4.29K
|  in pipelines: 01(GETNEXT), 03(OPEN)
|
|--37:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=108
|  |  in pipelines: 03(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=48.06MB mem-reservation=512.00KB thread-reservation=2
|  03:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.15MB
|     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.15MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|     mem-estimate=48.00MB mem-reservation=512.00KB thread-reservation=1
|     tuple-ids=2 row-size=12B cardinality=108
|     in pipelines: 03(GETNEXT)
|
04:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
|  hash predicates: ws.ws_item_sk = wr.wr_item_sk, ws.ws_order_number = wr.wr_order_number
|  fk/pk conjuncts: ws.ws_item_sk = wr.wr_item_sk, ws.ws_order_number = wr.wr_order_number
|  other predicates: wr.wr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,1N row-size=56B cardinality=42.85K(filtered from 71.94K)
|  in pipelines: 01(GETNEXT), 02(OPEN)
|
|--36:EXCHANGE [BROADCAST]
|  |  mem-estimate=196.19KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=24B cardinality=7.18K
|  |  in pipelines: 02(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=64.11MB mem-reservation=2.00MB thread-reservation=2
|  02:SCAN HDFS [tpcds_parquet.web_returns wr, RANDOM]
|     HDFS partitions=1/1 files=1 size=5.66MB
|     predicates: wr.wr_return_amt > CAST(10000 AS DECIMAL(5,0))
|     stored statistics:
|       table: rows=71.76K size=5.66MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=71.76K
|     parquet statistics predicates: wr.wr_return_amt > CAST(10000 AS DECIMAL(5,0))
|     parquet dictionary predicates: wr.wr_return_amt > CAST(10000 AS DECIMAL(5,0))
|     mem-estimate=64.00MB mem-reservation=2.00MB thread-reservation=1
|     tuple-ids=1 row-size=24B cardinality=7.18K
|     in pipelines: 02(GETNEXT)
|
01:SCAN HDFS [tpcds_parquet.web_sales ws, RANDOM]
   HDFS partitions=1/1 files=2 size=45.09MB
   predicates: ws.ws_net_paid > CAST(0 AS DECIMAL(3,0)), ws.ws_net_profit > CAST(1 AS DECIMAL(3,0)), ws.ws_quantity > CAST(0 AS INT)
   runtime filters: RF001[min_max] -> ws_sold_date_sk, RF000[bloom] -> ws_sold_date_sk
   stored statistics:
     table: rows=719.38K size=45.09MB
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=644.77K
   parquet statistics predicates: ws.ws_net_paid > CAST(0 AS DECIMAL(3,0)), ws.ws_net_profit > CAST(1 AS DECIMAL(3,0)), ws.ws_quantity > CAST(0 AS INT)
   parquet dictionary predicates: ws.ws_net_paid > CAST(0 AS DECIMAL(3,0)), ws.ws_net_profit > CAST(1 AS DECIMAL(3,0)), ws.ws_quantity > CAST(0 AS INT)
   mem-estimate=192.00MB mem-reservation=16.00MB thread-reservation=1
   tuple-ids=0 row-size=32B cardinality=42.85K(filtered from 71.94K)
   in pipelines: 01(GETNEXT)
---- PARALLELPLANS
Max Per-Host Resource Reservation: Memory=138.31MB Threads=21
Per-Host Resource Estimates: Memory=390MB
F15:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=24.84MB mem-reservation=15.94MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: channel, item, return_ratio, return_rank, currency_rank
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
35:TOP-N [LIMIT=100]
|  order by: channel ASC, return_rank ASC, currency_rank ASC, item ASC
|  mem-estimate=5.08KB mem-reservation=0B thread-reservation=0
|  tuple-ids=26 row-size=52B cardinality=100
|  in pipelines: 35(GETNEXT), 34(OPEN)
|
34:AGGREGATE [FINALIZE]
|  group by: channel, item, return_ratio, return_rank, currency_rank
|  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=24 row-size=52B cardinality=2.99K
|  in pipelines: 34(GETNEXT), 09(OPEN), 20(OPEN), 31(OPEN)
|
00:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=24 row-size=52B cardinality=2.99K
|  in pipelines: 09(GETNEXT), 20(GETNEXT), 31(GETNEXT)
|
|--33:SELECT
|  |  predicates: (rank() <= CAST(10 AS BIGINT) OR rank() <= CAST(10 AS BIGINT))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=58,55 row-size=104B cardinality=1.71K
|  |  in pipelines: 31(GETNEXT)
|  |
|  32:ANALYTIC
|  |  functions: rank()
|  |  order by: (CAST(sum(coalesce(sr.sr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  |  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  |  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=58,55 row-size=104B cardinality=17.05K
|  |  in pipelines: 31(GETNEXT)
|  |
|  31:SORT
|  |  order by: (CAST(sum(coalesce(sr.sr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  |  materialized: (CAST(sum(coalesce(sr.sr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_net_paid, 0)) AS DECIMAL(15,4)))
|  |  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=58 row-size=96B cardinality=17.05K
|  |  in pipelines: 31(GETNEXT), 29(OPEN)
|  |
|  30:ANALYTIC
|  |  functions: rank()
|  |  order by: (CAST(sum(coalesce(sr.sr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  |  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=56,53 row-size=80B cardinality=17.05K
|  |  in pipelines: 29(GETNEXT)
|  |
|  50:MERGING-EXCHANGE [UNPARTITIONED]
|  |  order by: (CAST(sum(coalesce(sr.sr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  mem-estimate=855.73KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=56 row-size=72B cardinality=17.05K
|  |  in pipelines: 29(GETNEXT)
|  |
|  F13:PLAN FRAGMENT [HASH(sts.ss_item_sk)] hosts=3 instances=6
|  Per-Instance Resources: mem-estimate=16.00MB mem-reservation=7.94MB thread-reservation=1
|  29:SORT
|  |  order by: (CAST(sum(coalesce(sr.sr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  materialized: (CAST(sum(coalesce(sr.sr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(sts.ss_quantity, 0)) AS DECIMAL(15,4)))
|  |  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=56 row-size=72B cardinality=17.05K
|  |  in pipelines: 29(GETNEXT), 49(OPEN)
|  |
|  49:AGGREGATE [FINALIZE]
|  |  output: sum:merge(coalesce(sr.sr_return_quantity, 0)), sum:merge(coalesce(sts.ss_quantity, 0)), sum:merge(coalesce(sr.sr_return_amt, 0)), sum:merge(coalesce(sts.ss_net_paid, 0))
|  |  group by: sts.ss_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=19 row-size=56B cardinality=17.05K
|  |  in pipelines: 49(GETNEXT), 23(OPEN)
|  |
|  48:EXCHANGE [HASH(sts.ss_item_sk)]
|  |  mem-estimate=670.90KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=19 row-size=56B cardinality=17.05K
|  |  in pipelines: 23(GETNEXT)
|  |
|  F10:PLAN FRAGMENT [RANDOM] hosts=3 instances=6
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=27.41MB mem-reservation=6.00MB thread-reservation=1
|  28:AGGREGATE [STREAMING]
|  |  output: sum(CAST(coalesce(sr.sr_return_quantity, CAST(0 AS INT)) AS BIGINT)), sum(CAST(coalesce(sts.ss_quantity, CAST(0 AS INT)) AS BIGINT)), sum(coalesce(sr.sr_return_amt, CAST(0 AS DECIMAL(7,2)))), sum(coalesce(sts.ss_net_paid, CAST(0 AS DECIMAL(7,2))))
|  |  group by: sts.ss_item_sk
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=19 row-size=56B cardinality=17.05K
|  |  in pipelines: 23(GETNEXT)
|  |
|  27:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=04
|  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=16,17N,18 row-size=68B cardinality=17.05K
|  |  in pipelines: 23(GETNEXT), 25(OPEN)
|  |
|  |--F20:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=03
|  |  |  build expressions: d_date_sk
|  |  |  runtime filters: RF004[bloom] <- d_date_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  47:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=18 row-size=12B cardinality=108
|  |  |  in pipelines: 25(GETNEXT)
|  |  |
|  |  F12:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  25:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=18 row-size=12B cardinality=108
|  |     in pipelines: 25(GETNEXT)
|  |
|  26:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
|  |  hash-table-id=05
|  |  hash predicates: sts.ss_item_sk = sr.sr_item_sk, sts.ss_ticket_number = sr.sr_ticket_number
|  |  fk/pk conjuncts: sts.ss_item_sk = sr.sr_item_sk, sts.ss_ticket_number = sr.sr_ticket_number
|  |  other predicates: sr.sr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=16,17N row-size=56B cardinality=17.05K(filtered from 288.04K)
|  |  in pipelines: 23(GETNEXT), 24(OPEN)
|  |
|  |--F21:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=6.44MB mem-reservation=5.75MB thread-reservation=1
|  |  JOIN BUILD
|  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  build expressions: sr.sr_item_sk, sr.sr_ticket_number
|  |  |  mem-estimate=5.75MB mem-reservation=5.75MB spill-buffer=128.00KB thread-reservation=0
|  |  |
|  |  46:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=701.85KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=17 row-size=24B cardinality=28.75K
|  |  |  in pipelines: 24(GETNEXT)
|  |  |
|  |  F11:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=24.11MB mem-reservation=4.00MB thread-reservation=1
|  |  24:SCAN HDFS [tpcds_parquet.store_returns sr, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=15.43MB
|  |     predicates: sr.sr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  |     stored statistics:
|  |       table: rows=287.51K size=15.43MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=287.51K
|  |     parquet statistics predicates: sr.sr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  |     parquet dictionary predicates: sr.sr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  |     mem-estimate=24.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=17 row-size=24B cardinality=28.75K
|  |     in pipelines: 24(GETNEXT)
|  |
|  23:SCAN HDFS [tpcds_parquet.store_sales sts, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=200.96MB
|     predicates: sts.ss_net_paid > CAST(0 AS DECIMAL(3,0)), sts.ss_net_profit > CAST(1 AS DECIMAL(3,0)), sts.ss_quantity > CAST(0 AS INT)
|     runtime filters: RF004[bloom] -> ss_sold_date_sk
|     stored statistics:
|       table: rows=2.88M size=200.96MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K est-scan-range=109(filtered from 1824)
|     parquet statistics predicates: sts.ss_net_paid > CAST(0 AS DECIMAL(3,0)), sts.ss_net_profit > CAST(1 AS DECIMAL(3,0)), sts.ss_quantity > CAST(0 AS INT)
|     parquet dictionary predicates: sts.ss_net_paid > CAST(0 AS DECIMAL(3,0)), sts.ss_net_profit > CAST(1 AS DECIMAL(3,0)), sts.ss_quantity > CAST(0 AS INT)
|     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|     tuple-ids=16 row-size=32B cardinality=17.05K(filtered from 288.04K)
|     in pipelines: 23(GETNEXT)
|
|--22:SELECT
|  |  predicates: (rank() <= CAST(10 AS BIGINT) OR rank() <= CAST(10 AS BIGINT))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=47,44 row-size=104B cardinality=853
|  |  in pipelines: 20(GETNEXT)
|  |
|  21:ANALYTIC
|  |  functions: rank()
|  |  order by: (CAST(sum(coalesce(cr.cr_return_amount, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  |  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  |  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=47,44 row-size=104B cardinality=8.53K
|  |  in pipelines: 20(GETNEXT)
|  |
|  20:SORT
|  |  order by: (CAST(sum(coalesce(cr.cr_return_amount, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  |  materialized: (CAST(sum(coalesce(cr.cr_return_amount, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_net_paid, 0)) AS DECIMAL(15,4)))
|  |  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=47 row-size=96B cardinality=8.53K
|  |  in pipelines: 20(GETNEXT), 18(OPEN)
|  |
|  19:ANALYTIC
|  |  functions: rank()
|  |  order by: (CAST(sum(coalesce(cr.cr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  |  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=45,42 row-size=80B cardinality=8.53K
|  |  in pipelines: 18(GETNEXT)
|  |
|  45:MERGING-EXCHANGE [UNPARTITIONED]
|  |  order by: (CAST(sum(coalesce(cr.cr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  mem-estimate=427.95KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=45 row-size=72B cardinality=8.53K
|  |  in pipelines: 18(GETNEXT)
|  |
|  F08:PLAN FRAGMENT [HASH(cs.cs_item_sk)] hosts=3 instances=3
|  Per-Instance Resources: mem-estimate=16.00MB mem-reservation=7.94MB thread-reservation=1
|  18:SORT
|  |  order by: (CAST(sum(coalesce(cr.cr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_quantity, 0)) AS DECIMAL(15,4))) ASC
|  |  materialized: (CAST(sum(coalesce(cr.cr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(cs.cs_quantity, 0)) AS DECIMAL(15,4)))
|  |  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=45 row-size=72B cardinality=8.53K
|  |  in pipelines: 18(GETNEXT), 44(OPEN)
|  |
|  44:AGGREGATE [FINALIZE]
|  |  output: sum:merge(coalesce(cr.cr_return_quantity, 0)), sum:merge(coalesce(cs.cs_quantity, 0)), sum:merge(coalesce(cr.cr_return_amount, 0)), sum:merge(coalesce(cs.cs_net_paid, 0))
|  |  group by: cs.cs_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=11 row-size=56B cardinality=8.53K
|  |  in pipelines: 44(GETNEXT), 12(OPEN)
|  |
|  43:EXCHANGE [HASH(cs.cs_item_sk)]
|  |  mem-estimate=335.51KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=11 row-size=56B cardinality=8.53K
|  |  in pipelines: 12(GETNEXT)
|  |
|  F05:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=58.70MB mem-reservation=18.00MB thread-reservation=1
|  17:AGGREGATE [STREAMING]
|  |  output: sum(CAST(coalesce(cr.cr_return_quantity, CAST(0 AS INT)) AS BIGINT)), sum(CAST(coalesce(cs.cs_quantity, CAST(0 AS INT)) AS BIGINT)), sum(coalesce(cr.cr_return_amount, CAST(0 AS DECIMAL(7,2)))), sum(coalesce(cs.cs_net_paid, CAST(0 AS DECIMAL(7,2))))
|  |  group by: cs.cs_item_sk
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=11 row-size=56B cardinality=8.53K
|  |  in pipelines: 12(GETNEXT)
|  |
|  16:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=02
|  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=8,9N,10 row-size=68B cardinality=8.53K
|  |  in pipelines: 12(GETNEXT), 14(OPEN)
|  |
|  |--F18:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  JOIN BUILD
|  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  build expressions: d_date_sk
|  |  |  runtime filters: RF002[bloom] <- d_date_sk, RF003[min_max] <- d_date_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  42:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=10 row-size=12B cardinality=108
|  |  |  in pipelines: 14(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  14:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=10 row-size=12B cardinality=108
|  |     in pipelines: 14(GETNEXT)
|  |
|  15:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
|  |  hash-table-id=03
|  |  hash predicates: cs.cs_item_sk = cr.cr_item_sk, cs.cs_order_number = cr.cr_order_number
|  |  fk/pk conjuncts: cs.cs_item_sk = cr.cr_item_sk, cs.cs_order_number = cr.cr_order_number
|  |  other predicates: cr.cr_return_amount > CAST(10000 AS DECIMAL(5,0))
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=8,9N row-size=56B cardinality=85.31K(filtered from 144.16K)
|  |  in pipelines: 12(GETNEXT), 13(OPEN)
|  |
|  |--F19:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=4.23MB mem-reservation=3.88MB thread-reservation=1
|  |  JOIN BUILD
|  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  build expressions: cr.cr_item_sk, cr.cr_order_number
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |  |
|  |  41:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=365.66KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=9 row-size=24B cardinality=14.41K
|  |  |  in pipelines: 13(GETNEXT)
|  |  |
|  |  F06:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=24.11MB mem-reservation=4.00MB thread-reservation=1
|  |  13:SCAN HDFS [tpcds_parquet.catalog_returns cr, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=10.62MB
|  |     predicates: cr.cr_return_amount > CAST(10000 AS DECIMAL(5,0))
|  |     stored statistics:
|  |       table: rows=144.07K size=10.62MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=144.07K
|  |     parquet statistics predicates: cr.cr_return_amount > CAST(10000 AS DECIMAL(5,0))
|  |     parquet dictionary predicates: cr.cr_return_amount > CAST(10000 AS DECIMAL(5,0))
|  |     mem-estimate=24.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=9 row-size=24B cardinality=14.41K
|  |     in pipelines: 13(GETNEXT)
|  |
|  12:SCAN HDFS [tpcds_parquet.catalog_sales cs, RANDOM]
|     HDFS partitions=1/1 files=3 size=96.62MB
|     predicates: cs.cs_net_paid > CAST(0 AS DECIMAL(3,0)), cs.cs_net_profit > CAST(1 AS DECIMAL(3,0)), cs.cs_quantity > CAST(0 AS INT)
|     runtime filters: RF003[min_max] -> cs_sold_date_sk, RF002[bloom] -> cs_sold_date_sk
|     stored statistics:
|       table: rows=1.44M size=96.62MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=650.14K
|     parquet statistics predicates: cs.cs_net_paid > CAST(0 AS DECIMAL(3,0)), cs.cs_net_profit > CAST(1 AS DECIMAL(3,0)), cs.cs_quantity > CAST(0 AS INT)
|     parquet dictionary predicates: cs.cs_net_paid > CAST(0 AS DECIMAL(3,0)), cs.cs_net_profit > CAST(1 AS DECIMAL(3,0)), cs.cs_quantity > CAST(0 AS INT)
|     mem-estimate=48.00MB mem-reservation=16.00MB thread-reservation=0
|     tuple-ids=8 row-size=32B cardinality=85.31K(filtered from 144.16K)
|     in pipelines: 12(GETNEXT)
|
11:SELECT
|  predicates: (rank() <= CAST(10 AS BIGINT) OR rank() <= CAST(10 AS BIGINT))
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=36,33 row-size=104B cardinality=429
|  in pipelines: 09(GETNEXT)
|
10:ANALYTIC
|  functions: rank()
|  order by: (CAST(sum(coalesce(wr.wr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=36,33 row-size=104B cardinality=4.29K
|  in pipelines: 09(GETNEXT)
|
09:SORT
|  order by: (CAST(sum(coalesce(wr.wr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_net_paid, 0)) AS DECIMAL(15,4))) ASC
|  materialized: (CAST(sum(coalesce(wr.wr_return_amt, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_net_paid, 0)) AS DECIMAL(15,4)))
|  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=36 row-size=96B cardinality=4.29K
|  in pipelines: 09(GETNEXT), 07(OPEN)
|
08:ANALYTIC
|  functions: rank()
|  order by: (CAST(sum(coalesce(wr.wr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_quantity, 0)) AS DECIMAL(15,4))) ASC
|  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=34,31 row-size=80B cardinality=4.29K
|  in pipelines: 07(GETNEXT)
|
40:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: (CAST(sum(coalesce(wr.wr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_quantity, 0)) AS DECIMAL(15,4))) ASC
|  mem-estimate=302.68KB mem-reservation=0B thread-reservation=0
|  tuple-ids=34 row-size=72B cardinality=4.29K
|  in pipelines: 07(GETNEXT)
|
F03:PLAN FRAGMENT [HASH(ws.ws_item_sk)] hosts=2 instances=2
Per-Instance Resources: mem-estimate=16.00MB mem-reservation=7.94MB thread-reservation=1
07:SORT
|  order by: (CAST(sum(coalesce(wr.wr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_quantity, 0)) AS DECIMAL(15,4))) ASC
|  materialized: (CAST(sum(coalesce(wr.wr_return_quantity, 0)) AS DECIMAL(15,4)) / CAST(sum(coalesce(ws.ws_quantity, 0)) AS DECIMAL(15,4)))
|  mem-estimate=6.00MB mem-reservation=6.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=34 row-size=72B cardinality=4.29K
|  in pipelines: 07(GETNEXT), 39(OPEN)
|
39:AGGREGATE [FINALIZE]
|  output: sum:merge(coalesce(wr.wr_return_quantity, 0)), sum:merge(coalesce(ws.ws_quantity, 0)), sum:merge(coalesce(wr.wr_return_amt, 0)), sum:merge(coalesce(ws.ws_net_paid, 0))
|  group by: ws.ws_item_sk
|  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=3 row-size=56B cardinality=4.29K
|  in pipelines: 39(GETNEXT), 01(OPEN)
|
38:EXCHANGE [HASH(ws.ws_item_sk)]
|  mem-estimate=237.20KB mem-reservation=0B thread-reservation=0
|  tuple-ids=3 row-size=56B cardinality=4.29K
|  in pipelines: 01(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
Per-Instance Resources: mem-estimate=42.47MB mem-reservation=18.00MB thread-reservation=1
06:AGGREGATE [STREAMING]
|  output: sum(CAST(coalesce(wr.wr_return_quantity, CAST(0 AS INT)) AS BIGINT)), sum(CAST(coalesce(ws.ws_quantity, CAST(0 AS INT)) AS BIGINT)), sum(coalesce(wr.wr_return_amt, CAST(0 AS DECIMAL(7,2)))), sum(coalesce(ws.ws_net_paid, CAST(0 AS DECIMAL(7,2))))
|  group by: ws.ws_item_sk
|  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=3 row-size=56B cardinality=4.29K
|  in pipelines: 01(GETNEXT)
|
05:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=00
|  hash predicates: ws_sold_date_sk = d_date_sk
|  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,1N,2 row-size=68B cardinality=4.29K
|  in pipelines: 01(GETNEXT), 03(OPEN)
|
|--F16:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  build expressions: d_date_sk
|  |  runtime filters: RF000[bloom] <- d_date_sk, RF001[min_max] <- d_date_sk
|  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |
|  37:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=108
|  |  in pipelines: 03(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  03:SCAN HDFS [tpcds_parquet.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.15MB
|     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.15MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(12 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108
|     in pipelines: 03(GETNEXT)
|
04:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
|  hash-table-id=01
|  hash predicates: ws.ws_item_sk = wr.wr_item_sk, ws.ws_order_number = wr.wr_order_number
|  fk/pk conjuncts: ws.ws_item_sk = wr.wr_item_sk, ws.ws_order_number = wr.wr_order_number
|  other predicates: wr.wr_return_amt > CAST(10000 AS DECIMAL(5,0))
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,1N row-size=56B cardinality=42.85K(filtered from 71.94K)
|  in pipelines: 01(GETNEXT), 02(OPEN)
|
|--F17:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  Per-Instance Resources: mem-estimate=4.07MB mem-reservation=3.88MB thread-reservation=1
|  JOIN BUILD
|  |  join-table-id=01 plan-id=02 cohort-id=01
|  |  build expressions: wr.wr_item_sk, wr.wr_order_number
|  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0
|  |
|  36:EXCHANGE [BROADCAST]
|  |  mem-estimate=196.19KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=24B cardinality=7.18K
|  |  in pipelines: 02(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.11MB mem-reservation=2.00MB thread-reservation=1
|  02:SCAN HDFS [tpcds_parquet.web_returns wr, RANDOM]
|     HDFS partitions=1/1 files=1 size=5.66MB
|     predicates: wr.wr_return_amt > CAST(10000 AS DECIMAL(5,0))
|     stored statistics:
|       table: rows=71.76K size=5.66MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=71.76K
|     parquet statistics predicates: wr.wr_return_amt > CAST(10000 AS DECIMAL(5,0))
|     parquet dictionary predicates: wr.wr_return_amt > CAST(10000 AS DECIMAL(5,0))
|     mem-estimate=16.00MB mem-reservation=2.00MB thread-reservation=0
|     tuple-ids=1 row-size=24B cardinality=7.18K
|     in pipelines: 02(GETNEXT)
|
01:SCAN HDFS [tpcds_parquet.web_sales ws, RANDOM]
   HDFS partitions=1/1 files=2 size=45.09MB
   predicates: ws.ws_net_paid > CAST(0 AS DECIMAL(3,0)), ws.ws_net_profit > CAST(1 AS DECIMAL(3,0)), ws.ws_quantity > CAST(0 AS INT)
   runtime filters: RF001[min_max] -> ws_sold_date_sk, RF000[bloom] -> ws_sold_date_sk
   stored statistics:
     table: rows=719.38K size=45.09MB
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=644.77K
   parquet statistics predicates: ws.ws_net_paid > CAST(0 AS DECIMAL(3,0)), ws.ws_net_profit > CAST(1 AS DECIMAL(3,0)), ws.ws_quantity > CAST(0 AS INT)
   parquet dictionary predicates: ws.ws_net_paid > CAST(0 AS DECIMAL(3,0)), ws.ws_net_profit > CAST(1 AS DECIMAL(3,0)), ws.ws_quantity > CAST(0 AS INT)
   mem-estimate=32.00MB mem-reservation=16.00MB thread-reservation=0
   tuple-ids=0 row-size=32B cardinality=42.85K(filtered from 71.94K)
   in pipelines: 01(GETNEXT)
====
