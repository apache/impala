SELECT count(*) from iceberg_v2_no_deletes
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
PLAN-ROOT SINK
|  output exprs: count(*)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
00:UNION
   constant-operands=1
   mem-estimate=0B mem-reservation=0B thread-reservation=0
   tuple-ids=0 row-size=8B cardinality=1
   in pipelines: <none>
---- DISTRIBUTEDPLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
PLAN-ROOT SINK
|  output exprs: count(*)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
00:UNION
   constant-operands=1
   mem-estimate=0B mem-reservation=0B thread-reservation=0
   tuple-ids=0 row-size=8B cardinality=1
   in pipelines: <none>
====
SELECT count(*) from iceberg_v2_no_deletes where i > 1
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=16.02MB mem-reservation=8.00KB thread-reservation=2
PLAN-ROOT SINK
|  output exprs: count(*)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
01:AGGREGATE [FINALIZE]
|  output: count(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 01(GETNEXT), 00(OPEN)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_no_deletes]
   HDFS partitions=1/1 files=1 size=625B
   predicates: i > CAST(1 AS INT)
   Iceberg snapshot id: 728158873687794725
   stored statistics:
     table: rows=3 size=625B
     columns: unavailable
   extrapolated-rows=disabled max-scan-range-rows=3
   parquet statistics predicates: i > CAST(1 AS INT)
   parquet dictionary predicates: i > CAST(1 AS INT)
   mem-estimate=16.00MB mem-reservation=8.00KB thread-reservation=1
   tuple-ids=0 row-size=4B cardinality=1
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
F01:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=32.00KB mem-reservation=0B thread-reservation=1
PLAN-ROOT SINK
|  output exprs: count(*)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
03:AGGREGATE [FINALIZE]
|  output: count:merge(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT), 01(OPEN)
|
02:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 01(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=16.02MB mem-reservation=8.00KB thread-reservation=2
01:AGGREGATE
|  output: count(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 01(GETNEXT), 00(OPEN)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_no_deletes, RANDOM]
   HDFS partitions=1/1 files=1 size=625B
   predicates: i > CAST(1 AS INT)
   Iceberg snapshot id: 728158873687794725
   stored statistics:
     table: rows=3 size=625B
     columns: unavailable
   extrapolated-rows=disabled max-scan-range-rows=3
   parquet statistics predicates: i > CAST(1 AS INT)
   parquet dictionary predicates: i > CAST(1 AS INT)
   mem-estimate=16.00MB mem-reservation=8.00KB thread-reservation=1
   tuple-ids=0 row-size=4B cardinality=1
   in pipelines: 00(GETNEXT)
====
SELECT count(*) from iceberg_v2_delete_positional;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=64.00MB mem-reservation=32.68KB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: count(*)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
03:AGGREGATE [FINALIZE]
|  output: count(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT), 00(OPEN)
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  equality predicates: functional_parquet.iceberg_v2_delete_positional.file__position = functional_parquet.iceberg_v2_delete_positional-position-delete.pos, functional_parquet.iceberg_v2_delete_positional.input__file__name = functional_parquet.iceberg_v2_delete_positional-position-delete.file_path
|  mem-estimate=696B mem-reservation=696B thread-reservation=0
|  tuple-ids=0 row-size=20B cardinality=2
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_positional-position-delete]
|     HDFS partitions=1/1 files=1 size=1.54KB
|     Iceberg snapshot id: 5725822353600261755
|     stored statistics:
|       table: rows=1 size=1.54KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=2 row-size=182B cardinality=1
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional]
   HDFS partitions=1/1 files=1 size=662B
   Iceberg snapshot id: 5725822353600261755
   stored statistics:
     table: rows=3 size=2.21KB
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=3
   mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
   tuple-ids=0 row-size=20B cardinality=3
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
F02:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=32.00KB mem-reservation=0B thread-reservation=1
PLAN-ROOT SINK
|  output exprs: count(*)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
06:AGGREGATE [FINALIZE]
|  output: count:merge(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 06(GETNEXT), 03(OPEN)
|
05:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=32.02MB mem-reservation=16.68KB thread-reservation=2
03:AGGREGATE
|  output: count(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT), 00(OPEN)
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  equality predicates: functional_parquet.iceberg_v2_delete_positional.file__position = functional_parquet.iceberg_v2_delete_positional-position-delete.pos, functional_parquet.iceberg_v2_delete_positional.input__file__name = functional_parquet.iceberg_v2_delete_positional-position-delete.file_path
|  mem-estimate=696B mem-reservation=696B thread-reservation=0
|  tuple-ids=0 row-size=20B cardinality=2
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--04:EXCHANGE [DIRECTED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=182B cardinality=1
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=32.73MB mem-reservation=16.00KB thread-reservation=2
|  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_positional-position-delete, RANDOM]
|     HDFS partitions=1/1 files=1 size=1.54KB
|     Iceberg snapshot id: 5725822353600261755
|     stored statistics:
|       table: rows=1 size=1.54KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=2 row-size=182B cardinality=1
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional, RANDOM]
   HDFS partitions=1/1 files=1 size=662B
   Iceberg snapshot id: 5725822353600261755
   stored statistics:
     table: rows=3 size=2.21KB
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=3
   mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
   tuple-ids=0 row-size=20B cardinality=3
   in pipelines: 00(GETNEXT)
====
SELECT * from iceberg_v2_delete_positional;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=96.00MB mem-reservation=4.03MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_positional.id, functional_parquet.iceberg_v2_delete_positional.data
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  equality predicates: functional_parquet.iceberg_v2_delete_positional.file__position = functional_parquet.iceberg_v2_delete_positional-position-delete.pos, functional_parquet.iceberg_v2_delete_positional.input__file__name = functional_parquet.iceberg_v2_delete_positional-position-delete.file_path
|  mem-estimate=696B mem-reservation=696B thread-reservation=0
|  tuple-ids=0 row-size=40B cardinality=2
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_positional-position-delete]
|     HDFS partitions=1/1 files=1 size=1.54KB
|     Iceberg snapshot id: 5725822353600261755
|     stored statistics:
|       table: rows=1 size=1.54KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=182B cardinality=1
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional]
   HDFS partitions=1/1 files=1 size=662B
   Iceberg snapshot id: 5725822353600261755
   stored statistics:
     table: rows=3 size=2.21KB
     columns missing stats: id, data
   extrapolated-rows=disabled max-scan-range-rows=3
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=40B cardinality=3
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
F02:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_positional.id, functional_parquet.iceberg_v2_delete_positional.data
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=40B cardinality=2
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=64.17MB mem-reservation=32.68KB thread-reservation=2
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  equality predicates: functional_parquet.iceberg_v2_delete_positional.file__position = functional_parquet.iceberg_v2_delete_positional-position-delete.pos, functional_parquet.iceberg_v2_delete_positional.input__file__name = functional_parquet.iceberg_v2_delete_positional-position-delete.file_path
|  mem-estimate=696B mem-reservation=696B thread-reservation=0
|  tuple-ids=0 row-size=40B cardinality=2
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--03:EXCHANGE [DIRECTED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=182B cardinality=1
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=32.73MB mem-reservation=16.00KB thread-reservation=2
|  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_positional-position-delete, RANDOM]
|     HDFS partitions=1/1 files=1 size=1.54KB
|     Iceberg snapshot id: 5725822353600261755
|     stored statistics:
|       table: rows=1 size=1.54KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=182B cardinality=1
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional, RANDOM]
   HDFS partitions=1/1 files=1 size=662B
   Iceberg snapshot id: 5725822353600261755
   stored statistics:
     table: rows=3 size=2.21KB
     columns missing stats: id, data
   extrapolated-rows=disabled max-scan-range-rows=3
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=40B cardinality=3
   in pipelines: 00(GETNEXT)
====
SELECT * from iceberg_v2_positional_delete_all_rows;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=96.00MB mem-reservation=4.03MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_delete_all_rows.i, functional_parquet.iceberg_v2_positional_delete_all_rows.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  equality predicates: functional_parquet.iceberg_v2_positional_delete_all_rows.file__position = functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete.pos, functional_parquet.iceberg_v2_positional_delete_all_rows.input__file__name = functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete.file_path
|  mem-estimate=764B mem-reservation=764B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=1
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete]
|     HDFS partitions=1/1 files=1 size=2.60KB
|     Iceberg snapshot id: 444149380144800647
|     stored statistics:
|       table: rows=3 size=2.60KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=246B cardinality=3
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 444149380144800647
   stored statistics:
     table: rows=3 size=3.21KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=3
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=3
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
F02:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_delete_all_rows.i, functional_parquet.iceberg_v2_positional_delete_all_rows.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=1
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=64.16MB mem-reservation=32.75KB thread-reservation=2
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  equality predicates: functional_parquet.iceberg_v2_positional_delete_all_rows.file__position = functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete.pos, functional_parquet.iceberg_v2_positional_delete_all_rows.input__file__name = functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete.file_path
|  mem-estimate=764B mem-reservation=764B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=1
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--03:EXCHANGE [DIRECTED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=246B cardinality=3
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=32.98MB mem-reservation=16.00KB thread-reservation=2
|  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.60KB
|     Iceberg snapshot id: 444149380144800647
|     stored statistics:
|       table: rows=3 size=2.60KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=246B cardinality=3
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows, RANDOM]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 444149380144800647
   stored statistics:
     table: rows=3 size=3.21KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=3
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=3
   in pipelines: 00(GETNEXT)
====
SELECT * from iceberg_v2_positional_delete_all_rows limit 1
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=96.00MB mem-reservation=48.75KB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_delete_all_rows.i, functional_parquet.iceberg_v2_positional_delete_all_rows.s
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  equality predicates: functional_parquet.iceberg_v2_positional_delete_all_rows.file__position = functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete.pos, functional_parquet.iceberg_v2_positional_delete_all_rows.input__file__name = functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete.file_path
|  limit: 1
|  mem-estimate=764B mem-reservation=764B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=1
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete]
|     HDFS partitions=1/1 files=1 size=2.60KB
|     Iceberg snapshot id: 444149380144800647
|     stored statistics:
|       table: rows=3 size=2.60KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=246B cardinality=3
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 444149380144800647
   stored statistics:
     table: rows=3 size=3.21KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=3
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=3
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
F02:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=16.00KB mem-reservation=0B thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_delete_all_rows.i, functional_parquet.iceberg_v2_positional_delete_all_rows.s
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
04:EXCHANGE [UNPARTITIONED]
|  limit: 1
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=1
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=64.16MB mem-reservation=32.75KB thread-reservation=2
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  equality predicates: functional_parquet.iceberg_v2_positional_delete_all_rows.file__position = functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete.pos, functional_parquet.iceberg_v2_positional_delete_all_rows.input__file__name = functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete.file_path
|  limit: 1
|  mem-estimate=764B mem-reservation=764B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=1
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--03:EXCHANGE [DIRECTED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=246B cardinality=3
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=32.98MB mem-reservation=16.00KB thread-reservation=2
|  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.60KB
|     Iceberg snapshot id: 444149380144800647
|     stored statistics:
|       table: rows=3 size=2.60KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=246B cardinality=3
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows, RANDOM]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 444149380144800647
   stored statistics:
     table: rows=3 size=3.21KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=3
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=3
   in pipelines: 00(GETNEXT)
====
SELECT * from iceberg_v2_positional_not_all_data_files_have_delete_files limit 1
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=96.00MB mem-reservation=49.53KB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
04:UNION
|  pass-through-operands: all
|  limit: 1
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=1
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=1.53KB mem-reservation=1.53KB thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=2
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=267B cardinality=4
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=6
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=5
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=4
   in pipelines: 03(GETNEXT)
---- DISTRIBUTEDPLAN
F04:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=16.00KB mem-reservation=0B thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
06:EXCHANGE [UNPARTITIONED]
|  limit: 1
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=1
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
F03:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=64.17MB mem-reservation=32.76KB thread-reservation=2
04:UNION
|  pass-through-operands: all
|  limit: 1
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=1
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=783B mem-reservation=783B thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=2
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--05:EXCHANGE [DIRECTED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=1 row-size=267B cardinality=4
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  Per-Host Resources: mem-estimate=34.12MB mem-reservation=16.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete, RANDOM]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=267B cardinality=4
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=6
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=5
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=4
   in pipelines: 03(GETNEXT)
====
SELECT * from iceberg_v2_positional_not_all_data_files_have_delete_files
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=100.00MB mem-reservation=4.05MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=1.53KB mem-reservation=1.53KB thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=2
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=267B cardinality=4
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=6
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=5
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=4
   in pipelines: 03(GETNEXT)
---- DISTRIBUTEDPLAN
F04:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
06:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
F03:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=64.17MB mem-reservation=32.76KB thread-reservation=2
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=783B mem-reservation=783B thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=2
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--05:EXCHANGE [DIRECTED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=1 row-size=267B cardinality=4
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  Per-Host Resources: mem-estimate=34.12MB mem-reservation=16.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete, RANDOM]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=267B cardinality=4
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=6
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=5
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=4
   in pipelines: 03(GETNEXT)
====
SELECT count(*) from iceberg_v2_positional_not_all_data_files_have_delete_files for system_version as of 7490459762454857930;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
PLAN-ROOT SINK
|  output exprs: count(*)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
00:UNION
   constant-operands=1
   mem-estimate=0B mem-reservation=0B thread-reservation=0
   tuple-ids=0 row-size=8B cardinality=1
   in pipelines: <none>
---- DISTRIBUTEDPLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=0B mem-reservation=0B thread-reservation=1
PLAN-ROOT SINK
|  output exprs: count(*)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
00:UNION
   constant-operands=1
   mem-estimate=0B mem-reservation=0B thread-reservation=0
   tuple-ids=0 row-size=8B cardinality=1
   in pipelines: <none>
====
SELECT count(*) from iceberg_v2_positional_not_all_data_files_have_delete_files for system_version as of 752781918366351945;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=64.00MB mem-reservation=32.76KB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: count(*) + CAST(7 AS BIGINT)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
03:AGGREGATE [FINALIZE]
|  output: count(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT), 00(OPEN)
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  mem-estimate=781B mem-reservation=781B thread-reservation=0
|  tuple-ids=0 row-size=20B cardinality=2
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|     HDFS partitions=1/1 files=1 size=2.63KB
|     Iceberg snapshot id: 752781918366351945
|     stored statistics:
|       table: rows=1 size=2.63KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=2 row-size=267B cardinality=1
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 752781918366351945
   stored statistics:
     table: rows=10 size=7.77KB
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=10
   mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
   tuple-ids=0 row-size=20B cardinality=3
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
F02:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=32.00KB mem-reservation=0B thread-reservation=1
PLAN-ROOT SINK
|  output exprs: count(*) + CAST(7 AS BIGINT)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
06:AGGREGATE [FINALIZE]
|  output: count:merge(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 06(GETNEXT), 03(OPEN)
|
05:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=32.02MB mem-reservation=16.76KB thread-reservation=2
03:AGGREGATE
|  output: count(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT), 00(OPEN)
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  mem-estimate=781B mem-reservation=781B thread-reservation=0
|  tuple-ids=0 row-size=20B cardinality=2
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--04:EXCHANGE [DIRECTED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=267B cardinality=1
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=33.06MB mem-reservation=16.00KB thread-reservation=2
|  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.63KB
|     Iceberg snapshot id: 752781918366351945
|     stored statistics:
|       table: rows=1 size=2.63KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=2 row-size=267B cardinality=1
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 752781918366351945
   stored statistics:
     table: rows=10 size=7.77KB
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=10
   mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
   tuple-ids=0 row-size=20B cardinality=3
   in pipelines: 00(GETNEXT)
====
SELECT count(*) from iceberg_v2_positional_not_all_data_files_have_delete_files for system_time as of "2022-08-19 13:50:00";
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=64.00MB mem-reservation=32.76KB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: count(*) + CAST(7 AS BIGINT)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
03:AGGREGATE [FINALIZE]
|  output: count(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT), 00(OPEN)
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  mem-estimate=781B mem-reservation=781B thread-reservation=0
|  tuple-ids=0 row-size=20B cardinality=2
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|     HDFS partitions=1/1 files=1 size=2.63KB
|     Iceberg snapshot id: 752781918366351945
|     stored statistics:
|       table: rows=1 size=2.63KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=2 row-size=267B cardinality=1
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 752781918366351945
   stored statistics:
     table: rows=10 size=7.77KB
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=10
   mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
   tuple-ids=0 row-size=20B cardinality=3
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
F02:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=32.00KB mem-reservation=0B thread-reservation=1
PLAN-ROOT SINK
|  output exprs: count(*) + CAST(7 AS BIGINT)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
06:AGGREGATE [FINALIZE]
|  output: count:merge(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 06(GETNEXT), 03(OPEN)
|
05:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=32.02MB mem-reservation=16.76KB thread-reservation=2
03:AGGREGATE
|  output: count(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT), 00(OPEN)
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  mem-estimate=781B mem-reservation=781B thread-reservation=0
|  tuple-ids=0 row-size=20B cardinality=2
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--04:EXCHANGE [DIRECTED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=267B cardinality=1
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=33.06MB mem-reservation=16.00KB thread-reservation=2
|  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.63KB
|     Iceberg snapshot id: 752781918366351945
|     stored statistics:
|       table: rows=1 size=2.63KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=2 row-size=267B cardinality=1
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 752781918366351945
   stored statistics:
     table: rows=10 size=7.77KB
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=10
   mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
   tuple-ids=0 row-size=20B cardinality=3
   in pipelines: 00(GETNEXT)
====
SELECT count(*) from iceberg_v2_positional_not_all_data_files_have_delete_files;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=64.00MB mem-reservation=33.53KB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: count(*) + CAST(4 AS BIGINT)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
03:AGGREGATE [FINALIZE]
|  output: count(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT), 00(OPEN)
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  mem-estimate=1.53KB mem-reservation=1.53KB thread-reservation=0
|  tuple-ids=0 row-size=20B cardinality=2
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|     HDFS partitions=1/1 files=2 size=5.33KB
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=4 size=5.33KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=2
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=2 row-size=267B cardinality=4
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=5
   mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
   tuple-ids=0 row-size=20B cardinality=6
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
F02:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=32.00KB mem-reservation=0B thread-reservation=1
PLAN-ROOT SINK
|  output exprs: count(*) + CAST(4 AS BIGINT)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|
06:AGGREGATE [FINALIZE]
|  output: count:merge(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 06(GETNEXT), 03(OPEN)
|
05:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=32.02MB mem-reservation=16.76KB thread-reservation=2
03:AGGREGATE
|  output: count(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT), 00(OPEN)
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  mem-estimate=783B mem-reservation=783B thread-reservation=0
|  tuple-ids=0 row-size=20B cardinality=2
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--04:EXCHANGE [DIRECTED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=267B cardinality=4
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  Per-Host Resources: mem-estimate=34.12MB mem-reservation=16.00KB thread-reservation=2
|  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete, RANDOM]
|     HDFS partitions=1/1 files=2 size=5.33KB
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=4 size=5.33KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=2
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=2 row-size=267B cardinality=4
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=5
   mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
   tuple-ids=0 row-size=20B cardinality=6
   in pipelines: 00(GETNEXT)
====
SELECT * from iceberg_v2_positional_update_all_rows
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=100.00MB mem-reservation=4.05MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_update_all_rows.i, functional_parquet.iceberg_v2_positional_update_all_rows.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=4
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_update_all_rows.file__position = functional_parquet.iceberg_v2_positional_update_all_rows-position-delete.pos, functional_parquet.iceberg_v2_positional_update_all_rows.input__file__name = functional_parquet.iceberg_v2_positional_update_all_rows-position-delete.file_path
|  |  mem-estimate=764B mem-reservation=764B thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=1
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_update_all_rows-position-delete]
|  |     HDFS partitions=1/1 files=1 size=2.60KB
|  |     Iceberg snapshot id: 3877007445826010687
|  |     stored statistics:
|  |       table: rows=3 size=2.60KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=246B cardinality=3
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows]
|     HDFS partitions=1/1 files=1 size=625B
|     Iceberg snapshot id: 3877007445826010687
|     stored statistics:
|       table: rows=6 size=3.82KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=6
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=3
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 3877007445826010687
   stored statistics:
     table: rows=6 size=3.82KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=6
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=3
   in pipelines: 03(GETNEXT)
---- DISTRIBUTEDPLAN
F04:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_update_all_rows.i, functional_parquet.iceberg_v2_positional_update_all_rows.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
06:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=4
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
F03:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=64.17MB mem-reservation=32.75KB thread-reservation=2
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=4
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_update_all_rows.file__position = functional_parquet.iceberg_v2_positional_update_all_rows-position-delete.pos, functional_parquet.iceberg_v2_positional_update_all_rows.input__file__name = functional_parquet.iceberg_v2_positional_update_all_rows-position-delete.file_path
|  |  mem-estimate=764B mem-reservation=764B thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=1
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--05:EXCHANGE [DIRECTED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=1 row-size=246B cardinality=3
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=32.98MB mem-reservation=16.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_update_all_rows-position-delete, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.60KB
|  |     Iceberg snapshot id: 3877007445826010687
|  |     stored statistics:
|  |       table: rows=3 size=2.60KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=246B cardinality=3
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows, RANDOM]
|     HDFS partitions=1/1 files=1 size=625B
|     Iceberg snapshot id: 3877007445826010687
|     stored statistics:
|       table: rows=6 size=3.82KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=6
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=3
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows, RANDOM]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 3877007445826010687
   stored statistics:
     table: rows=6 size=3.82KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=6
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=3
   in pipelines: 03(GETNEXT)
====
SELECT * from iceberg_v2_partitioned_position_deletes
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=128.00MB mem-reservation=4.05MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_partitioned_position_deletes.id, functional_parquet.iceberg_v2_partitioned_position_deletes.user, functional_parquet.iceberg_v2_partitioned_position_deletes.action, functional_parquet.iceberg_v2_partitioned_position_deletes.event_time
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  equality predicates: functional_parquet.iceberg_v2_partitioned_position_deletes.file__position = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.pos, functional_parquet.iceberg_v2_partitioned_position_deletes.input__file__name = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.file_path
|  mem-estimate=2.12KB mem-reservation=2.12KB thread-reservation=0
|  tuple-ids=0 row-size=64B cardinality=10
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete]
|     HDFS partitions=1/1 files=3 size=9.47KB
|     Iceberg snapshot id: 8885697082976537578
|     stored statistics:
|       table: rows=10 size=9.47KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=204B cardinality=10
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes]
   HDFS partitions=1/1 files=3 size=3.48KB
   Iceberg snapshot id: 8885697082976537578
   stored statistics:
     table: rows=20 size=12.95KB
     columns missing stats: id, user, action, event_time
   extrapolated-rows=disabled max-scan-range-rows=6
   mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
   tuple-ids=0 row-size=64B cardinality=20
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
F02:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_partitioned_position_deletes.id, functional_parquet.iceberg_v2_partitioned_position_deletes.user, functional_parquet.iceberg_v2_partitioned_position_deletes.action, functional_parquet.iceberg_v2_partitioned_position_deletes.event_time
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=64B cardinality=10
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
Per-Host Resources: mem-estimate=96.27MB mem-reservation=48.71KB thread-reservation=2
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  equality predicates: functional_parquet.iceberg_v2_partitioned_position_deletes.file__position = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.pos, functional_parquet.iceberg_v2_partitioned_position_deletes.input__file__name = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.file_path
|  mem-estimate=722B mem-reservation=722B thread-reservation=0
|  tuple-ids=0 row-size=64B cardinality=10
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--03:EXCHANGE [DIRECTED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=204B cardinality=10
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  Per-Host Resources: mem-estimate=34.44MB mem-reservation=16.00KB thread-reservation=2
|  01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete, RANDOM]
|     HDFS partitions=1/1 files=3 size=9.47KB
|     Iceberg snapshot id: 8885697082976537578
|     stored statistics:
|       table: rows=10 size=9.47KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=204B cardinality=10
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes, RANDOM]
   HDFS partitions=1/1 files=3 size=3.48KB
   Iceberg snapshot id: 8885697082976537578
   stored statistics:
     table: rows=20 size=12.95KB
     columns missing stats: id, user, action, event_time
   extrapolated-rows=disabled max-scan-range-rows=6
   mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
   tuple-ids=0 row-size=64B cardinality=20
   in pipelines: 00(GETNEXT)
====
SELECT * from iceberg_v2_positional_not_all_data_files_have_delete_files
WHERE i > 2
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=100.00MB mem-reservation=4.05MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=2
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=1.53KB mem-reservation=1.53KB thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=1
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=267B cardinality=4
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     predicates: i > CAST(2 AS INT)
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     parquet statistics predicates: i > CAST(2 AS INT)
|     parquet dictionary predicates: i > CAST(2 AS INT)
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=1
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   predicates: i > CAST(2 AS INT)
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=5
   parquet statistics predicates: i > CAST(2 AS INT)
   parquet dictionary predicates: i > CAST(2 AS INT)
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=1
   in pipelines: 03(GETNEXT)
---- DISTRIBUTEDPLAN
F04:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
06:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=2
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
F03:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=64.17MB mem-reservation=32.76KB thread-reservation=2
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=2
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=783B mem-reservation=783B thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=1
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--05:EXCHANGE [DIRECTED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=1 row-size=267B cardinality=4
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  Per-Host Resources: mem-estimate=34.12MB mem-reservation=16.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete, RANDOM]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=267B cardinality=4
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     predicates: i > CAST(2 AS INT)
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     parquet statistics predicates: i > CAST(2 AS INT)
|     parquet dictionary predicates: i > CAST(2 AS INT)
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=1
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
   HDFS partitions=1/1 files=2 size=1.22KB
   predicates: i > CAST(2 AS INT)
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=5
   parquet statistics predicates: i > CAST(2 AS INT)
   parquet dictionary predicates: i > CAST(2 AS INT)
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=1
   in pipelines: 03(GETNEXT)
====
select * from iceberg_v2_positional_not_all_data_files_have_delete_files for system_version as of 1497619269847778439
minus
select * from iceberg_v2_positional_not_all_data_files_have_delete_files for system_version as of 4363979609026842966;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=257.94MB mem-reservation=39.94MB thread-reservation=4
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
07:HASH JOIN [LEFT ANTI JOIN]
|  hash predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=1 row-size=16B cardinality=6
|  in pipelines: 05(GETNEXT), 06(OPEN)
|
|--06:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=1 size=625B
|     Iceberg snapshot id: 4363979609026842966
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns: unavailable
|     extrapolated-rows=disabled max-scan-range-rows=10
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=3 row-size=16B cardinality=3
|     in pipelines: 06(GETNEXT)
|
05:AGGREGATE [FINALIZE]
|  group by: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=16B cardinality=6
|  in pipelines: 05(GETNEXT), 03(OPEN), 00(OPEN)
|
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=1.53KB mem-reservation=1.53KB thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=2
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=5 row-size=267B cardinality=4
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=6
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=5
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=4
   in pipelines: 03(GETNEXT)
---- DISTRIBUTEDPLAN
F06:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
12:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=1 row-size=16B cardinality=6
|  in pipelines: 10(GETNEXT)
|
F04:PLAN FRAGMENT [HASH(functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i,functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s)] hosts=2 instances=2
Per-Host Resources: mem-estimate=130.02MB mem-reservation=35.94MB thread-reservation=1
07:HASH JOIN [LEFT ANTI JOIN, PARTITIONED]
|  hash predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=1 row-size=16B cardinality=6
|  in pipelines: 10(GETNEXT), 06(OPEN)
|
|--11:EXCHANGE [HASH(functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i,functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s)]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=3 row-size=16B cardinality=3
|  |  in pipelines: 06(GETNEXT)
|  |
|  F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=32.16MB mem-reservation=16.00KB thread-reservation=2
|  06:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
|     HDFS partitions=1/1 files=1 size=625B
|     Iceberg snapshot id: 4363979609026842966
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns: unavailable
|     extrapolated-rows=disabled max-scan-range-rows=10
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=3 row-size=16B cardinality=3
|     in pipelines: 06(GETNEXT)
|
10:AGGREGATE [FINALIZE]
|  group by: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=16B cardinality=6
|  in pipelines: 10(GETNEXT), 03(OPEN), 00(OPEN)
|
09:EXCHANGE [HASH(functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i,functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s)]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=1 row-size=16B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
F03:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=192.17MB mem-reservation=34.03MB thread-reservation=2
05:AGGREGATE [STREAMING]
|  group by: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=16B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=783B mem-reservation=783B thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=2
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--08:EXCHANGE [DIRECTED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=5 row-size=267B cardinality=4
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  Per-Host Resources: mem-estimate=34.12MB mem-reservation=16.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete, RANDOM]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=5 row-size=267B cardinality=4
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=6
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=5
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=4
   in pipelines: 03(GETNEXT)
====
with v as (select i + 1000 as ii, upper(s) as ss from iceberg_v2_positional_not_all_data_files_have_delete_files)
select * from v where ii > 1003;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=100.00MB mem-reservation=4.05MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: CAST(i AS BIGINT) + CAST(1000 AS BIGINT), upper(s)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=2
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=1.53KB mem-reservation=1.53KB thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=1
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=267B cardinality=4
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     predicates: CAST(i AS BIGINT) + CAST(1000 AS BIGINT) > CAST(1003 AS BIGINT)
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     parquet dictionary predicates: CAST(i AS BIGINT) + CAST(1000 AS BIGINT) > CAST(1003 AS BIGINT)
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=1
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   predicates: CAST(i AS BIGINT) + CAST(1000 AS BIGINT) > CAST(1003 AS BIGINT)
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=5
   parquet dictionary predicates: CAST(i AS BIGINT) + CAST(1000 AS BIGINT) > CAST(1003 AS BIGINT)
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=1
   in pipelines: 03(GETNEXT)
---- DISTRIBUTEDPLAN
F04:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: CAST(i AS BIGINT) + CAST(1000 AS BIGINT), upper(s)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
06:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=2
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
F03:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=64.17MB mem-reservation=32.76KB thread-reservation=2
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=2
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=783B mem-reservation=783B thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=1
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--05:EXCHANGE [DIRECTED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=2 row-size=267B cardinality=4
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  Per-Host Resources: mem-estimate=34.12MB mem-reservation=16.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete, RANDOM]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=267B cardinality=4
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     predicates: CAST(i AS BIGINT) + CAST(1000 AS BIGINT) > CAST(1003 AS BIGINT)
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     parquet dictionary predicates: CAST(i AS BIGINT) + CAST(1000 AS BIGINT) > CAST(1003 AS BIGINT)
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=1
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
   HDFS partitions=1/1 files=2 size=1.22KB
   predicates: CAST(i AS BIGINT) + CAST(1000 AS BIGINT) > CAST(1003 AS BIGINT)
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=5
   parquet dictionary predicates: CAST(i AS BIGINT) + CAST(1000 AS BIGINT) > CAST(1003 AS BIGINT)
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=1
   in pipelines: 03(GETNEXT)
====
select *
from iceberg_v2_positional_not_all_data_files_have_delete_files
where i = (select max(i) from iceberg_v2_positional_update_all_rows);
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=177.02MB mem-reservation=6.99MB thread-reservation=5 runtime-filters-memory=1.00MB
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
11:HASH JOIN [LEFT SEMI JOIN]
|  hash predicates: i = max(i)
|  runtime filters: RF000[bloom] <- max(i)
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT), 10(OPEN)
|
|--10:AGGREGATE [FINALIZE]
|  |  output: max(i)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=2 row-size=4B cardinality=1
|  |  in pipelines: 10(GETNEXT), 08(OPEN), 05(OPEN)
|  |
|  09:UNION
|  |  pass-through-operands: all
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=24B cardinality=4
|  |  in pipelines: 08(GETNEXT), 05(GETNEXT)
|  |
|  |--07:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  |  equality predicates: functional_parquet.iceberg_v2_positional_update_all_rows.file__position = functional_parquet.iceberg_v2_positional_update_all_rows-position-delete.pos, functional_parquet.iceberg_v2_positional_update_all_rows.input__file__name = functional_parquet.iceberg_v2_positional_update_all_rows-position-delete.file_path
|  |  |  mem-estimate=764B mem-reservation=764B thread-reservation=0
|  |  |  tuple-ids=1 row-size=24B cardinality=1
|  |  |  in pipelines: 05(GETNEXT), 06(OPEN)
|  |  |
|  |  |--06:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows-POSITION-DELETE-06 functional_parquet.iceberg_v2_positional_update_all_rows-position-delete]
|  |  |     HDFS partitions=1/1 files=1 size=2.60KB
|  |  |     Iceberg snapshot id: 3877007445826010687
|  |  |     stored statistics:
|  |  |       table: rows=3 size=2.60KB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3
|  |  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |  |     tuple-ids=8 row-size=246B cardinality=3
|  |  |     in pipelines: 06(GETNEXT)
|  |  |
|  |  05:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows]
|  |     HDFS partitions=1/1 files=1 size=625B
|  |     Iceberg snapshot id: 3877007445826010687
|  |     stored statistics:
|  |       table: rows=6 size=3.82KB
|  |       columns missing stats: i
|  |     extrapolated-rows=disabled max-scan-range-rows=6
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=24B cardinality=3
|  |     in pipelines: 05(GETNEXT)
|  |
|  08:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows]
|     HDFS partitions=1/1 files=1 size=625B
|     Iceberg snapshot id: 3877007445826010687
|     stored statistics:
|       table: rows=6 size=3.82KB
|       columns missing stats: i
|     extrapolated-rows=disabled max-scan-range-rows=6
|     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|     tuple-ids=1 row-size=24B cardinality=3
|     in pipelines: 08(GETNEXT)
|
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=1.53KB mem-reservation=1.53KB thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=2
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=4 row-size=267B cardinality=4
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     runtime filters: RF000[bloom] -> i
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=6
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   runtime filters: RF000[bloom] -> i
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=5
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=4
   in pipelines: 03(GETNEXT)
---- DISTRIBUTEDPLAN
F09:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
17:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
F03:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=67.11MB mem-reservation=2.97MB thread-reservation=2 runtime-filters-memory=1.00MB
11:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  hash predicates: i = max(i)
|  runtime filters: RF000[bloom] <- max(i)
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT), 15(OPEN)
|
|--16:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=4B cardinality=1
|  |  in pipelines: 15(GETNEXT)
|  |
|  F08:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=48.00KB mem-reservation=0B thread-reservation=1
|  15:AGGREGATE [FINALIZE]
|  |  output: max:merge(i)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=2 row-size=4B cardinality=1
|  |  in pipelines: 15(GETNEXT), 10(OPEN)
|  |
|  14:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=4B cardinality=1
|  |  in pipelines: 10(GETNEXT)
|  |
|  F07:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=48.03MB mem-reservation=24.75KB thread-reservation=2
|  10:AGGREGATE
|  |  output: max(i)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=2 row-size=4B cardinality=1
|  |  in pipelines: 10(GETNEXT), 08(OPEN), 05(OPEN)
|  |
|  09:UNION
|  |  pass-through-operands: all
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=24B cardinality=4
|  |  in pipelines: 08(GETNEXT), 05(GETNEXT)
|  |
|  |--07:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  |  equality predicates: functional_parquet.iceberg_v2_positional_update_all_rows.file__position = functional_parquet.iceberg_v2_positional_update_all_rows-position-delete.pos, functional_parquet.iceberg_v2_positional_update_all_rows.input__file__name = functional_parquet.iceberg_v2_positional_update_all_rows-position-delete.file_path
|  |  |  mem-estimate=764B mem-reservation=764B thread-reservation=0
|  |  |  tuple-ids=1 row-size=24B cardinality=1
|  |  |  in pipelines: 05(GETNEXT), 06(OPEN)
|  |  |
|  |  |--13:EXCHANGE [DIRECTED]
|  |  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=8 row-size=246B cardinality=3
|  |  |  |  in pipelines: 06(GETNEXT)
|  |  |  |
|  |  |  F06:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Host Resources: mem-estimate=32.98MB mem-reservation=16.00KB thread-reservation=2
|  |  |  06:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows-POSITION-DELETE-06 functional_parquet.iceberg_v2_positional_update_all_rows-position-delete, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.60KB
|  |  |     Iceberg snapshot id: 3877007445826010687
|  |  |     stored statistics:
|  |  |       table: rows=3 size=2.60KB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3
|  |  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |  |     tuple-ids=8 row-size=246B cardinality=3
|  |  |     in pipelines: 06(GETNEXT)
|  |  |
|  |  05:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=625B
|  |     Iceberg snapshot id: 3877007445826010687
|  |     stored statistics:
|  |       table: rows=6 size=3.82KB
|  |       columns missing stats: i
|  |     extrapolated-rows=disabled max-scan-range-rows=6
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=24B cardinality=3
|  |     in pipelines: 05(GETNEXT)
|  |
|  08:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows, RANDOM]
|     HDFS partitions=1/1 files=1 size=625B
|     Iceberg snapshot id: 3877007445826010687
|     stored statistics:
|       table: rows=6 size=3.82KB
|       columns missing stats: i
|     extrapolated-rows=disabled max-scan-range-rows=6
|     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|     tuple-ids=1 row-size=24B cardinality=3
|     in pipelines: 08(GETNEXT)
|
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=36B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=783B mem-reservation=783B thread-reservation=0
|  |  tuple-ids=0 row-size=36B cardinality=2
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--12:EXCHANGE [DIRECTED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=4 row-size=267B cardinality=4
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  Per-Host Resources: mem-estimate=34.12MB mem-reservation=16.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete, RANDOM]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=4 row-size=267B cardinality=4
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     runtime filters: RF000[bloom] -> i
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=36B cardinality=6
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
   HDFS partitions=1/1 files=2 size=1.22KB
   runtime filters: RF000[bloom] -> i
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=5
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=36B cardinality=4
   in pipelines: 03(GETNEXT)
====
select * from iceberg_v2_partitioned_position_deletes where action = 'download' and id > 0;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=128.00MB mem-reservation=4.05MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_partitioned_position_deletes.id, functional_parquet.iceberg_v2_partitioned_position_deletes.user, functional_parquet.iceberg_v2_partitioned_position_deletes.action, functional_parquet.iceberg_v2_partitioned_position_deletes.event_time
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  equality predicates: functional_parquet.iceberg_v2_partitioned_position_deletes.file__position = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.pos, functional_parquet.iceberg_v2_partitioned_position_deletes.input__file__name = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.file_path
|  mem-estimate=723B mem-reservation=723B thread-reservation=0
|  tuple-ids=0 row-size=64B cardinality=1
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete]
|     HDFS partitions=1/1 files=1 size=3.18KB
|     Iceberg snapshot id: 8885697082976537578
|     stored statistics:
|       table: rows=2 size=3.18KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=2
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=207B cardinality=2
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes]
   HDFS partitions=1/1 files=1 size=1.17KB
   predicates: id > CAST(0 AS INT)
   Iceberg snapshot id: 8885697082976537578
   skipped Iceberg predicates: action = 'download'
   stored statistics:
     table: rows=20 size=12.95KB
     columns missing stats: id, user, action, event_time
   extrapolated-rows=disabled max-scan-range-rows=20
   parquet statistics predicates: id > CAST(0 AS INT)
   parquet dictionary predicates: id > CAST(0 AS INT)
   mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
   tuple-ids=0 row-size=64B cardinality=1
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
F02:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_partitioned_position_deletes.id, functional_parquet.iceberg_v2_partitioned_position_deletes.user, functional_parquet.iceberg_v2_partitioned_position_deletes.action, functional_parquet.iceberg_v2_partitioned_position_deletes.event_time
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=64B cardinality=1
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=96.27MB mem-reservation=48.71KB thread-reservation=2
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  equality predicates: functional_parquet.iceberg_v2_partitioned_position_deletes.file__position = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.pos, functional_parquet.iceberg_v2_partitioned_position_deletes.input__file__name = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.file_path
|  mem-estimate=723B mem-reservation=723B thread-reservation=0
|  tuple-ids=0 row-size=64B cardinality=1
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--03:EXCHANGE [DIRECTED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=207B cardinality=2
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=32.82MB mem-reservation=16.00KB thread-reservation=2
|  01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete, RANDOM]
|     HDFS partitions=1/1 files=1 size=3.18KB
|     Iceberg snapshot id: 8885697082976537578
|     stored statistics:
|       table: rows=2 size=3.18KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=2
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=207B cardinality=2
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes, RANDOM]
   HDFS partitions=1/1 files=1 size=1.17KB
   predicates: id > CAST(0 AS INT)
   Iceberg snapshot id: 8885697082976537578
   skipped Iceberg predicates: action = 'download'
   stored statistics:
     table: rows=20 size=12.95KB
     columns missing stats: id, user, action, event_time
   extrapolated-rows=disabled max-scan-range-rows=20
   parquet statistics predicates: id > CAST(0 AS INT)
   parquet dictionary predicates: id > CAST(0 AS INT)
   mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
   tuple-ids=0 row-size=64B cardinality=1
   in pipelines: 00(GETNEXT)
====
select * from iceberg_v2_partitioned_position_deletes
where action = 'download' and user = 'Lisa';
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=128.00MB mem-reservation=4.05MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_partitioned_position_deletes.id, functional_parquet.iceberg_v2_partitioned_position_deletes.user, functional_parquet.iceberg_v2_partitioned_position_deletes.action, functional_parquet.iceberg_v2_partitioned_position_deletes.event_time
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  equality predicates: functional_parquet.iceberg_v2_partitioned_position_deletes.file__position = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.pos, functional_parquet.iceberg_v2_partitioned_position_deletes.input__file__name = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.file_path
|  mem-estimate=723B mem-reservation=723B thread-reservation=0
|  tuple-ids=0 row-size=64B cardinality=1
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete]
|     HDFS partitions=1/1 files=1 size=3.18KB
|     Iceberg snapshot id: 8885697082976537578
|     stored statistics:
|       table: rows=2 size=3.18KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=2
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=207B cardinality=2
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes]
   HDFS partitions=1/1 files=1 size=1.17KB
   predicates: `user` = 'Lisa'
   Iceberg snapshot id: 8885697082976537578
   skipped Iceberg predicates: action = 'download'
   stored statistics:
     table: rows=20 size=12.95KB
     columns missing stats: id, user, action, event_time
   extrapolated-rows=disabled max-scan-range-rows=20
   parquet statistics predicates: `user` = 'Lisa'
   parquet dictionary predicates: `user` = 'Lisa'
   mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
   tuple-ids=0 row-size=64B cardinality=1
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
F02:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_partitioned_position_deletes.id, functional_parquet.iceberg_v2_partitioned_position_deletes.user, functional_parquet.iceberg_v2_partitioned_position_deletes.action, functional_parquet.iceberg_v2_partitioned_position_deletes.event_time
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=64B cardinality=1
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=96.27MB mem-reservation=48.71KB thread-reservation=2
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  equality predicates: functional_parquet.iceberg_v2_partitioned_position_deletes.file__position = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.pos, functional_parquet.iceberg_v2_partitioned_position_deletes.input__file__name = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.file_path
|  mem-estimate=723B mem-reservation=723B thread-reservation=0
|  tuple-ids=0 row-size=64B cardinality=1
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--03:EXCHANGE [DIRECTED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=207B cardinality=2
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=32.82MB mem-reservation=16.00KB thread-reservation=2
|  01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete, RANDOM]
|     HDFS partitions=1/1 files=1 size=3.18KB
|     Iceberg snapshot id: 8885697082976537578
|     stored statistics:
|       table: rows=2 size=3.18KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=2
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=207B cardinality=2
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes, RANDOM]
   HDFS partitions=1/1 files=1 size=1.17KB
   predicates: `user` = 'Lisa'
   Iceberg snapshot id: 8885697082976537578
   skipped Iceberg predicates: action = 'download'
   stored statistics:
     table: rows=20 size=12.95KB
     columns missing stats: id, user, action, event_time
   extrapolated-rows=disabled max-scan-range-rows=20
   parquet statistics predicates: `user` = 'Lisa'
   parquet dictionary predicates: `user` = 'Lisa'
   mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
   tuple-ids=0 row-size=64B cardinality=1
   in pipelines: 00(GETNEXT)
====
# Similar as above but on a table with positional deletes on all data files.
select * from iceberg_v2_partitioned_position_deletes where action = 'download';
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=128.00MB mem-reservation=4.05MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_partitioned_position_deletes.id, functional_parquet.iceberg_v2_partitioned_position_deletes.user, functional_parquet.iceberg_v2_partitioned_position_deletes.action, functional_parquet.iceberg_v2_partitioned_position_deletes.event_time
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  equality predicates: functional_parquet.iceberg_v2_partitioned_position_deletes.file__position = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.pos, functional_parquet.iceberg_v2_partitioned_position_deletes.input__file__name = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.file_path
|  mem-estimate=723B mem-reservation=723B thread-reservation=0
|  tuple-ids=0 row-size=64B cardinality=4
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete]
|     HDFS partitions=1/1 files=1 size=3.18KB
|     Iceberg snapshot id: 8885697082976537578
|     stored statistics:
|       table: rows=2 size=3.18KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=2
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=207B cardinality=2
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes]
   HDFS partitions=1/1 files=1 size=1.17KB
   Iceberg snapshot id: 8885697082976537578
   skipped Iceberg predicates: action = 'download'
   stored statistics:
     table: rows=20 size=12.95KB
     columns missing stats: id, user, action, event_time
   extrapolated-rows=disabled max-scan-range-rows=20
   mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
   tuple-ids=0 row-size=64B cardinality=6
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
F02:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_partitioned_position_deletes.id, functional_parquet.iceberg_v2_partitioned_position_deletes.user, functional_parquet.iceberg_v2_partitioned_position_deletes.action, functional_parquet.iceberg_v2_partitioned_position_deletes.event_time
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=64B cardinality=4
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=96.27MB mem-reservation=48.71KB thread-reservation=2
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  equality predicates: functional_parquet.iceberg_v2_partitioned_position_deletes.file__position = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.pos, functional_parquet.iceberg_v2_partitioned_position_deletes.input__file__name = functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete.file_path
|  mem-estimate=723B mem-reservation=723B thread-reservation=0
|  tuple-ids=0 row-size=64B cardinality=4
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--03:EXCHANGE [DIRECTED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=207B cardinality=2
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=32.82MB mem-reservation=16.00KB thread-reservation=2
|  01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete, RANDOM]
|     HDFS partitions=1/1 files=1 size=3.18KB
|     Iceberg snapshot id: 8885697082976537578
|     stored statistics:
|       table: rows=2 size=3.18KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=2
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=1 row-size=207B cardinality=2
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes, RANDOM]
   HDFS partitions=1/1 files=1 size=1.17KB
   Iceberg snapshot id: 8885697082976537578
   skipped Iceberg predicates: action = 'download'
   stored statistics:
     table: rows=20 size=12.95KB
     columns missing stats: id, user, action, event_time
   extrapolated-rows=disabled max-scan-range-rows=20
   mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
   tuple-ids=0 row-size=64B cardinality=6
   in pipelines: 00(GETNEXT)
====
with u1 as (select count(*) from iceberg_v2_positional_not_all_data_files_have_delete_files),
u2 as (select -1 as c),
u3 as (select count(*) from iceberg_v2_positional_not_all_data_files_have_delete_files) select * from u1, u2, u3;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=128.00MB mem-reservation=4.00MB thread-reservation=5
PLAN-ROOT SINK
|  output exprs: count(*) + CAST(4 AS BIGINT), u2.c, count(*) + CAST(4 AS BIGINT)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
10:NESTED LOOP JOIN [CROSS JOIN]
|  mem-estimate=8B mem-reservation=0B thread-reservation=0
|  tuple-ids=1,3,5 row-size=17B cardinality=1
|  in pipelines: 03(GETNEXT), 08(OPEN)
|
|--08:AGGREGATE [FINALIZE]
|  |  output: count(*)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=5 row-size=8B cardinality=1
|  |  in pipelines: 08(GETNEXT), 05(OPEN)
|  |
|  07:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=1.53KB mem-reservation=1.53KB thread-reservation=0
|  |  tuple-ids=4 row-size=20B cardinality=2
|  |  in pipelines: 05(GETNEXT), 06(OPEN)
|  |
|  |--06:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-06 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=10 row-size=267B cardinality=4
|  |     in pipelines: 06(GETNEXT)
|  |
|  05:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=5
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=4 row-size=20B cardinality=6
|     in pipelines: 05(GETNEXT)
|
09:NESTED LOOP JOIN [CROSS JOIN]
|  mem-estimate=1B mem-reservation=0B thread-reservation=0
|  tuple-ids=1,3 row-size=9B cardinality=1
|  in pipelines: 03(GETNEXT)
|
|--04:UNION
|     constant-operands=1
|     mem-estimate=0B mem-reservation=0B thread-reservation=0
|     tuple-ids=3 row-size=1B cardinality=1
|     in pipelines: <none>
|
03:AGGREGATE [FINALIZE]
|  output: count(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT), 00(OPEN)
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  mem-estimate=1.53KB mem-reservation=1.53KB thread-reservation=0
|  tuple-ids=0 row-size=20B cardinality=2
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|     HDFS partitions=1/1 files=2 size=5.33KB
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=4 size=5.33KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=2
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=7 row-size=267B cardinality=4
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=5
   mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
   tuple-ids=0 row-size=20B cardinality=6
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
F02:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.05MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: count(*) + CAST(4 AS BIGINT), u2.c, count(*) + CAST(4 AS BIGINT)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
10:NESTED LOOP JOIN [CROSS JOIN, BROADCAST]
|  mem-estimate=8B mem-reservation=0B thread-reservation=0
|  tuple-ids=1,3,5 row-size=17B cardinality=1
|  in pipelines: 13(GETNEXT), 17(OPEN)
|
|--18:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=5 row-size=8B cardinality=1
|  |  in pipelines: 17(GETNEXT)
|  |
|  F06:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=64.00KB mem-reservation=0B thread-reservation=1
|  17:AGGREGATE [FINALIZE]
|  |  output: count:merge(*)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=5 row-size=8B cardinality=1
|  |  in pipelines: 17(GETNEXT), 08(OPEN)
|  |
|  16:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=5 row-size=8B cardinality=1
|  |  in pipelines: 08(GETNEXT)
|  |
|  F04:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  Per-Host Resources: mem-estimate=32.02MB mem-reservation=16.76KB thread-reservation=2
|  08:AGGREGATE
|  |  output: count(*)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=5 row-size=8B cardinality=1
|  |  in pipelines: 08(GETNEXT), 05(OPEN)
|  |
|  07:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  |  mem-estimate=783B mem-reservation=783B thread-reservation=0
|  |  tuple-ids=4 row-size=20B cardinality=2
|  |  in pipelines: 05(GETNEXT), 06(OPEN)
|  |
|  |--15:EXCHANGE [DIRECTED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=10 row-size=267B cardinality=4
|  |  |  in pipelines: 06(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  Per-Host Resources: mem-estimate=34.12MB mem-reservation=16.00KB thread-reservation=2
|  |  06:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-06 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete, RANDOM]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     stored statistics:
|  |       table: rows=4 size=5.33KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=10 row-size=267B cardinality=4
|  |     in pipelines: 06(GETNEXT)
|  |
|  05:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=10 size=7.77KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=5
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=4 row-size=20B cardinality=6
|     in pipelines: 05(GETNEXT)
|
09:NESTED LOOP JOIN [CROSS JOIN, BROADCAST]
|  mem-estimate=1B mem-reservation=0B thread-reservation=0
|  tuple-ids=1,3 row-size=9B cardinality=1
|  in pipelines: 13(GETNEXT)
|
|--14:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=3 row-size=1B cardinality=1
|  |  in pipelines: <none>
|  |
|  F03:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=20.00KB mem-reservation=0B thread-reservation=1
|  04:UNION
|     constant-operands=1
|     mem-estimate=0B mem-reservation=0B thread-reservation=0
|     tuple-ids=3 row-size=1B cardinality=1
|     in pipelines: <none>
|
13:AGGREGATE [FINALIZE]
|  output: count:merge(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 13(GETNEXT), 03(OPEN)
|
12:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=32.02MB mem-reservation=16.76KB thread-reservation=2
03:AGGREGATE
|  output: count(*)
|  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=1 row-size=8B cardinality=1
|  in pipelines: 03(GETNEXT), 00(OPEN)
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  equality predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.file__position = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.pos, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.input__file__name = functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete.file_path
|  mem-estimate=783B mem-reservation=783B thread-reservation=0
|  tuple-ids=0 row-size=20B cardinality=2
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--11:EXCHANGE [DIRECTED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=7 row-size=267B cardinality=4
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  Per-Host Resources: mem-estimate=34.12MB mem-reservation=16.00KB thread-reservation=2
|  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete, RANDOM]
|     HDFS partitions=1/1 files=2 size=5.33KB
|     Iceberg snapshot id: 1497619269847778439
|     stored statistics:
|       table: rows=4 size=5.33KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=2
|     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|     tuple-ids=7 row-size=267B cardinality=4
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files, RANDOM]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   stored statistics:
     table: rows=10 size=7.77KB
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=5
   mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
   tuple-ids=0 row-size=20B cardinality=6
   in pipelines: 00(GETNEXT)
====
select * from functional_parquet.iceberg_v2_delete_equality;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=85.94MB mem-reservation=5.98MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_equality.id, functional_parquet.iceberg_v2_delete_equality.data
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=28B cardinality=3
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality.id IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality-equality-delete-01.id
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality-equality-delete-01.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=28B cardinality=1
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality-equality-delete-01]
|  |     HDFS partitions=1/1 files=1 size=457B
|  |     Iceberg snapshot id: 5763349507283783091
|  |     stored statistics:
|  |       table: rows=1 size=457B
|  |       columns missing stats: id
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=16B cardinality=1
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality]
|     HDFS partitions=1/1 files=1 size=709B
|     Iceberg snapshot id: 5763349507283783091
|     stored statistics:
|       table: rows=3 size=2.54KB
|       columns missing stats: id, data
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|     tuple-ids=0 row-size=28B cardinality=1
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality]
   HDFS partitions=1/1 files=2 size=1.41KB
   Iceberg snapshot id: 5763349507283783091
   stored statistics:
     table: rows=3 size=2.54KB
     columns missing stats: id, data
   extrapolated-rows=disabled max-scan-range-rows=1
   mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
   tuple-ids=0 row-size=28B cardinality=2
   in pipelines: 03(GETNEXT)
---- DISTRIBUTEDPLAN
F04:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_equality.id, functional_parquet.iceberg_v2_delete_equality.data
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
06:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=28B cardinality=3
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
F03:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=50.08MB mem-reservation=1.96MB thread-reservation=2
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=28B cardinality=3
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality.id IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality-equality-delete-01.id
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality-equality-delete-01.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=28B cardinality=1
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--05:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=2 row-size=16B cardinality=1
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=32.08MB mem-reservation=16.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality-equality-delete-01, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=457B
|  |     Iceberg snapshot id: 5763349507283783091
|  |     stored statistics:
|  |       table: rows=1 size=457B
|  |       columns missing stats: id
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=16B cardinality=1
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality, RANDOM]
|     HDFS partitions=1/1 files=1 size=709B
|     Iceberg snapshot id: 5763349507283783091
|     stored statistics:
|       table: rows=3 size=2.54KB
|       columns missing stats: id, data
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|     tuple-ids=0 row-size=28B cardinality=1
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality, RANDOM]
   HDFS partitions=1/1 files=2 size=1.41KB
   Iceberg snapshot id: 5763349507283783091
   stored statistics:
     table: rows=3 size=2.54KB
     columns missing stats: id, data
   extrapolated-rows=disabled max-scan-range-rows=1
   mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
   tuple-ids=0 row-size=28B cardinality=2
   in pipelines: 03(GETNEXT)
====
select * from functional_parquet.iceberg_v2_delete_equality for system_version as of 5763349507283783091;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=85.94MB mem-reservation=5.98MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_equality.id, functional_parquet.iceberg_v2_delete_equality.data
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=28B cardinality=3
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality.id IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality-equality-delete-01.id
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality-equality-delete-01.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=28B cardinality=1
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality-equality-delete-01]
|  |     HDFS partitions=1/1 files=1 size=457B
|  |     Iceberg snapshot id: 5763349507283783091
|  |     stored statistics:
|  |       table: rows=1 size=457B
|  |       columns missing stats: id
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=16B cardinality=1
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality]
|     HDFS partitions=1/1 files=1 size=709B
|     Iceberg snapshot id: 5763349507283783091
|     stored statistics:
|       table: rows=3 size=2.54KB
|       columns missing stats: id, data
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|     tuple-ids=0 row-size=28B cardinality=1
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality]
   HDFS partitions=1/1 files=2 size=1.41KB
   Iceberg snapshot id: 5763349507283783091
   stored statistics:
     table: rows=3 size=2.54KB
     columns missing stats: id, data
   extrapolated-rows=disabled max-scan-range-rows=1
   mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
   tuple-ids=0 row-size=28B cardinality=2
   in pipelines: 03(GETNEXT)
---- DISTRIBUTEDPLAN
F04:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_equality.id, functional_parquet.iceberg_v2_delete_equality.data
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
06:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=28B cardinality=3
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
F03:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=50.08MB mem-reservation=1.96MB thread-reservation=2
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=28B cardinality=3
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality.id IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality-equality-delete-01.id
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality-equality-delete-01.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=28B cardinality=1
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--05:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=2 row-size=16B cardinality=1
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=32.08MB mem-reservation=16.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality-equality-delete-01, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=457B
|  |     Iceberg snapshot id: 5763349507283783091
|  |     stored statistics:
|  |       table: rows=1 size=457B
|  |       columns missing stats: id
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=16B cardinality=1
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality, RANDOM]
|     HDFS partitions=1/1 files=1 size=709B
|     Iceberg snapshot id: 5763349507283783091
|     stored statistics:
|       table: rows=3 size=2.54KB
|       columns missing stats: id, data
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|     tuple-ids=0 row-size=28B cardinality=1
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality, RANDOM]
   HDFS partitions=1/1 files=2 size=1.41KB
   Iceberg snapshot id: 5763349507283783091
   stored statistics:
     table: rows=3 size=2.54KB
     columns missing stats: id, data
   extrapolated-rows=disabled max-scan-range-rows=1
   mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
   tuple-ids=0 row-size=28B cardinality=2
   in pipelines: 03(GETNEXT)
====
# Table has both equality and positional delete files. Equality fields are (i int, d date).
select * from functional_parquet.iceberg_v2_delete_both_eq_and_pos;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=181.94MB mem-reservation=6.02MB thread-reservation=4
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_both_eq_and_pos.i, functional_parquet.iceberg_v2_delete_both_eq_and_pos.s, functional_parquet.iceberg_v2_delete_both_eq_and_pos.d
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
06:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=48B cardinality=3
|  in pipelines: 05(GETNEXT), 00(GETNEXT)
|
|--04:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_both_eq_and_pos.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03.d, functional_parquet.iceberg_v2_delete_both_eq_and_pos.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03.i
|  |  other join predicates: functional_parquet.iceberg_v2_delete_both_eq_and_pos.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=48B cardinality=1
|  |  in pipelines: 00(GETNEXT), 03(OPEN)
|  |
|  |--03:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03]
|  |     HDFS partitions=1/1 files=1 size=657B
|  |     Iceberg snapshot id: 911559291487642581
|  |     stored statistics:
|  |       table: rows=2 size=657B
|  |       columns missing stats: i, d
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=4 row-size=16B cardinality=2
|  |     in pipelines: 03(GETNEXT)
|  |
|  02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  equality predicates: functional_parquet.iceberg_v2_delete_both_eq_and_pos.file__position = functional_parquet.iceberg_v2_delete_both_eq_and_pos-position-delete.pos, functional_parquet.iceberg_v2_delete_both_eq_and_pos.input__file__name = functional_parquet.iceberg_v2_delete_both_eq_and_pos-position-delete.file_path
|  |  mem-estimate=701B mem-reservation=701B thread-reservation=0
|  |  tuple-ids=0 row-size=48B cardinality=1
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_both_eq_and_pos-position-delete]
|  |     HDFS partitions=1/1 files=1 size=1.57KB
|  |     Iceberg snapshot id: 911559291487642581
|  |     stored statistics:
|  |       table: rows=1 size=1.57KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=187B cardinality=1
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos]
|     HDFS partitions=1/1 files=1 size=898B
|     Iceberg snapshot id: 911559291487642581
|     stored statistics:
|       table: rows=4 size=3.95KB
|       columns missing stats: i, s, d
|     extrapolated-rows=disabled max-scan-range-rows=4
|     mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
|     tuple-ids=0 row-size=48B cardinality=2
|     in pipelines: 00(GETNEXT)
|
05:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos]
   HDFS partitions=1/1 files=1 size=885B
   Iceberg snapshot id: 911559291487642581
   stored statistics:
     table: rows=4 size=3.95KB
     columns missing stats: i, s, d
   extrapolated-rows=disabled max-scan-range-rows=4
   mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
   tuple-ids=0 row-size=48B cardinality=2
   in pipelines: 05(GETNEXT)
---- DISTRIBUTEDPLAN
F05:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_both_eq_and_pos.i, functional_parquet.iceberg_v2_delete_both_eq_and_pos.s, functional_parquet.iceberg_v2_delete_both_eq_and_pos.d
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
09:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=48B cardinality=3
|  in pipelines: 05(GETNEXT), 00(GETNEXT)
|
F04:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
Per-Host Resources: mem-estimate=98.17MB mem-reservation=1.99MB thread-reservation=2
06:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=48B cardinality=3
|  in pipelines: 05(GETNEXT), 00(GETNEXT)
|
|--04:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_both_eq_and_pos.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03.d, functional_parquet.iceberg_v2_delete_both_eq_and_pos.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03.i
|  |  other join predicates: functional_parquet.iceberg_v2_delete_both_eq_and_pos.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=48B cardinality=1
|  |  in pipelines: 00(GETNEXT), 03(OPEN)
|  |
|  |--08:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=4 row-size=16B cardinality=2
|  |  |  in pipelines: 03(GETNEXT)
|  |  |
|  |  F03:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=48.08MB mem-reservation=24.00KB thread-reservation=2
|  |  03:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=657B
|  |     Iceberg snapshot id: 911559291487642581
|  |     stored statistics:
|  |       table: rows=2 size=657B
|  |       columns missing stats: i, d
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=4 row-size=16B cardinality=2
|  |     in pipelines: 03(GETNEXT)
|  |
|  02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  equality predicates: functional_parquet.iceberg_v2_delete_both_eq_and_pos.file__position = functional_parquet.iceberg_v2_delete_both_eq_and_pos-position-delete.pos, functional_parquet.iceberg_v2_delete_both_eq_and_pos.input__file__name = functional_parquet.iceberg_v2_delete_both_eq_and_pos-position-delete.file_path
|  |  mem-estimate=701B mem-reservation=701B thread-reservation=0
|  |  tuple-ids=0 row-size=48B cardinality=1
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--07:EXCHANGE [DIRECTED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=1 row-size=187B cardinality=1
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=32.75MB mem-reservation=16.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_both_eq_and_pos-position-delete, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.57KB
|  |     Iceberg snapshot id: 911559291487642581
|  |     stored statistics:
|  |       table: rows=1 size=1.57KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=187B cardinality=1
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos, RANDOM]
|     HDFS partitions=1/1 files=1 size=898B
|     Iceberg snapshot id: 911559291487642581
|     stored statistics:
|       table: rows=4 size=3.95KB
|       columns missing stats: i, s, d
|     extrapolated-rows=disabled max-scan-range-rows=4
|     mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
|     tuple-ids=0 row-size=48B cardinality=2
|     in pipelines: 00(GETNEXT)
|
05:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos, RANDOM]
   HDFS partitions=1/1 files=1 size=885B
   Iceberg snapshot id: 911559291487642581
   stored statistics:
     table: rows=4 size=3.95KB
     columns missing stats: i, s, d
   extrapolated-rows=disabled max-scan-range-rows=4
   mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
   tuple-ids=0 row-size=48B cardinality=2
   in pipelines: 05(GETNEXT)
====
# Partitioned table with equality deletes.
select * from functional_parquet.iceberg_v2_delete_equality_partitioned
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=117.94MB mem-reservation=5.99MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_equality_partitioned.i, functional_parquet.iceberg_v2_delete_equality_partitioned.s, functional_parquet.iceberg_v2_delete_equality_partitioned.d
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=28B cardinality=8
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_partitioned.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.d, functional_parquet.iceberg_v2_delete_equality_partitioned.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_partitioned.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=28B cardinality=5
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_partitioned-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01]
|  |     HDFS partitions=1/1 files=2 size=1.33KB
|  |     Iceberg snapshot id: 4821964189199835313
|  |     stored statistics:
|  |       table: rows=3 size=1.33KB
|  |       columns missing stats: s, d
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=24B cardinality=3
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_partitioned]
|     HDFS partitions=1/1 files=2 size=1.76KB
|     Iceberg snapshot id: 4821964189199835313
|     stored statistics:
|       table: rows=8 size=4.81KB
|       columns missing stats: i, s, d
|     extrapolated-rows=disabled max-scan-range-rows=4
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=28B cardinality=5
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_partitioned]
   HDFS partitions=1/1 files=2 size=1.71KB
   Iceberg snapshot id: 4821964189199835313
   stored statistics:
     table: rows=8 size=4.81KB
     columns missing stats: i, s, d
   extrapolated-rows=disabled max-scan-range-rows=4
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=28B cardinality=3
   in pipelines: 03(GETNEXT)
---- DISTRIBUTEDPLAN
F05:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_equality_partitioned.i, functional_parquet.iceberg_v2_delete_equality_partitioned.s, functional_parquet.iceberg_v2_delete_equality_partitioned.d
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
07:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=28B cardinality=8
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
F04:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=64.12MB mem-reservation=1.94MB thread-reservation=2
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=28B cardinality=8
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:HASH JOIN [LEFT ANTI JOIN, PARTITIONED]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_partitioned.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.d, functional_parquet.iceberg_v2_delete_equality_partitioned.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_partitioned.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=28B cardinality=5
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--06:EXCHANGE [HASH(functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.d,functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.s)]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=2 row-size=24B cardinality=3
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  |  Per-Host Resources: mem-estimate=48.22MB mem-reservation=24.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_partitioned-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01, RANDOM]
|  |     HDFS partitions=1/1 files=2 size=1.33KB
|  |     Iceberg snapshot id: 4821964189199835313
|  |     stored statistics:
|  |       table: rows=3 size=1.33KB
|  |       columns missing stats: s, d
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=24B cardinality=3
|  |     in pipelines: 01(GETNEXT)
|  |
|  05:EXCHANGE [HASH(functional_parquet.iceberg_v2_delete_equality_partitioned.d,functional_parquet.iceberg_v2_delete_equality_partitioned.s)]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=0 row-size=28B cardinality=5
|  |  in pipelines: 00(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
|  Per-Host Resources: mem-estimate=64.25MB mem-reservation=32.00KB thread-reservation=2
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_partitioned, RANDOM]
|     HDFS partitions=1/1 files=2 size=1.76KB
|     Iceberg snapshot id: 4821964189199835313
|     stored statistics:
|       table: rows=8 size=4.81KB
|       columns missing stats: i, s, d
|     extrapolated-rows=disabled max-scan-range-rows=4
|     mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
|     tuple-ids=0 row-size=28B cardinality=5
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_partitioned, RANDOM]
   HDFS partitions=1/1 files=2 size=1.71KB
   Iceberg snapshot id: 4821964189199835313
   stored statistics:
     table: rows=8 size=4.81KB
     columns missing stats: i, s, d
   extrapolated-rows=disabled max-scan-range-rows=4
   mem-estimate=64.00MB mem-reservation=32.00KB thread-reservation=1
   tuple-ids=0 row-size=28B cardinality=3
   in pipelines: 03(GETNEXT)
====
# Table has some equality delete files with different equality field ID lists. These have
# separate HASH JOINs. The equality delete file SCANs with higher cardinality happen
# earlier.
select * from functional_parquet.iceberg_v2_delete_equality_multi_eq_ids;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=169.81MB mem-reservation=9.89MB thread-reservation=5
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i, functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
08:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=24B cardinality=10
|  in pipelines: 07(GETNEXT), 00(GETNEXT)
|
|--06:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-05.i
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-05.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=24B cardinality=8
|  |  in pipelines: 00(GETNEXT), 05(OPEN)
|  |
|  |--05:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-05 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-05]
|  |     HDFS partitions=1/1 files=1 size=444B
|  |     Iceberg snapshot id: 4077234998626563290
|  |     stored statistics:
|  |       table: rows=1 size=444B
|  |       columns missing stats: i
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=6 row-size=12B cardinality=1
|  |     in pipelines: 05(GETNEXT)
|  |
|  04:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=24B cardinality=8
|  |  in pipelines: 00(GETNEXT), 03(OPEN)
|  |
|  |--03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03]
|  |     HDFS partitions=1/1 files=1 size=473B
|  |     Iceberg snapshot id: 4077234998626563290
|  |     stored statistics:
|  |       table: rows=2 size=473B
|  |       columns missing stats: s
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=4 row-size=20B cardinality=2
|  |     in pipelines: 03(GETNEXT)
|  |
|  02:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.i, functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=24B cardinality=8
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01]
|  |     HDFS partitions=1/1 files=1 size=726B
|  |     Iceberg snapshot id: 4077234998626563290
|  |     stored statistics:
|  |       table: rows=2 size=726B
|  |       columns missing stats: i, s
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=24B cardinality=2
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids]
|     HDFS partitions=1/1 files=3 size=1.99KB
|     Iceberg snapshot id: 4077234998626563290
|     stored statistics:
|       table: rows=10 size=4.29KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|     tuple-ids=0 row-size=24B cardinality=8
|     in pipelines: 00(GETNEXT)
|
07:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids]
   HDFS partitions=1/1 files=1 size=713B
   Iceberg snapshot id: 4077234998626563290
   stored statistics:
     table: rows=10 size=4.29KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=10
   mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
   tuple-ids=0 row-size=24B cardinality=2
   in pipelines: 07(GETNEXT)
---- DISTRIBUTEDPLAN
F06:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i, functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
12:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=24B cardinality=10
|  in pipelines: 07(GETNEXT), 00(GETNEXT)
|
F05:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
Per-Host Resources: mem-estimate=53.97MB mem-reservation=5.84MB thread-reservation=2
08:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=24B cardinality=10
|  in pipelines: 07(GETNEXT), 00(GETNEXT)
|
|--06:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-05.i
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-05.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=24B cardinality=8
|  |  in pipelines: 00(GETNEXT), 05(OPEN)
|  |
|  |--11:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=6 row-size=12B cardinality=1
|  |  |  in pipelines: 05(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=32.06MB mem-reservation=16.00KB thread-reservation=2
|  |  05:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-05 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-05, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=444B
|  |     Iceberg snapshot id: 4077234998626563290
|  |     stored statistics:
|  |       table: rows=1 size=444B
|  |       columns missing stats: i
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=6 row-size=12B cardinality=1
|  |     in pipelines: 05(GETNEXT)
|  |
|  04:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=24B cardinality=8
|  |  in pipelines: 00(GETNEXT), 03(OPEN)
|  |
|  |--10:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=4 row-size=20B cardinality=2
|  |  |  in pipelines: 03(GETNEXT)
|  |  |
|  |  F03:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=32.09MB mem-reservation=16.00KB thread-reservation=2
|  |  03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=473B
|  |     Iceberg snapshot id: 4077234998626563290
|  |     stored statistics:
|  |       table: rows=2 size=473B
|  |       columns missing stats: s
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=4 row-size=20B cardinality=2
|  |     in pipelines: 03(GETNEXT)
|  |
|  02:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.i, functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=24B cardinality=8
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--09:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=2 row-size=24B cardinality=2
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=48.11MB mem-reservation=24.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=726B
|  |     Iceberg snapshot id: 4077234998626563290
|  |     stored statistics:
|  |       table: rows=2 size=726B
|  |       columns missing stats: i, s
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=24B cardinality=2
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids, RANDOM]
|     HDFS partitions=1/1 files=3 size=1.99KB
|     Iceberg snapshot id: 4077234998626563290
|     stored statistics:
|       table: rows=10 size=4.29KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|     tuple-ids=0 row-size=24B cardinality=8
|     in pipelines: 00(GETNEXT)
|
07:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids, RANDOM]
   HDFS partitions=1/1 files=1 size=713B
   Iceberg snapshot id: 4077234998626563290
   stored statistics:
     table: rows=10 size=4.29KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=10
   mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
   tuple-ids=0 row-size=24B cardinality=2
   in pipelines: 07(GETNEXT)
====
# Similar as above but doing time travel to a snapshot where we don't have delete files
# for [i,s].
select * from functional_parquet.iceberg_v2_delete_equality_multi_eq_ids for system_version as of 5777805847908928861;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=119.88MB mem-reservation=7.93MB thread-reservation=4
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i, functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
06:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=24B cardinality=8
|  in pipelines: 05(GETNEXT), 00(GETNEXT)
|
|--04:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.i
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=24B cardinality=4
|  |  in pipelines: 00(GETNEXT), 03(OPEN)
|  |
|  |--03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03]
|  |     HDFS partitions=1/1 files=1 size=444B
|  |     Iceberg snapshot id: 5777805847908928861
|  |     stored statistics:
|  |       table: rows=1 size=444B
|  |       columns missing stats: i
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=4 row-size=12B cardinality=1
|  |     in pipelines: 03(GETNEXT)
|  |
|  02:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=24B cardinality=4
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01]
|  |     HDFS partitions=1/1 files=1 size=473B
|  |     Iceberg snapshot id: 5777805847908928861
|  |     stored statistics:
|  |       table: rows=2 size=473B
|  |       columns missing stats: s
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=20B cardinality=2
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids]
|     HDFS partitions=1/1 files=2 size=1.33KB
|     Iceberg snapshot id: 5777805847908928861
|     stored statistics:
|       table: rows=10 size=4.29KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|     tuple-ids=0 row-size=24B cardinality=4
|     in pipelines: 00(GETNEXT)
|
05:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids]
   HDFS partitions=1/1 files=1 size=673B
   Iceberg snapshot id: 5777805847908928861
   stored statistics:
     table: rows=10 size=4.29KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=10
   mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
   tuple-ids=0 row-size=24B cardinality=4
   in pipelines: 05(GETNEXT)
---- DISTRIBUTEDPLAN
F05:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i, functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
09:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=24B cardinality=8
|  in pipelines: 05(GETNEXT), 00(GETNEXT)
|
F04:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=52.02MB mem-reservation=3.90MB thread-reservation=2
06:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=24B cardinality=8
|  in pipelines: 05(GETNEXT), 00(GETNEXT)
|
|--04:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.i
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=24B cardinality=4
|  |  in pipelines: 00(GETNEXT), 03(OPEN)
|  |
|  |--08:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=4 row-size=12B cardinality=1
|  |  |  in pipelines: 03(GETNEXT)
|  |  |
|  |  F03:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=32.06MB mem-reservation=16.00KB thread-reservation=2
|  |  03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=444B
|  |     Iceberg snapshot id: 5777805847908928861
|  |     stored statistics:
|  |       table: rows=1 size=444B
|  |       columns missing stats: i
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=4 row-size=12B cardinality=1
|  |     in pipelines: 03(GETNEXT)
|  |
|  02:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=24B cardinality=4
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--07:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=2 row-size=20B cardinality=2
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=32.09MB mem-reservation=16.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=473B
|  |     Iceberg snapshot id: 5777805847908928861
|  |     stored statistics:
|  |       table: rows=2 size=473B
|  |       columns missing stats: s
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=20B cardinality=2
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids, RANDOM]
|     HDFS partitions=1/1 files=2 size=1.33KB
|     Iceberg snapshot id: 5777805847908928861
|     stored statistics:
|       table: rows=10 size=4.29KB
|       columns missing stats: i, s
|     extrapolated-rows=disabled max-scan-range-rows=5
|     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|     tuple-ids=0 row-size=24B cardinality=4
|     in pipelines: 00(GETNEXT)
|
05:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids, RANDOM]
   HDFS partitions=1/1 files=1 size=673B
   Iceberg snapshot id: 5777805847908928861
   stored statistics:
     table: rows=10 size=4.29KB
     columns missing stats: i, s
   extrapolated-rows=disabled max-scan-range-rows=10
   mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
   tuple-ids=0 row-size=24B cardinality=4
   in pipelines: 05(GETNEXT)
====
# Table has both positional and equality delete files where some equality delete files
# have different equality field ID lists. First the join for the positional deletes is
# executed and then the joins for the different equality field id lists.
select * from functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=231.88MB mem-reservation=7.99MB thread-reservation=5
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.i, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.s, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.d
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
08:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=48B cardinality=6
|  in pipelines: 07(GETNEXT), 00(GETNEXT)
|
|--06:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05.d, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=48B cardinality=4
|  |  in pipelines: 00(GETNEXT), 05(OPEN)
|  |
|  |--05:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-EQUALITY-DELETE-05 functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05]
|  |     HDFS partitions=1/1 files=1 size=663B
|  |     Iceberg snapshot id: 152862018760071153
|  |     stored statistics:
|  |       table: rows=2 size=663B
|  |       columns missing stats: s, d
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=6 row-size=24B cardinality=2
|  |     in pipelines: 05(GETNEXT)
|  |
|  04:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03.i, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=48B cardinality=4
|  |  in pipelines: 00(GETNEXT), 03(OPEN)
|  |
|  |--03:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03]
|  |     HDFS partitions=1/1 files=1 size=656B
|  |     Iceberg snapshot id: 152862018760071153
|  |     stored statistics:
|  |       table: rows=2 size=656B
|  |       columns missing stats: i, s
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=4 row-size=24B cardinality=2
|  |     in pipelines: 03(GETNEXT)
|  |
|  02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  equality predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.file__position = functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-position-delete.pos, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.input__file__name = functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-position-delete.file_path
|  |  mem-estimate=1.38KB mem-reservation=1.38KB thread-reservation=0
|  |  tuple-ids=0 row-size=48B cardinality=4
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-position-delete]
|  |     HDFS partitions=1/1 files=1 size=1.59KB
|  |     Iceberg snapshot id: 152862018760071153
|  |     stored statistics:
|  |       table: rows=1 size=1.59KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=192B cardinality=1
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids]
|     HDFS partitions=1/1 files=2 size=1.68KB
|     Iceberg snapshot id: 152862018760071153
|     stored statistics:
|       table: rows=7 size=5.39KB
|       columns missing stats: i, s, d
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
|     tuple-ids=0 row-size=48B cardinality=5
|     in pipelines: 00(GETNEXT)
|
07:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids]
   HDFS partitions=1/1 files=1 size=853B
   Iceberg snapshot id: 152862018760071153
   stored statistics:
     table: rows=7 size=5.39KB
     columns missing stats: i, s, d
   extrapolated-rows=disabled max-scan-range-rows=7
   mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
   tuple-ids=0 row-size=48B cardinality=2
   in pipelines: 07(GETNEXT)
---- DISTRIBUTEDPLAN
F06:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.i, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.s, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.d
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
12:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=48B cardinality=6
|  in pipelines: 07(GETNEXT), 00(GETNEXT)
|
F05:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=100.13MB mem-reservation=3.92MB thread-reservation=2
08:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=48B cardinality=6
|  in pipelines: 07(GETNEXT), 00(GETNEXT)
|
|--06:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05.d, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=48B cardinality=4
|  |  in pipelines: 00(GETNEXT), 05(OPEN)
|  |
|  |--11:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=6 row-size=24B cardinality=2
|  |  |  in pipelines: 05(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=48.11MB mem-reservation=24.00KB thread-reservation=2
|  |  05:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-EQUALITY-DELETE-05 functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=663B
|  |     Iceberg snapshot id: 152862018760071153
|  |     stored statistics:
|  |       table: rows=2 size=663B
|  |       columns missing stats: s, d
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=6 row-size=24B cardinality=2
|  |     in pipelines: 05(GETNEXT)
|  |
|  04:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03.i, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=48B cardinality=4
|  |  in pipelines: 00(GETNEXT), 03(OPEN)
|  |
|  |--10:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=4 row-size=24B cardinality=2
|  |  |  in pipelines: 03(GETNEXT)
|  |  |
|  |  F03:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=48.11MB mem-reservation=24.00KB thread-reservation=2
|  |  03:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=656B
|  |     Iceberg snapshot id: 152862018760071153
|  |     stored statistics:
|  |       table: rows=2 size=656B
|  |       columns missing stats: i, s
|  |     extrapolated-rows=disabled max-scan-range-rows=2
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=4 row-size=24B cardinality=2
|  |     in pipelines: 03(GETNEXT)
|  |
|  02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  equality predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.file__position = functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-position-delete.pos, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.input__file__name = functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-position-delete.file_path
|  |  mem-estimate=705B mem-reservation=705B thread-reservation=0
|  |  tuple-ids=0 row-size=48B cardinality=4
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--09:EXCHANGE [DIRECTED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=1 row-size=192B cardinality=1
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Resources: mem-estimate=33.53MB mem-reservation=16.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-position-delete, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.59KB
|  |     Iceberg snapshot id: 152862018760071153
|  |     stored statistics:
|  |       table: rows=1 size=1.59KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=32.00MB mem-reservation=16.00KB thread-reservation=1
|  |     tuple-ids=1 row-size=192B cardinality=1
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids, RANDOM]
|     HDFS partitions=1/1 files=2 size=1.68KB
|     Iceberg snapshot id: 152862018760071153
|     stored statistics:
|       table: rows=7 size=5.39KB
|       columns missing stats: i, s, d
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
|     tuple-ids=0 row-size=48B cardinality=5
|     in pipelines: 00(GETNEXT)
|
07:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids, RANDOM]
   HDFS partitions=1/1 files=1 size=853B
   Iceberg snapshot id: 152862018760071153
   stored statistics:
     table: rows=7 size=5.39KB
     columns missing stats: i, s, d
   extrapolated-rows=disabled max-scan-range-rows=7
   mem-estimate=96.00MB mem-reservation=48.00KB thread-reservation=1
   tuple-ids=0 row-size=48B cardinality=2
   in pipelines: 07(GETNEXT)
====
# Query a table that has schema evolution and equality deletes.
select * from functional_parquet.iceberg_v2_equality_delete_schema_evolution;
---- PLAN
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=133.94MB mem-reservation=6.00MB thread-reservation=3
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_equality_delete_schema_evolution.i, functional_parquet.iceberg_v2_equality_delete_schema_evolution.d, functional_parquet.iceberg_v2_equality_delete_schema_evolution.str, functional_parquet.iceberg_v2_equality_delete_schema_evolution.j
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=32B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_equality_delete_schema_evolution.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01.d, functional_parquet.iceberg_v2_equality_delete_schema_evolution.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01.i
|  |  other join predicates: functional_parquet.iceberg_v2_equality_delete_schema_evolution.iceberg__data__sequence__number < functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=32B cardinality=4
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_equality_delete_schema_evolution-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01]
|  |     HDFS partitions=1/1 files=3 size=1.97KB
|  |     Iceberg snapshot id: 5816823095034839884
|  |     stored statistics:
|  |       table: rows=3 size=1.97KB
|  |       columns missing stats: i, d
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=16B cardinality=3
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_equality_delete_schema_evolution]
|     HDFS partitions=1/1 files=2 size=1.63KB
|     Iceberg snapshot id: 5816823095034839884
|     stored statistics:
|       table: rows=6 size=5.50KB
|       columns missing stats: i, d, str, j
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=80.00MB mem-reservation=40.00KB thread-reservation=1
|     tuple-ids=0 row-size=32B cardinality=4
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_equality_delete_schema_evolution]
   HDFS partitions=1/1 files=2 size=1.90KB
   Iceberg snapshot id: 5816823095034839884
   stored statistics:
     table: rows=6 size=5.50KB
     columns missing stats: i, d, str, j
   extrapolated-rows=disabled max-scan-range-rows=3
   mem-estimate=80.00MB mem-reservation=40.00KB thread-reservation=1
   tuple-ids=0 row-size=32B cardinality=2
   in pipelines: 03(GETNEXT)
---- DISTRIBUTEDPLAN
F04:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
PLAN-ROOT SINK
|  output exprs: functional_parquet.iceberg_v2_equality_delete_schema_evolution.i, functional_parquet.iceberg_v2_equality_delete_schema_evolution.d, functional_parquet.iceberg_v2_equality_delete_schema_evolution.str, functional_parquet.iceberg_v2_equality_delete_schema_evolution.j
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|
06:EXCHANGE [UNPARTITIONED]
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=32B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
F03:PLAN FRAGMENT [RANDOM] hosts=2 instances=2
Per-Host Resources: mem-estimate=82.09MB mem-reservation=1.98MB thread-reservation=2
04:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0 row-size=32B cardinality=6
|  in pipelines: 03(GETNEXT), 00(GETNEXT)
|
|--02:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_equality_delete_schema_evolution.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01.d, functional_parquet.iceberg_v2_equality_delete_schema_evolution.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01.i
|  |  other join predicates: functional_parquet.iceberg_v2_equality_delete_schema_evolution.iceberg__data__sequence__number < functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01.iceberg__data__sequence__number
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=0 row-size=32B cardinality=4
|  |  in pipelines: 00(GETNEXT), 01(OPEN)
|  |
|  |--05:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=2 row-size=16B cardinality=3
|  |  |  in pipelines: 01(GETNEXT)
|  |  |
|  |  F02:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Host Resources: mem-estimate=48.08MB mem-reservation=24.00KB thread-reservation=2
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_equality_delete_schema_evolution-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01, RANDOM]
|  |     HDFS partitions=1/1 files=3 size=1.97KB
|  |     Iceberg snapshot id: 5816823095034839884
|  |     stored statistics:
|  |       table: rows=3 size=1.97KB
|  |       columns missing stats: i, d
|  |     extrapolated-rows=disabled max-scan-range-rows=1
|  |     mem-estimate=48.00MB mem-reservation=24.00KB thread-reservation=1
|  |     tuple-ids=2 row-size=16B cardinality=3
|  |     in pipelines: 01(GETNEXT)
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_equality_delete_schema_evolution, RANDOM]
|     HDFS partitions=1/1 files=2 size=1.63KB
|     Iceberg snapshot id: 5816823095034839884
|     stored statistics:
|       table: rows=6 size=5.50KB
|       columns missing stats: i, d, str, j
|     extrapolated-rows=disabled max-scan-range-rows=3
|     mem-estimate=80.00MB mem-reservation=40.00KB thread-reservation=1
|     tuple-ids=0 row-size=32B cardinality=4
|     in pipelines: 00(GETNEXT)
|
03:SCAN HDFS [functional_parquet.iceberg_v2_equality_delete_schema_evolution, RANDOM]
   HDFS partitions=1/1 files=2 size=1.90KB
   Iceberg snapshot id: 5816823095034839884
   stored statistics:
     table: rows=6 size=5.50KB
     columns missing stats: i, d, str, j
   extrapolated-rows=disabled max-scan-range-rows=3
   mem-estimate=80.00MB mem-reservation=40.00KB thread-reservation=1
   tuple-ids=0 row-size=32B cardinality=2
   in pipelines: 03(GETNEXT)
====
