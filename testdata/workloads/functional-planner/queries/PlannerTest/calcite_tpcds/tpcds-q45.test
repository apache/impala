# TPCDS-Q45
# start query 45 in stream 0 using template query45.tpl using seed 390857734
select  ca_zip, ca_county, sum(ws_sales_price)
 from web_sales, customer, customer_address, date_dim, item
 where ws_bill_customer_sk = c_customer_sk
 	and c_current_addr_sk = ca_address_sk
 	and ws_item_sk = i_item_sk
 	and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')
 	      or
 	      i_item_id in (select i_item_id
                             from item
                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)
                             )
 	    )
 	and ws_sold_date_sk = d_date_sk
 	and d_qoy = 2 and d_year = 1999
 group by ca_zip, ca_county
 order by ca_zip, ca_county
 limit 100

# end query 45 in stream 0 using template query45.tpl
---- PLAN
Max Per-Host Resource Reservation: Memory=141.62MB Threads=1
Per-Host Resource Estimates: Memory=3.66GB
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=3.66GB mem-reservation=141.62MB thread-reservation=1 runtime-filters-memory=34.00MB
|  max-parallelism=1 segment-costs=[30852, 113824, 820668071, 201601849, 300]
PLAN-ROOT SINK
|  output exprs: tpcds_partitioned_parquet_snap.customer_address.ca_zip, tpcds_partitioned_parquet_snap.customer_address.ca_county, sum(tpcds_partitioned_parquet_snap.web_sales.ws_sales_price)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=300
|
16:TOP-N [LIMIT=100]
|  order by: tpcds_partitioned_parquet_snap.customer_address.ca_zip ASC NULLS LAST, tpcds_partitioned_parquet_snap.customer_address.ca_county ASC NULLS LAST
|  mem-estimate=5.76KB mem-reservation=0B thread-reservation=0
|  tuple-ids=17 row-size=59B cardinality=100 cost=201601849
|  in pipelines: 16(GETNEXT), 15(OPEN)
|
15:AGGREGATE [FINALIZE]
|  output: sum(tpcds_partitioned_parquet_snap.web_sales.ws_sales_price)
|  group by: tpcds_partitioned_parquet_snap.customer_address.ca_zip, tpcds_partitioned_parquet_snap.customer_address.ca_county
|  mem-estimate=884.09MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=16 row-size=59B cardinality=15.00M cost=346166060
|  in pipelines: 15(GETNEXT), 00(OPEN)
|
14:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  other join predicates: substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '85669' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '86197' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '88274' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '83405' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '86475' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '85392' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '85460' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '80348' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '81792' OR count() != CAST(0 AS BIGINT) AND if(TupleIsNull(11), NULL, TRUE) IS NOT NULL AND tpcds_partitioned_parquet_snap.item_0.i_item_id IS NOT NULL
|  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  mem-estimate=2.29GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,6,7,11N,12,14 row-size=151B cardinality=202.49M cost=123130276
|  in pipelines: 00(GETNEXT), 11(OPEN)
|
|--13:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.customer_address.ca_address_sk = tpcds_partitioned_parquet_snap.customer.c_current_addr_sk
|  |  fk/pk conjuncts: none
|  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.customer.c_current_addr_sk, RF007[min_max] <- tpcds_partitioned_parquet_snap.customer.c_current_addr_sk
|  |  mem-estimate=1.22GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=12,14 row-size=55B cardinality=30.00M cost=39283500
|  |  in pipelines: 11(GETNEXT), 12(OPEN)
|  |
|  |--12:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     predicates: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_customer_sk IS NOT NULL
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_customer_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=14 row-size=8B cardinality=30.00M cost=5142000
|  |     in pipelines: 12(GETNEXT)
|  |
|  11:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_address]
|     HDFS partitions=1/1 files=1 size=307.36MB
|     predicates: tpcds_partitioned_parquet_snap.customer_address.ca_address_sk IS NOT NULL
|     runtime filters: RF007[min_max] -> tpcds_partitioned_parquet_snap.customer_address.ca_address_sk, RF006[bloom] -> tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|     stored statistics:
|       table: rows=15.00M size=307.36MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1.58M
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer_address.ca_address_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=12 row-size=47B cardinality=15.00M cost=5381159
|     in pipelines: 11(GETNEXT)
|
10:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk, RF003[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,6,7,11N row-size=96B cardinality=220.04M cost=96698392
|  in pipelines: 00(GETNEXT), 06(OPEN)
|
|--09:HASH JOIN [LEFT OUTER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.item_0.i_item_id = tpcds_partitioned_parquet_snap.item_1.i_item_id
|  |  fk/pk conjuncts: none
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7,11N row-size=60B cardinality=360.00K cost=157582
|  |  in pipelines: 06(GETNEXT), 08(OPEN)
|  |
|  |--08:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_item_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=11 row-size=28B cardinality=10 cost=28
|  |  |  in pipelines: 08(GETNEXT), 07(OPEN)
|  |  |
|  |  07:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     predicates: tpcds_partitioned_parquet_snap.item_1.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.item_1.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.item_1.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=9 row-size=32B cardinality=10 cost=113796
|  |     in pipelines: 07(GETNEXT)
|  |
|  06:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     predicates: tpcds_partitioned_parquet_snap.item_0.i_item_sk IS NOT NULL
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.item_0.i_item_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=7 row-size=32B cardinality=360.00K cost=113796
|     in pipelines: 06(GETNEXT)
|
05:NESTED LOOP JOIN [CROSS JOIN]
|  mem-estimate=8B mem-reservation=0B thread-reservation=0
|  tuple-ids=0,2,6 row-size=36B cardinality=220.15M cost=45108113
|  in pipelines: 00(GETNEXT), 04(OPEN)
|
|--04:AGGREGATE [FINALIZE]
|  |  output: count()
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=6 row-size=8B cardinality=1 cost=0
|  |  in pipelines: 04(GETNEXT), 03(OPEN)
|  |
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=4 row-size=4B cardinality=10 cost=30852
|     in pipelines: 03(GETNEXT)
|
02:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=28B cardinality=220.15M cost=96358513
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=186 cost=18780
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
   partition predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk IS NOT NULL
   HDFS partitions=1823/1824 files=1823 size=145.67GB
   predicates: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk IS NOT NULL, tpcds_partitioned_parquet_snap.web_sales.ws_item_sk IS NOT NULL
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk, RF003[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk
   stored statistics:
     table: rows=2.16G size=145.75GB
     partitions: 1823/1823 rows=2.16G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=186(filtered from 1823)
   parquet dictionary predicates: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk IS NOT NULL, tpcds_partitioned_parquet_snap.web_sales.ws_item_sk IS NOT NULL
   mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
   tuple-ids=0 row-size=16B cardinality=220.15M(filtered from 2.16G) cost=63109900
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
Max Per-Host Resource Reservation: Memory=1.39GB Threads=50
Per-Host Resource Estimates: Memory=3.44GB
F12:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.30MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[337] cpu-comparison-result=200 [max(1 (self) vs 200 (sum children))]
PLAN-ROOT SINK
|  output exprs: tpcds_partitioned_parquet_snap.customer_address.ca_zip, tpcds_partitioned_parquet_snap.customer_address.ca_county, sum(tpcds_partitioned_parquet_snap.web_sales.ws_sales_price)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=300
|
31:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: tpcds_partitioned_parquet_snap.customer_address.ca_zip ASC NULLS LAST, tpcds_partitioned_parquet_snap.customer_address.ca_county ASC NULLS LAST
|  limit: 100
|  mem-estimate=308.05KB mem-reservation=0B thread-reservation=0
|  tuple-ids=17 row-size=59B cardinality=100 cost=37
|  in pipelines: 16(GETNEXT)
|
F11:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer_address.ca_zip,tpcds_partitioned_parquet_snap.customer_address.ca_county)] hosts=10 instances=50 (adjusted from 120)
Per-Instance Resources: mem-estimate=48.92MB mem-reservation=34.00MB thread-reservation=1
max-parallelism=50 segment-costs=[404306975, 201601849, 185] cpu-comparison-result=200 [max(50 (self) vs 200 (sum children))]
16:TOP-N [LIMIT=100]
|  order by: tpcds_partitioned_parquet_snap.customer_address.ca_zip ASC NULLS LAST, tpcds_partitioned_parquet_snap.customer_address.ca_county ASC NULLS LAST
|  mem-estimate=5.76KB mem-reservation=0B thread-reservation=0
|  tuple-ids=17 row-size=59B cardinality=100 cost=201601849
|  in pipelines: 16(GETNEXT), 30(OPEN)
|
30:AGGREGATE [FINALIZE]
|  output: sum:merge(tpcds_partitioned_parquet_snap.web_sales.ws_sales_price)
|  group by: tpcds_partitioned_parquet_snap.customer_address.ca_zip, tpcds_partitioned_parquet_snap.customer_address.ca_county
|  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=16 row-size=59B cardinality=15.00M cost=331086887
|  in pipelines: 30(GETNEXT), 00(OPEN)
|
29:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_address.ca_zip,tpcds_partitioned_parquet_snap.customer_address.ca_county)]
|  mem-estimate=14.92MB mem-reservation=0B thread-reservation=0
|  tuple-ids=16 row-size=59B cardinality=191.51M cost=73220088
|  in pipelines: 00(GETNEXT)
|
F10:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk)] hosts=10 instances=80 (adjusted from 120)
Per-Instance Resources: mem-estimate=164.36MB mem-reservation=34.00MB thread-reservation=1
max-parallelism=140 segment-costs=[1392643845, 825868381] cpu-comparison-result=200 [max(200 (self) vs 145 (sum children))]
15:AGGREGATE [STREAMING]
|  output: sum(tpcds_partitioned_parquet_snap.web_sales.ws_sales_price)
|  group by: tpcds_partitioned_parquet_snap.customer_address.ca_zip, tpcds_partitioned_parquet_snap.customer_address.ca_county
|  mem-estimate=128.47MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=16 row-size=59B cardinality=191.51M cost=1145509709
|  in pipelines: 00(GETNEXT)
|
14:HASH JOIN [INNER JOIN, PARTITIONED]
|  hash-table-id=00
|  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  other join predicates: substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '85669' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '86197' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '88274' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '83405' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '86475' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '85392' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '85460' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '80348' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '81792' OR count() != CAST(0 AS BIGINT) AND if(TupleIsNull(11), NULL, TRUE) IS NOT NULL AND tpcds_partitioned_parquet_snap.item_0.i_item_id IS NOT NULL
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,6,7,11N,12,14 row-size=151B cardinality=202.49M cost=93130276
|  in pipelines: 00(GETNEXT), 11(OPEN)
|
|--F13:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk)] hosts=10 instances=80 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=61.23MB mem-reservation=50.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  max-parallelism=140 segment-costs=[42021671] cpu-comparison-result=110 [max(110 (self) vs 30 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |
|  28:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer.c_customer_sk)]
|  |  mem-estimate=11.23MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=12,14 row-size=55B cardinality=30.00M cost=12021671
|  |  in pipelines: 11(GETNEXT)
|  |
|  F09:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer_address.ca_address_sk)] hosts=10 instances=20 (adjusted from 10)
|  Per-Instance Resources: mem-estimate=30.17MB mem-reservation=0B thread-reservation=1
|  max-parallelism=20 segment-costs=[151287735]
|  13:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.customer_address.ca_address_sk = tpcds_partitioned_parquet_snap.customer.c_current_addr_sk
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=12,14 row-size=55B cardinality=30.00M cost=9283500
|  |  in pipelines: 11(GETNEXT), 12(OPEN)
|  |
|  |--F14:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer_address.ca_address_sk)] hosts=10 instances=20 (adjusted from 10)
|  |  |  Per-Instance Resources: mem-estimate=88.67MB mem-reservation=50.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=20 segment-costs=[34437000]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk
|  |  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.customer.c_current_addr_sk, RF007[min_max] <- tpcds_partitioned_parquet_snap.customer.c_current_addr_sk
|  |  |  mem-estimate=62.55MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  26:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)]
|  |  |  mem-estimate=10.12MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=14 row-size=8B cardinality=30.00M cost=4437000
|  |  |  in pipelines: 12(GETNEXT)
|  |  |
|  |  F08:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[36054000]
|  |  12:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     predicates: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_customer_sk IS NOT NULL
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_customer_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=14 row-size=8B cardinality=30.00M cost=5142000
|  |     in pipelines: 12(GETNEXT)
|  |
|  25:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_address.ca_address_sk)]
|  |  mem-estimate=10.50MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=12 row-size=47B cardinality=15.00M cost=4906835
|  |  in pipelines: 11(GETNEXT)
|  |
|  F07:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=19.98MB mem-reservation=128.00KB thread-reservation=1
|  max-parallelism=10 segment-costs=[58473859]
|  11:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_address, RANDOM]
|     HDFS partitions=1/1 files=1 size=307.36MB
|     predicates: tpcds_partitioned_parquet_snap.customer_address.ca_address_sk IS NOT NULL
|     runtime filters: RF007[min_max] -> tpcds_partitioned_parquet_snap.customer_address.ca_address_sk, RF006[bloom] -> tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|     stored statistics:
|       table: rows=15.00M size=307.36MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1.58M
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer_address.ca_address_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=12 row-size=47B cardinality=15.00M cost=5381159
|     in pipelines: 11(GETNEXT)
|
27:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk)]
|  mem-estimate=23.59MB mem-reservation=0B thread-reservation=0
|  tuple-ids=0,2,6,7,11N row-size=96B cardinality=220.04M cost=154003860
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
Per-Host Shared Resources: mem-estimate=18.00MB mem-reservation=18.00MB thread-reservation=0 runtime-filters-memory=18.00MB
Per-Instance Resources: mem-estimate=52.25MB mem-reservation=128.00KB thread-reservation=1
max-parallelism=186 segment-costs=[2228086346]
10:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=02
|  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,6,7,11N row-size=96B cardinality=220.04M cost=96338392
|  in pipelines: 00(GETNEXT), 06(OPEN)
|
|--F15:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=419.27MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=14 [max(14 (self) vs 4 (sum children))]
|  JOIN BUILD
|  |  join-table-id=02 plan-id=03 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk, RF003[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  24:EXCHANGE [BROADCAST]
|  |  mem-estimate=10.27MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=7,11N row-size=60B cardinality=360.00K cost=478440
|  |  in pipelines: 06(GETNEXT)
|  |
|  F04:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=16.27MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[345240]
|  09:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
|  |  hash-table-id=03
|  |  hash predicates: tpcds_partitioned_parquet_snap.item_0.i_item_id = tpcds_partitioned_parquet_snap.item_1.i_item_id
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7,11N row-size=60B cardinality=360.00K cost=157572
|  |  in pipelines: 06(GETNEXT), 22(OPEN)
|  |
|  |--F16:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=1.95MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[14] cpu-comparison-result=4 [max(4 (self) vs 4 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=03 plan-id=04 cohort-id=03
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_1.i_item_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=10
|  |  |
|  |  23:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=11 row-size=28B cardinality=10 cost=4
|  |  |  in pipelines: 22(GETNEXT)
|  |  |
|  |  F06:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_1.i_item_id)] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=10.12MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[30, 0] cpu-comparison-result=4 [max(4 (self) vs 4 (sum children))]
|  |  22:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_item_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=11 row-size=28B cardinality=10 cost=28
|  |  |  in pipelines: 22(GETNEXT), 07(OPEN)
|  |  |
|  |  21:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_1.i_item_id)]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=11 row-size=28B cardinality=10 cost=2
|  |  |  in pipelines: 07(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=26.50MB mem-reservation=2.50MB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[113824, 23]
|  |  08:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_item_id
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=11 row-size=28B cardinality=10 cost=28
|  |  |  in pipelines: 07(GETNEXT)
|  |  |
|  |  07:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     predicates: tpcds_partitioned_parquet_snap.item_1.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.item_1.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.item_1.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=9 row-size=32B cardinality=10 cost=113796
|  |     in pipelines: 07(GETNEXT)
|  |
|  06:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     predicates: tpcds_partitioned_parquet_snap.item_0.i_item_sk IS NOT NULL
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.item_0.i_item_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=7 row-size=32B cardinality=360.00K cost=113796
|     in pipelines: 06(GETNEXT)
|
05:NESTED LOOP JOIN [CROSS JOIN, BROADCAST]
|  join table id: 04
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0,2,6 row-size=36B cardinality=220.15M cost=45108113
|  in pipelines: 00(GETNEXT), 19(OPEN)
|
|--F17:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.01KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=10 [max(10 (self) vs 4 (sum children))]
|  JOIN BUILD
|  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  mem-estimate=8B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  20:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=6 row-size=8B cardinality=1 cost=0
|  |  in pipelines: 19(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=64.00KB mem-reservation=0B thread-reservation=1
|  max-parallelism=1 segment-costs=[0, 0] cpu-comparison-result=4 [max(1 (self) vs 4 (sum children))]
|  19:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=6 row-size=8B cardinality=1 cost=0
|  |  in pipelines: 19(GETNEXT), 04(OPEN)
|  |
|  18:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=6 row-size=8B cardinality=4 cost=0
|  |  in pipelines: 04(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[30852, 4]
|  04:AGGREGATE
|  |  output: count()
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=6 row-size=8B cardinality=4 cost=0
|  |  in pipelines: 04(GETNEXT), 03(OPEN)
|  |
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=4 row-size=4B cardinality=10 cost=30852
|     in pipelines: 03(GETNEXT)
|
02:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=05
|  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=28B cardinality=220.15M cost=96358327
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--F18:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=24.27MB mem-reservation=24.25MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[426]
|  JOIN BUILD
|  |  join-table-id=05 plan-id=06 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=186
|  |
|  17:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=186 cost=240
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[18790]
|  01:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=186 cost=18780
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
   partition predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk IS NOT NULL
   HDFS partitions=1823/1824 files=1823 size=145.67GB
   predicates: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk IS NOT NULL, tpcds_partitioned_parquet_snap.web_sales.ws_item_sk IS NOT NULL
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk, RF003[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk
   stored statistics:
     table: rows=2.16G size=145.75GB
     partitions: 1823/1823 rows=2.16G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=186(filtered from 1823)
   parquet dictionary predicates: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk IS NOT NULL, tpcds_partitioned_parquet_snap.web_sales.ws_item_sk IS NOT NULL
   mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
   tuple-ids=0 row-size=16B cardinality=220.15M(filtered from 2.16G) cost=63109900
   in pipelines: 00(GETNEXT)
---- PARALLELPLANS
Max Per-Host Resource Reservation: Memory=1.39GB Threads=50
Per-Host Resource Estimates: Memory=3.44GB
F12:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.30MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[337] cpu-comparison-result=200 [max(1 (self) vs 200 (sum children))]
PLAN-ROOT SINK
|  output exprs: tpcds_partitioned_parquet_snap.customer_address.ca_zip, tpcds_partitioned_parquet_snap.customer_address.ca_county, sum(tpcds_partitioned_parquet_snap.web_sales.ws_sales_price)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=300
|
31:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: tpcds_partitioned_parquet_snap.customer_address.ca_zip ASC NULLS LAST, tpcds_partitioned_parquet_snap.customer_address.ca_county ASC NULLS LAST
|  limit: 100
|  mem-estimate=308.05KB mem-reservation=0B thread-reservation=0
|  tuple-ids=17 row-size=59B cardinality=100 cost=37
|  in pipelines: 16(GETNEXT)
|
F11:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer_address.ca_zip,tpcds_partitioned_parquet_snap.customer_address.ca_county)] hosts=10 instances=50 (adjusted from 120)
Per-Instance Resources: mem-estimate=48.92MB mem-reservation=34.00MB thread-reservation=1
max-parallelism=50 segment-costs=[404306975, 201601849, 185] cpu-comparison-result=200 [max(50 (self) vs 200 (sum children))]
16:TOP-N [LIMIT=100]
|  order by: tpcds_partitioned_parquet_snap.customer_address.ca_zip ASC NULLS LAST, tpcds_partitioned_parquet_snap.customer_address.ca_county ASC NULLS LAST
|  mem-estimate=5.76KB mem-reservation=0B thread-reservation=0
|  tuple-ids=17 row-size=59B cardinality=100 cost=201601849
|  in pipelines: 16(GETNEXT), 30(OPEN)
|
30:AGGREGATE [FINALIZE]
|  output: sum:merge(tpcds_partitioned_parquet_snap.web_sales.ws_sales_price)
|  group by: tpcds_partitioned_parquet_snap.customer_address.ca_zip, tpcds_partitioned_parquet_snap.customer_address.ca_county
|  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=16 row-size=59B cardinality=15.00M cost=331086887
|  in pipelines: 30(GETNEXT), 00(OPEN)
|
29:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_address.ca_zip,tpcds_partitioned_parquet_snap.customer_address.ca_county)]
|  mem-estimate=14.92MB mem-reservation=0B thread-reservation=0
|  tuple-ids=16 row-size=59B cardinality=191.51M cost=73220088
|  in pipelines: 00(GETNEXT)
|
F10:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk)] hosts=10 instances=80 (adjusted from 120)
Per-Instance Resources: mem-estimate=164.36MB mem-reservation=34.00MB thread-reservation=1
max-parallelism=140 segment-costs=[1392643845, 825868381] cpu-comparison-result=200 [max(200 (self) vs 145 (sum children))]
15:AGGREGATE [STREAMING]
|  output: sum(tpcds_partitioned_parquet_snap.web_sales.ws_sales_price)
|  group by: tpcds_partitioned_parquet_snap.customer_address.ca_zip, tpcds_partitioned_parquet_snap.customer_address.ca_county
|  mem-estimate=128.47MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=16 row-size=59B cardinality=191.51M cost=1145509709
|  in pipelines: 00(GETNEXT)
|
14:HASH JOIN [INNER JOIN, PARTITIONED]
|  hash-table-id=00
|  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  other join predicates: substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '85669' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '86197' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '88274' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '83405' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '86475' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '85392' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '85460' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '80348' OR substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)) = '81792' OR count() != CAST(0 AS BIGINT) AND if(TupleIsNull(11), NULL, TRUE) IS NOT NULL AND tpcds_partitioned_parquet_snap.item_0.i_item_id IS NOT NULL
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,6,7,11N,12,14 row-size=151B cardinality=202.49M cost=93130276
|  in pipelines: 00(GETNEXT), 11(OPEN)
|
|--F13:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk)] hosts=10 instances=80 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=61.23MB mem-reservation=50.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  max-parallelism=140 segment-costs=[42021671] cpu-comparison-result=110 [max(110 (self) vs 30 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |
|  28:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer.c_customer_sk)]
|  |  mem-estimate=11.23MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=12,14 row-size=55B cardinality=30.00M cost=12021671
|  |  in pipelines: 11(GETNEXT)
|  |
|  F09:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer_address.ca_address_sk)] hosts=10 instances=20 (adjusted from 10)
|  Per-Instance Resources: mem-estimate=30.17MB mem-reservation=0B thread-reservation=1
|  max-parallelism=20 segment-costs=[151287735]
|  13:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.customer_address.ca_address_sk = tpcds_partitioned_parquet_snap.customer.c_current_addr_sk
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=12,14 row-size=55B cardinality=30.00M cost=9283500
|  |  in pipelines: 11(GETNEXT), 12(OPEN)
|  |
|  |--F14:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer_address.ca_address_sk)] hosts=10 instances=20 (adjusted from 10)
|  |  |  Per-Instance Resources: mem-estimate=88.67MB mem-reservation=50.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=20 segment-costs=[34437000]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk
|  |  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.customer.c_current_addr_sk, RF007[min_max] <- tpcds_partitioned_parquet_snap.customer.c_current_addr_sk
|  |  |  mem-estimate=62.55MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  26:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)]
|  |  |  mem-estimate=10.12MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=14 row-size=8B cardinality=30.00M cost=4437000
|  |  |  in pipelines: 12(GETNEXT)
|  |  |
|  |  F08:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[36054000]
|  |  12:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     predicates: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_customer_sk IS NOT NULL
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_customer_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=14 row-size=8B cardinality=30.00M cost=5142000
|  |     in pipelines: 12(GETNEXT)
|  |
|  25:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_address.ca_address_sk)]
|  |  mem-estimate=10.50MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=12 row-size=47B cardinality=15.00M cost=4906835
|  |  in pipelines: 11(GETNEXT)
|  |
|  F07:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=19.98MB mem-reservation=128.00KB thread-reservation=1
|  max-parallelism=10 segment-costs=[58473859]
|  11:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_address, RANDOM]
|     HDFS partitions=1/1 files=1 size=307.36MB
|     predicates: tpcds_partitioned_parquet_snap.customer_address.ca_address_sk IS NOT NULL
|     runtime filters: RF007[min_max] -> tpcds_partitioned_parquet_snap.customer_address.ca_address_sk, RF006[bloom] -> tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|     stored statistics:
|       table: rows=15.00M size=307.36MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1.58M
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer_address.ca_address_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=12 row-size=47B cardinality=15.00M cost=5381159
|     in pipelines: 11(GETNEXT)
|
27:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk)]
|  mem-estimate=23.59MB mem-reservation=0B thread-reservation=0
|  tuple-ids=0,2,6,7,11N row-size=96B cardinality=220.04M cost=154003860
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
Per-Host Shared Resources: mem-estimate=18.00MB mem-reservation=18.00MB thread-reservation=0 runtime-filters-memory=18.00MB
Per-Instance Resources: mem-estimate=52.25MB mem-reservation=128.00KB thread-reservation=1
max-parallelism=186 segment-costs=[2228086346]
10:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=02
|  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,6,7,11N row-size=96B cardinality=220.04M cost=96338392
|  in pipelines: 00(GETNEXT), 06(OPEN)
|
|--F15:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=419.27MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=14 [max(14 (self) vs 4 (sum children))]
|  JOIN BUILD
|  |  join-table-id=02 plan-id=03 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk, RF003[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  24:EXCHANGE [BROADCAST]
|  |  mem-estimate=10.27MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=7,11N row-size=60B cardinality=360.00K cost=478440
|  |  in pipelines: 06(GETNEXT)
|  |
|  F04:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=16.27MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[345240]
|  09:HASH JOIN [LEFT OUTER JOIN, BROADCAST]
|  |  hash-table-id=03
|  |  hash predicates: tpcds_partitioned_parquet_snap.item_0.i_item_id = tpcds_partitioned_parquet_snap.item_1.i_item_id
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7,11N row-size=60B cardinality=360.00K cost=157572
|  |  in pipelines: 06(GETNEXT), 22(OPEN)
|  |
|  |--F16:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=1.95MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[14] cpu-comparison-result=4 [max(4 (self) vs 4 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=03 plan-id=04 cohort-id=03
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_1.i_item_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=10
|  |  |
|  |  23:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=11 row-size=28B cardinality=10 cost=4
|  |  |  in pipelines: 22(GETNEXT)
|  |  |
|  |  F06:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_1.i_item_id)] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=10.12MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[30, 0] cpu-comparison-result=4 [max(4 (self) vs 4 (sum children))]
|  |  22:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_item_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=11 row-size=28B cardinality=10 cost=28
|  |  |  in pipelines: 22(GETNEXT), 07(OPEN)
|  |  |
|  |  21:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_1.i_item_id)]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=11 row-size=28B cardinality=10 cost=2
|  |  |  in pipelines: 07(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=26.50MB mem-reservation=2.50MB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[113824, 23]
|  |  08:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_item_id
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=11 row-size=28B cardinality=10 cost=28
|  |  |  in pipelines: 07(GETNEXT)
|  |  |
|  |  07:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     predicates: tpcds_partitioned_parquet_snap.item_1.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.item_1.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.item_1.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=9 row-size=32B cardinality=10 cost=113796
|  |     in pipelines: 07(GETNEXT)
|  |
|  06:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     predicates: tpcds_partitioned_parquet_snap.item_0.i_item_sk IS NOT NULL
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.item_0.i_item_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=7 row-size=32B cardinality=360.00K cost=113796
|     in pipelines: 06(GETNEXT)
|
05:NESTED LOOP JOIN [CROSS JOIN, BROADCAST]
|  join table id: 04
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=0,2,6 row-size=36B cardinality=220.15M cost=45108113
|  in pipelines: 00(GETNEXT), 19(OPEN)
|
|--F17:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.01KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=10 [max(10 (self) vs 4 (sum children))]
|  JOIN BUILD
|  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  mem-estimate=8B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  20:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=6 row-size=8B cardinality=1 cost=0
|  |  in pipelines: 19(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=64.00KB mem-reservation=0B thread-reservation=1
|  max-parallelism=1 segment-costs=[0, 0] cpu-comparison-result=4 [max(1 (self) vs 4 (sum children))]
|  19:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=6 row-size=8B cardinality=1 cost=0
|  |  in pipelines: 19(GETNEXT), 04(OPEN)
|  |
|  18:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=6 row-size=8B cardinality=4 cost=0
|  |  in pipelines: 04(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[30852, 4]
|  04:AGGREGATE
|  |  output: count()
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=6 row-size=8B cardinality=4 cost=0
|  |  in pipelines: 04(GETNEXT), 03(OPEN)
|  |
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IN (CAST(2 AS INT), CAST(3 AS INT), CAST(5 AS INT), CAST(7 AS INT), CAST(11 AS INT), CAST(13 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(23 AS INT), CAST(29 AS INT))
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=4 row-size=4B cardinality=10 cost=30852
|     in pipelines: 03(GETNEXT)
|
02:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=05
|  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=28B cardinality=220.15M cost=96358327
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--F18:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=24.27MB mem-reservation=24.25MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[426]
|  JOIN BUILD
|  |  join-table-id=05 plan-id=06 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=186
|  |
|  17:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=186 cost=240
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[18790]
|  01:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=186 cost=18780
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
   partition predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk IS NOT NULL
   HDFS partitions=1823/1824 files=1823 size=145.67GB
   predicates: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk IS NOT NULL, tpcds_partitioned_parquet_snap.web_sales.ws_item_sk IS NOT NULL
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk, RF003[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk
   stored statistics:
     table: rows=2.16G size=145.75GB
     partitions: 1823/1823 rows=2.16G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=186(filtered from 1823)
   parquet dictionary predicates: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk IS NOT NULL, tpcds_partitioned_parquet_snap.web_sales.ws_item_sk IS NOT NULL
   mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
   tuple-ids=0 row-size=16B cardinality=220.15M(filtered from 2.16G) cost=63109900
   in pipelines: 00(GETNEXT)
====
