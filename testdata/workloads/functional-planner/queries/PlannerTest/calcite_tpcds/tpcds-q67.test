# TPCDS-Q67
# start query 67 in stream 0 using template query67.tpl using seed 607441995
select  *
from (select i_category
            ,i_class
            ,i_brand
            ,i_product_name
            ,d_year
            ,d_qoy
            ,d_moy
            ,s_store_id
            ,sumsales
            ,rank() over (partition by i_category order by sumsales desc) rk
      from (select i_category
                  ,i_class
                  ,i_brand
                  ,i_product_name
                  ,d_year
                  ,d_qoy
                  ,d_moy
                  ,s_store_id
                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales
            from store_sales
                ,date_dim
                ,store
                ,item
       where  ss_sold_date_sk=d_date_sk
          and ss_item_sk=i_item_sk
          and ss_store_sk = s_store_sk
          and d_month_seq between 1196 and 1196+11
       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2
where rk <= 100
order by i_category
        ,i_class
        ,i_brand
        ,i_product_name
        ,d_year
        ,d_qoy
        ,d_moy
        ,s_store_id
        ,sumsales
        ,rk
limit 100

# end query 67 in stream 0 using template query67.tpl
---- PLAN
Max Per-Host Resource Reservation: Memory=263.62MB Threads=1
Per-Host Resource Estimates: Memory=55.19GB
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=55.19GB mem-reservation=263.62MB thread-reservation=1 runtime-filters-memory=3.00MB
|  max-parallelism=1 segment-costs=[176670599328, 73050686125, 233936768446, 1261, 1000]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 11 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.store.s_store_id WHEN 9 THEN NULL WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END), rank()
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=1000
|
12:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 11 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.store.s_store_id WHEN 9 THEN NULL WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END) ASC NULLS LAST, rank() ASC NULLS LAST
|  mem-estimate=9.38KB mem-reservation=0B thread-reservation=0
|  tuple-ids=24 row-size=96B cardinality=100 cost=861
|  in pipelines: 12(GETNEXT), 09(OPEN)
|
11:SELECT
|  predicates: rank() <= CAST(100 AS BIGINT)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=22,21 row-size=100B cardinality=200 cost=200
|  in pipelines: 09(GETNEXT)
|
10:ANALYTIC
|  functions: rank()
|  partition by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END
|  order by: aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END) DESC
|  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,21 row-size=100B cardinality=200 cost=200
|  in pipelines: 09(GETNEXT)
|
09:TOP-N
|  order by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END ASC NULLS LAST, aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END) DESC NULLS FIRST
|  limit with ties: 200
|  source expr: rank() <= CAST(100 AS BIGINT)
|  mem-estimate=17.97KB mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=92B cardinality=200 cost=233936768446
|  in pipelines: 09(GETNEXT), 08(OPEN)
|
08:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (CAST(8 AS INT), CAST(9 AS INT), CAST(10 AS INT), CAST(11 AS INT), CAST(12 AS INT), CAST(13 AS INT), CAST(14 AS INT), CAST(15 AS INT), CAST(16 AS INT)), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(9 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(10 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(11 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(12 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(13 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(14 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(15 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(16 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END)
|  group by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(12 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(13 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(14 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(12 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(13 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(14 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(12 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(13 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(12 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN CAST(12 AS INT) THEN NULL WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN CAST(11 AS INT) THEN NULL WHEN CAST(12 AS INT) THEN NULL WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN CAST(10 AS INT) THEN NULL WHEN CAST(11 AS INT) THEN NULL WHEN CAST(12 AS INT) THEN NULL WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.store.s_store_id WHEN CAST(9 AS INT) THEN NULL WHEN CAST(10 AS INT) THEN NULL WHEN CAST(11 AS INT) THEN NULL WHEN CAST(12 AS INT) THEN NULL WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN CAST(8 AS INT) WHEN CAST(9 AS INT) THEN CAST(9 AS INT) WHEN CAST(10 AS INT) THEN CAST(10 AS INT) WHEN CAST(11 AS INT) THEN CAST(11 AS INT) WHEN CAST(12 AS INT) THEN CAST(12 AS INT) WHEN CAST(13 AS INT) THEN CAST(13 AS INT) WHEN CAST(14 AS INT) THEN CAST(14 AS INT) WHEN CAST(15 AS INT) THEN CAST(15 AS INT) WHEN CAST(16 AS INT) THEN CAST(16 AS INT) END
|  mem-estimate=5.18GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=17 row-size=92B cardinality=12.38G cost=73050686125
|  in pipelines: 08(GETNEXT), 07(OPEN)
|
07:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, tpcds_partitioned_parquet_snap.date_dim.d_moy, tpcds_partitioned_parquet_snap.store.s_store_id
|  Class 1
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, tpcds_partitioned_parquet_snap.date_dim.d_moy, NULL
|  Class 2
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, NULL, NULL
|  Class 3
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, NULL, NULL, NULL
|  Class 4
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, NULL, NULL, NULL, NULL
|  Class 5
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, NULL, NULL, NULL, NULL, NULL
|  Class 6
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, NULL, NULL, NULL, NULL, NULL, NULL
|  Class 7
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, NULL, NULL, NULL, NULL, NULL, NULL, NULL
|  Class 8
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
|  mem-estimate=50.00GB mem-reservation=210.75MB thread-reservation=0
|  tuple-ids=8N,9N,10N,11N,12N,13N,14N,15N,16N row-size=1.09KB cardinality=12.38G cost=162840615894
|  in pipelines: 07(GETNEXT), 00(OPEN)
|
06:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=47.95MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4,6 row-size=177B cardinality=8.64G cost=3780169729
|  in pipelines: 00(GETNEXT), 05(OPEN)
|
|--05:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=6 row-size=105B cardinality=360.00K cost=293952
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,4 row-size=72B cardinality=8.64G(filtered from 8.64G) cost=3780599421
|  in pipelines: 00(GETNEXT), 03(OPEN)
|
|--03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_month_seq <= add(CAST(1196 AS INT), CAST(11 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_month_seq >= CAST(1196 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_month_seq <= add(CAST(1196 AS INT), CAST(11 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_month_seq >= CAST(1196 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_month_seq <= add(CAST(1196 AS INT), CAST(11 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_month_seq >= CAST(1196 AS INT)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=4 row-size=20B cardinality=7.30K cost=25143
|     in pipelines: 03(GETNEXT)
|
02:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk = tpcds_partitioned_parquet_snap.store.s_store_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk = tpcds_partitioned_parquet_snap.store.s_store_sk
|  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.store.s_store_sk, RF005[min_max] <- tpcds_partitioned_parquet_snap.store.s_store_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=52B cardinality=8.64G(filtered from 8.64G) cost=3780593466
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [tpcds_partitioned_parquet_snap.store]
|     HDFS partitions=1/1 files=1 size=119.76KB
|     stored statistics:
|       table: rows=1.35K size=119.76KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1.35K
|     mem-estimate=16.00MB mem-reservation=16.00KB thread-reservation=0
|     tuple-ids=2 row-size=32B cardinality=1.35K cost=388
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF005[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_store_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_store_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=20B cardinality=8.64G(filtered from 8.64G) cost=2488301335
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
Max Per-Host Resource Reservation: Memory=4.70GB Threads=27
Per-Host Resource Estimates: Memory=104.39GB
F06:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.10MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[1044] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 11 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.store.s_store_id WHEN 9 THEN NULL WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END), rank()
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=1000
|
20:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 11 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.store.s_store_id WHEN 9 THEN NULL WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END) ASC NULLS LAST, rank() ASC NULLS LAST
|  limit: 100
|  mem-estimate=98.59KB mem-reservation=0B thread-reservation=0
|  tuple-ids=24 row-size=96B cardinality=100 cost=44
|  in pipelines: 12(GETNEXT)
|
F05:PLAN FRAGMENT [HASH(CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=5.30MB mem-reservation=4.00MB thread-reservation=1
max-parallelism=10 segment-costs=[967, 1261, 282] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
12:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 11 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.store.s_store_id WHEN 9 THEN NULL WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END) ASC NULLS LAST, rank() ASC NULLS LAST
|  mem-estimate=9.38KB mem-reservation=0B thread-reservation=0
|  tuple-ids=24 row-size=96B cardinality=100 cost=861
|  in pipelines: 12(GETNEXT), 19(OPEN)
|
11:SELECT
|  predicates: rank() <= CAST(100 AS BIGINT)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=22,21 row-size=100B cardinality=200 cost=200
|  in pipelines: 19(GETNEXT)
|
10:ANALYTIC
|  functions: rank()
|  partition by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END
|  order by: aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END) DESC
|  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,21 row-size=100B cardinality=200 cost=200
|  in pipelines: 19(GETNEXT)
|
19:TOP-N
|  order by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END ASC NULLS LAST, aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END) DESC NULLS FIRST
|  limit with ties: 200
|  mem-estimate=17.97KB mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=92B cardinality=200 cost=861
|  in pipelines: 19(GETNEXT), 09(OPEN)
|
18:EXCHANGE [HASH(CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END)]
|  mem-estimate=1.28MB mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=92B cardinality=200 cost=106
|  in pipelines: 09(GETNEXT)
|
F04:PLAN FRAGMENT [HASH(CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 13 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 15 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 13 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 13 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_qoy) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_qoy) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_qoy) WHEN 11 THEN murmur_hash(NULL) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_moy) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_moy) WHEN 10 THEN murmur_hash(NULL) WHEN 11 THEN murmur_hash(NULL) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.store.s_store_id) WHEN 9 THEN murmur_hash(NULL) WHEN 10 THEN murmur_hash(NULL) WHEN 11 THEN murmur_hash(NULL) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END)] hosts=10 instances=70 (adjusted from 120)
Per-Instance Resources: mem-estimate=7.14GB mem-reservation=244.75MB thread-reservation=1
max-parallelism=26630 segment-costs=[266227423359, 73050686125, 233936768446, 1288] cpu-comparison-result=120 [max(70 (self) vs 120 (sum children))]
09:TOP-N
|  order by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END ASC NULLS LAST, aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END) DESC NULLS FIRST
|  limit with ties: 200
|  source expr: rank() <= CAST(100 AS BIGINT)
|  mem-estimate=17.97KB mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=92B cardinality=200 cost=233936768446
|  in pipelines: 09(GETNEXT), 08(OPEN)
|
08:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (CAST(8 AS INT), CAST(9 AS INT), CAST(10 AS INT), CAST(11 AS INT), CAST(12 AS INT), CAST(13 AS INT), CAST(14 AS INT), CAST(15 AS INT), CAST(16 AS INT)), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(9 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(10 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(11 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(12 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(13 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(14 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(15 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(16 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END)
|  group by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(12 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(13 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(14 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(12 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(13 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(14 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(12 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(13 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(12 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN CAST(12 AS INT) THEN NULL WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN CAST(11 AS INT) THEN NULL WHEN CAST(12 AS INT) THEN NULL WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN CAST(10 AS INT) THEN NULL WHEN CAST(11 AS INT) THEN NULL WHEN CAST(12 AS INT) THEN NULL WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.store.s_store_id WHEN CAST(9 AS INT) THEN NULL WHEN CAST(10 AS INT) THEN NULL WHEN CAST(11 AS INT) THEN NULL WHEN CAST(12 AS INT) THEN NULL WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN CAST(8 AS INT) WHEN CAST(9 AS INT) THEN CAST(9 AS INT) WHEN CAST(10 AS INT) THEN CAST(10 AS INT) WHEN CAST(11 AS INT) THEN CAST(11 AS INT) WHEN CAST(12 AS INT) THEN CAST(12 AS INT) WHEN CAST(13 AS INT) THEN CAST(13 AS INT) WHEN CAST(14 AS INT) THEN CAST(14 AS INT) WHEN CAST(15 AS INT) THEN CAST(15 AS INT) WHEN CAST(16 AS INT) THEN CAST(16 AS INT) END
|  mem-estimate=578.50MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=17 row-size=92B cardinality=12.38G cost=73050686125
|  in pipelines: 08(GETNEXT), 17(OPEN)
|
17:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, tpcds_partitioned_parquet_snap.date_dim.d_moy, tpcds_partitioned_parquet_snap.store.s_store_id
|  Class 1
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, tpcds_partitioned_parquet_snap.date_dim.d_moy, NULL
|  Class 2
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, NULL, NULL
|  Class 3
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, NULL, NULL, NULL, NULL
|  Class 5
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, NULL, NULL, NULL, NULL, NULL
|  Class 6
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, NULL, NULL, NULL, NULL, NULL, NULL
|  Class 7
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, NULL, NULL, NULL, NULL, NULL, NULL, NULL
|  Class 8
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
|  mem-estimate=6.57GB mem-reservation=210.75MB thread-reservation=0
|  tuple-ids=8N,9N,10N,11N,12N,13N,14N,15N,16N row-size=1.09KB cardinality=12.38G cost=97683994945
|  in pipelines: 17(GETNEXT), 00(OPEN)
|
16:EXCHANGE [HASH(CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 13 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 15 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 13 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 13 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_qoy) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_qoy) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_qoy) WHEN 11 THEN murmur_hash(NULL) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_moy) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_moy) WHEN 10 THEN murmur_hash(NULL) WHEN 11 THEN murmur_hash(NULL) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.store.s_store_id) WHEN 9 THEN murmur_hash(NULL) WHEN 10 THEN murmur_hash(NULL) WHEN 11 THEN murmur_hash(NULL) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END)]
|  mem-estimate=145.58MB mem-reservation=0B thread-reservation=0
|  tuple-ids=8N,9N,10N,11N,12N,13N,14N,15N,16N row-size=1.09KB cardinality=30.30G cost=168543428414
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
Per-Instance Resources: mem-estimate=4.49GB mem-reservation=219.00MB thread-reservation=1
max-parallelism=1824 segment-costs=[257851731293, 2328086935759] cpu-comparison-result=120 [max(120 (self) vs 36 (sum children))]
07:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, tpcds_partitioned_parquet_snap.date_dim.d_moy, tpcds_partitioned_parquet_snap.store.s_store_id
|  Class 1
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, tpcds_partitioned_parquet_snap.date_dim.d_moy, NULL
|  Class 2
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, NULL, NULL
|  Class 3
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, NULL, NULL, NULL
|  Class 4
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, NULL, NULL, NULL, NULL
|  Class 5
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, NULL, NULL, NULL, NULL, NULL
|  Class 6
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, NULL, NULL, NULL, NULL, NULL, NULL
|  Class 7
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, NULL, NULL, NULL, NULL, NULL, NULL, NULL
|  Class 8
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
|  mem-estimate=4.17GB mem-reservation=211.00MB thread-reservation=0
|  tuple-ids=8N,9N,10N,11N,12N,13N,14N,15N,16N row-size=1.09KB cardinality=30.30G cost=244022435997
|  in pipelines: 00(GETNEXT)
|
06:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=00
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4,6 row-size=177B cardinality=8.64G cost=3779809729
|  in pipelines: 00(GETNEXT), 05(OPEN)
|
|--F07:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=419.42MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  15:EXCHANGE [BROADCAST]
|  |  mem-estimate=10.42MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=6 row-size=105B cardinality=360.00K cost=478440
|  |  in pipelines: 05(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=16.42MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[403500]
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=6 row-size=105B cardinality=360.00K cost=293952
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=01
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,4 row-size=72B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  in pipelines: 00(GETNEXT), 03(OPEN)
|
|--F08:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=24.41MB mem-reservation=24.25MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[17005]
|  JOIN BUILD
|  |  join-table-id=01 plan-id=02 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |
|  14:EXCHANGE [BROADCAST]
|  |  mem-estimate=166.68KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=4 row-size=20B cardinality=7.30K cost=9700
|  |  in pipelines: 03(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=1.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[25695]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_month_seq <= add(CAST(1196 AS INT), CAST(11 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_month_seq >= CAST(1196 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_month_seq <= add(CAST(1196 AS INT), CAST(11 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_month_seq >= CAST(1196 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_month_seq <= add(CAST(1196 AS INT), CAST(11 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_month_seq >= CAST(1196 AS INT)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=4 row-size=20B cardinality=7.30K cost=25143
|     in pipelines: 03(GETNEXT)
|
02:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=02
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk = tpcds_partitioned_parquet_snap.store.s_store_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk = tpcds_partitioned_parquet_snap.store.s_store_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=52B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--F09:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=24.33MB mem-reservation=24.25MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[3140]
|  JOIN BUILD
|  |  join-table-id=02 plan-id=03 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.store.s_store_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.store.s_store_sk, RF005[min_max] <- tpcds_partitioned_parquet_snap.store.s_store_sk
|  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=1350
|  |
|  13:EXCHANGE [BROADCAST]
|  |  mem-estimate=78.19KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=32B cardinality=1.35K cost=1790
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.14MB mem-reservation=16.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[533]
|  01:SCAN HDFS [tpcds_partitioned_parquet_snap.store, RANDOM]
|     HDFS partitions=1/1 files=1 size=119.76KB
|     stored statistics:
|       table: rows=1.35K size=119.76KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1.35K
|     mem-estimate=16.00MB mem-reservation=16.00KB thread-reservation=0
|     tuple-ids=2 row-size=32B cardinality=1.35K cost=388
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF005[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_store_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_store_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=20B cardinality=8.64G(filtered from 8.64G) cost=2488301335
   in pipelines: 00(GETNEXT)
---- PARALLELPLANS
Max Per-Host Resource Reservation: Memory=4.70GB Threads=27
Per-Host Resource Estimates: Memory=104.39GB
F06:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.10MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[1044] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 11 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.store.s_store_id WHEN 9 THEN NULL WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END, aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END), rank()
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=1000
|
20:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 11 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.store.s_store_id WHEN 9 THEN NULL WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END) ASC NULLS LAST, rank() ASC NULLS LAST
|  limit: 100
|  mem-estimate=98.59KB mem-reservation=0B thread-reservation=0
|  tuple-ids=24 row-size=96B cardinality=100 cost=44
|  in pipelines: 12(GETNEXT)
|
F05:PLAN FRAGMENT [HASH(CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=5.30MB mem-reservation=4.00MB thread-reservation=1
max-parallelism=10 segment-costs=[967, 1261, 282] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
12:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_class WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 11 THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 10 THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 9 THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.store.s_store_id WHEN 9 THEN NULL WHEN 10 THEN NULL WHEN 11 THEN NULL WHEN 12 THEN NULL WHEN 13 THEN NULL WHEN 14 THEN NULL WHEN 15 THEN NULL WHEN 16 THEN NULL END ASC NULLS LAST, aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END) ASC NULLS LAST, rank() ASC NULLS LAST
|  mem-estimate=9.38KB mem-reservation=0B thread-reservation=0
|  tuple-ids=24 row-size=96B cardinality=100 cost=861
|  in pipelines: 12(GETNEXT), 19(OPEN)
|
11:SELECT
|  predicates: rank() <= CAST(100 AS BIGINT)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=22,21 row-size=100B cardinality=200 cost=200
|  in pipelines: 19(GETNEXT)
|
10:ANALYTIC
|  functions: rank()
|  partition by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END
|  order by: aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END) DESC
|  window: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,21 row-size=100B cardinality=200 cost=200
|  in pipelines: 19(GETNEXT)
|
19:TOP-N
|  order by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END ASC NULLS LAST, aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END) DESC NULLS FIRST
|  limit with ties: 200
|  mem-estimate=17.97KB mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=92B cardinality=200 cost=861
|  in pipelines: 19(GETNEXT), 09(OPEN)
|
18:EXCHANGE [HASH(CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END)]
|  mem-estimate=1.28MB mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=92B cardinality=200 cost=106
|  in pipelines: 09(GETNEXT)
|
F04:PLAN FRAGMENT [HASH(CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 13 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 15 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 13 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 13 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_qoy) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_qoy) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_qoy) WHEN 11 THEN murmur_hash(NULL) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_moy) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_moy) WHEN 10 THEN murmur_hash(NULL) WHEN 11 THEN murmur_hash(NULL) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.store.s_store_id) WHEN 9 THEN murmur_hash(NULL) WHEN 10 THEN murmur_hash(NULL) WHEN 11 THEN murmur_hash(NULL) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END)] hosts=10 instances=70 (adjusted from 120)
Per-Instance Resources: mem-estimate=7.14GB mem-reservation=244.75MB thread-reservation=1
max-parallelism=26630 segment-costs=[266227423359, 73050686125, 233936768446, 1288] cpu-comparison-result=120 [max(70 (self) vs 120 (sum children))]
09:TOP-N
|  order by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 9 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 10 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 11 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 12 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 13 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 14 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_category WHEN 16 THEN NULL END ASC NULLS LAST, aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (8, 9, 10, 11, 12, 13, 14, 15, 16), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 9 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 10 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 11 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 12 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 13 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 14 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 15 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN 16 THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END) DESC NULLS FIRST
|  limit with ties: 200
|  source expr: rank() <= CAST(100 AS BIGINT)
|  mem-estimate=17.97KB mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=92B cardinality=200 cost=233936768446
|  in pipelines: 09(GETNEXT), 08(OPEN)
|
08:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(16,8,9,10,11,12,13,14,15) IN (CAST(8 AS INT), CAST(9 AS INT), CAST(10 AS INT), CAST(11 AS INT), CAST(12 AS INT), CAST(13 AS INT), CAST(14 AS INT), CAST(15 AS INT), CAST(16 AS INT)), CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(9 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(10 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(11 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(12 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(13 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(14 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(15 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) WHEN CAST(16 AS INT) THEN sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0)) END)
|  group by: CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(12 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(13 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(14 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_category WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(12 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(13 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(14 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_class WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(12 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(13 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_brand WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(12 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_product_name WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN CAST(11 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_year WHEN CAST(12 AS INT) THEN NULL WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN CAST(10 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_qoy WHEN CAST(11 AS INT) THEN NULL WHEN CAST(12 AS INT) THEN NULL WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN CAST(9 AS INT) THEN tpcds_partitioned_parquet_snap.date_dim.d_moy WHEN CAST(10 AS INT) THEN NULL WHEN CAST(11 AS INT) THEN NULL WHEN CAST(12 AS INT) THEN NULL WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN tpcds_partitioned_parquet_snap.store.s_store_id WHEN CAST(9 AS INT) THEN NULL WHEN CAST(10 AS INT) THEN NULL WHEN CAST(11 AS INT) THEN NULL WHEN CAST(12 AS INT) THEN NULL WHEN CAST(13 AS INT) THEN NULL WHEN CAST(14 AS INT) THEN NULL WHEN CAST(15 AS INT) THEN NULL WHEN CAST(16 AS INT) THEN NULL END, CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN CAST(8 AS INT) THEN CAST(8 AS INT) WHEN CAST(9 AS INT) THEN CAST(9 AS INT) WHEN CAST(10 AS INT) THEN CAST(10 AS INT) WHEN CAST(11 AS INT) THEN CAST(11 AS INT) WHEN CAST(12 AS INT) THEN CAST(12 AS INT) WHEN CAST(13 AS INT) THEN CAST(13 AS INT) WHEN CAST(14 AS INT) THEN CAST(14 AS INT) WHEN CAST(15 AS INT) THEN CAST(15 AS INT) WHEN CAST(16 AS INT) THEN CAST(16 AS INT) END
|  mem-estimate=578.50MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=17 row-size=92B cardinality=12.38G cost=73050686125
|  in pipelines: 08(GETNEXT), 17(OPEN)
|
17:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, tpcds_partitioned_parquet_snap.date_dim.d_moy, tpcds_partitioned_parquet_snap.store.s_store_id
|  Class 1
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, tpcds_partitioned_parquet_snap.date_dim.d_moy, NULL
|  Class 2
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, NULL, NULL
|  Class 3
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, NULL, NULL, NULL, NULL
|  Class 5
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, NULL, NULL, NULL, NULL, NULL
|  Class 6
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, NULL, NULL, NULL, NULL, NULL, NULL
|  Class 7
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, NULL, NULL, NULL, NULL, NULL, NULL, NULL
|  Class 8
|    output: sum:merge(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, tpcds_partitioned_parquet_snap.store_sales.ss_quantity), 0))
|    group by: NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
|  mem-estimate=6.57GB mem-reservation=210.75MB thread-reservation=0
|  tuple-ids=8N,9N,10N,11N,12N,13N,14N,15N,16N row-size=1.09KB cardinality=12.38G cost=97683994945
|  in pipelines: 17(GETNEXT), 00(OPEN)
|
16:EXCHANGE [HASH(CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 13 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 15 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_category) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 13 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_class) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 13 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_brand) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 12 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_product_name) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 11 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_year) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_qoy) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_qoy) WHEN 10 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_qoy) WHEN 11 THEN murmur_hash(NULL) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_moy) WHEN 9 THEN murmur_hash(tpcds_partitioned_parquet_snap.date_dim.d_moy) WHEN 10 THEN murmur_hash(NULL) WHEN 11 THEN murmur_hash(NULL) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END,CASE valid_tid(16,8,9,10,11,12,13,14,15) WHEN 8 THEN murmur_hash(tpcds_partitioned_parquet_snap.store.s_store_id) WHEN 9 THEN murmur_hash(NULL) WHEN 10 THEN murmur_hash(NULL) WHEN 11 THEN murmur_hash(NULL) WHEN 12 THEN murmur_hash(NULL) WHEN 13 THEN murmur_hash(NULL) WHEN 14 THEN murmur_hash(NULL) WHEN 15 THEN murmur_hash(NULL) WHEN 16 THEN murmur_hash(NULL) END)]
|  mem-estimate=145.58MB mem-reservation=0B thread-reservation=0
|  tuple-ids=8N,9N,10N,11N,12N,13N,14N,15N,16N row-size=1.09KB cardinality=30.30G cost=168543428414
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
Per-Instance Resources: mem-estimate=4.49GB mem-reservation=219.00MB thread-reservation=1
max-parallelism=1824 segment-costs=[257851731293, 2328086935759] cpu-comparison-result=120 [max(120 (self) vs 36 (sum children))]
07:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, tpcds_partitioned_parquet_snap.date_dim.d_moy, tpcds_partitioned_parquet_snap.store.s_store_id
|  Class 1
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, tpcds_partitioned_parquet_snap.date_dim.d_moy, NULL
|  Class 2
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, tpcds_partitioned_parquet_snap.date_dim.d_qoy, NULL, NULL
|  Class 3
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, tpcds_partitioned_parquet_snap.date_dim.d_year, NULL, NULL, NULL
|  Class 4
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, tpcds_partitioned_parquet_snap.item.i_product_name, NULL, NULL, NULL, NULL
|  Class 5
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, tpcds_partitioned_parquet_snap.item.i_brand, NULL, NULL, NULL, NULL, NULL
|  Class 6
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, tpcds_partitioned_parquet_snap.item.i_class, NULL, NULL, NULL, NULL, NULL, NULL
|  Class 7
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: tpcds_partitioned_parquet_snap.item.i_category, NULL, NULL, NULL, NULL, NULL, NULL, NULL
|  Class 8
|    output: sum(coalesce(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_sales_price, CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0))), CAST(0 AS DECIMAL(18,2))))
|    group by: NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
|  mem-estimate=4.17GB mem-reservation=211.00MB thread-reservation=0
|  tuple-ids=8N,9N,10N,11N,12N,13N,14N,15N,16N row-size=1.09KB cardinality=30.30G cost=244022435997
|  in pipelines: 00(GETNEXT)
|
06:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=00
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4,6 row-size=177B cardinality=8.64G cost=3779809729
|  in pipelines: 00(GETNEXT), 05(OPEN)
|
|--F07:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=419.42MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  15:EXCHANGE [BROADCAST]
|  |  mem-estimate=10.42MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=6 row-size=105B cardinality=360.00K cost=478440
|  |  in pipelines: 05(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=16.42MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[403500]
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=6 row-size=105B cardinality=360.00K cost=293952
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=01
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,4 row-size=72B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  in pipelines: 00(GETNEXT), 03(OPEN)
|
|--F08:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=24.41MB mem-reservation=24.25MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[17005]
|  JOIN BUILD
|  |  join-table-id=01 plan-id=02 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |
|  14:EXCHANGE [BROADCAST]
|  |  mem-estimate=166.68KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=4 row-size=20B cardinality=7.30K cost=9700
|  |  in pipelines: 03(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=1.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[25695]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_month_seq <= add(CAST(1196 AS INT), CAST(11 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_month_seq >= CAST(1196 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_month_seq <= add(CAST(1196 AS INT), CAST(11 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_month_seq >= CAST(1196 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_month_seq <= add(CAST(1196 AS INT), CAST(11 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_month_seq >= CAST(1196 AS INT)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=4 row-size=20B cardinality=7.30K cost=25143
|     in pipelines: 03(GETNEXT)
|
02:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=02
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk = tpcds_partitioned_parquet_snap.store.s_store_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk = tpcds_partitioned_parquet_snap.store.s_store_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=52B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--F09:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=24.33MB mem-reservation=24.25MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[3140]
|  JOIN BUILD
|  |  join-table-id=02 plan-id=03 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.store.s_store_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.store.s_store_sk, RF005[min_max] <- tpcds_partitioned_parquet_snap.store.s_store_sk
|  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=1350
|  |
|  13:EXCHANGE [BROADCAST]
|  |  mem-estimate=78.19KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=32B cardinality=1.35K cost=1790
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.14MB mem-reservation=16.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[533]
|  01:SCAN HDFS [tpcds_partitioned_parquet_snap.store, RANDOM]
|     HDFS partitions=1/1 files=1 size=119.76KB
|     stored statistics:
|       table: rows=1.35K size=119.76KB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1.35K
|     mem-estimate=16.00MB mem-reservation=16.00KB thread-reservation=0
|     tuple-ids=2 row-size=32B cardinality=1.35K cost=388
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF005[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_store_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_store_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=20B cardinality=8.64G(filtered from 8.64G) cost=2488301335
   in pipelines: 00(GETNEXT)
====
