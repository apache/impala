# TPCDS-Q18
# start query 18 in stream 0 using template query18.tpl using seed 695118601
select  i_item_id,
        ca_country,
        ca_state,
        ca_county,
        avg( cast(cs_quantity as decimal(12,2))) agg1,
        avg( cast(cs_list_price as decimal(12,2))) agg2,
        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,
        avg( cast(cs_sales_price as decimal(12,2))) agg4,
        avg( cast(cs_net_profit as decimal(12,2))) agg5,
        avg( cast(c_birth_year as decimal(12,2))) agg6,
        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7
 from catalog_sales, customer_demographics cd1,
      customer_demographics cd2, customer, customer_address, date_dim, item
 where cs_sold_date_sk = d_date_sk and
       cs_item_sk = i_item_sk and
       cs_bill_cdemo_sk = cd1.cd_demo_sk and
       cs_bill_customer_sk = c_customer_sk and
       cd1.cd_gender = 'F' and
       cd1.cd_education_status = 'Primary' and
       c_current_cdemo_sk = cd2.cd_demo_sk and
       c_current_addr_sk = ca_address_sk and
       c_birth_month in (6,7,3,11,12,8) and
       d_year = 1999 and
       ca_state in ('IL','WV','KS'
                   ,'GA','LA','PA','TX')
 group by rollup (i_item_id, ca_country, ca_state, ca_county)
 order by ca_country,
        ca_state,
        ca_county,
	i_item_id
 limit 100

# end query 18 in stream 0 using template query18.tpl
---- PLAN
Max Per-Host Resource Reservation: Memory=234.12MB Threads=1
Per-Host Resource Estimates: Memory=2.94GB
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=2.94GB mem-reservation=234.12MB thread-reservation=1 runtime-filters-memory=9.00MB
|  max-parallelism=1 segment-costs=[1034898985, 48223089, 98313230, 1100]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 17 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 19 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 21 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 23 THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 19 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 21 THEN NULL WHEN 23 THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_county WHEN 17 THEN NULL WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END, aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=1100
|
15:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 19 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_county WHEN 17 THEN NULL WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 17 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 19 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 21 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 23 THEN NULL END ASC NULLS LAST
|  mem-estimate=10.16KB mem-reservation=0B thread-reservation=0
|  tuple-ids=25 row-size=104B cardinality=100 cost=98313230
|  in pipelines: 15(GETNEXT), 14(OPEN)
|
14:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) END)
|  group by: CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN CAST(17 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN CAST(19 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN CAST(21 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN CAST(23 AS INT) THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN CAST(17 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN CAST(19 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN CAST(21 AS INT) THEN NULL WHEN CAST(23 AS INT) THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN CAST(17 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN CAST(19 AS INT) THEN NULL WHEN CAST(21 AS INT) THEN NULL WHEN CAST(23 AS INT) THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_county WHEN CAST(17 AS INT) THEN NULL WHEN CAST(19 AS INT) THEN NULL WHEN CAST(21 AS INT) THEN NULL WHEN CAST(23 AS INT) THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN CAST(15 AS INT) WHEN CAST(17 AS INT) THEN CAST(17 AS INT) WHEN CAST(19 AS INT) THEN CAST(19 AS INT) WHEN CAST(21 AS INT) THEN CAST(21 AS INT) WHEN CAST(23 AS INT) THEN CAST(23 AS INT) END
|  mem-estimate=534.55MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=24 row-size=108B cardinality=7.63M cost=48223089
|  in pipelines: 14(GETNEXT), 13(OPEN)
|
13:AGGREGATE [FINALIZE]
|  Class 0
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, tpcds_partitioned_parquet_snap.customer_address.ca_state, tpcds_partitioned_parquet_snap.customer_address.ca_county
|  Class 1
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, tpcds_partitioned_parquet_snap.customer_address.ca_state, NULL
|  Class 2
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, NULL, NULL
|  Class 3
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, NULL, NULL, NULL
|  Class 4
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=2.41GB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=14N,16N,18N,20N,22N row-size=641B cardinality=7.63M cost=87976202
|  in pipelines: 13(GETNEXT), 00(OPEN)
|
12:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  mem-estimate=247.12MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4,6,8,10,12 row-size=212B cardinality=5.96M cost=25557752
|  in pipelines: 00(GETNEXT), 07(OPEN)
|
|--11:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk = tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk = tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|  |  runtime filters: RF008[bloom] <- tpcds_partitioned_parquet_snap.customer_address.ca_address_sk, RF009[min_max] <- tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|  |  mem-estimate=183.40MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=8,10,12 row-size=93B cardinality=2.25M cost=3653275
|  |  in pipelines: 07(GETNEXT), 10(OPEN)
|  |
|  |--10:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_address]
|  |     HDFS partitions=1/1 files=1 size=307.36MB
|  |     predicates: tpcds_partitioned_parquet_snap.customer_address.ca_state IN ('GA', 'IL', 'KS', 'LA', 'PA', 'TX', 'WV'), tpcds_partitioned_parquet_snap.customer_address.ca_address_sk IS NOT NULL
|  |     stored statistics:
|  |       table: rows=15.00M size=307.36MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1.58M
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.customer_address.ca_state IN ('GA', 'IL', 'KS', 'LA', 'PA', 'TX', 'WV')
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer_address.ca_state IN ('GA', 'IL', 'KS', 'LA', 'PA', 'TX', 'WV'), tpcds_partitioned_parquet_snap.customer_address.ca_address_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=12 row-size=69B cardinality=2.06M cost=7962659
|  |     in pipelines: 10(GETNEXT)
|  |
|  09:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk = tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk = tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk
|  |  runtime filters: RF010[bloom] <- tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk, RF011[min_max] <- tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk
|  |  mem-estimate=55.33MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=8,10 row-size=24B cardinality=4.63M(filtered from 14.55M) cost=5745593
|  |  in pipelines: 07(GETNEXT), 08(OPEN)
|  |
|  |--08:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_demographics]
|  |     HDFS partitions=1/1 files=1 size=11.15MB
|  |     predicates: tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk IS NOT NULL
|  |     stored statistics:
|  |       table: rows=1.92M size=11.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=197.97K
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=10 row-size=4B cardinality=1.92M cost=164612
|  |     in pipelines: 08(GETNEXT)
|  |
|  07:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|     HDFS partitions=1/1 files=1 size=1.55GB
|     predicates: tpcds_partitioned_parquet_snap.customer.c_birth_month IN (CAST(3 AS INT), CAST(6 AS INT), CAST(7 AS INT), CAST(8 AS INT), CAST(11 AS INT), CAST(12 AS INT)), tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_customer_sk IS NOT NULL
|     runtime filters: RF009[min_max] -> tpcds_partitioned_parquet_snap.customer.c_current_addr_sk, RF011[min_max] -> tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk, RF008[bloom] -> tpcds_partitioned_parquet_snap.customer.c_current_addr_sk, RF010[bloom] -> tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk
|     stored statistics:
|       table: rows=30.00M size=1.55GB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.10M
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.customer.c_birth_month IN (CAST(3 AS INT), CAST(6 AS INT), CAST(7 AS INT), CAST(8 AS INT), CAST(11 AS INT), CAST(12 AS INT))
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer.c_birth_month IN (CAST(3 AS INT), CAST(6 AS INT), CAST(7 AS INT), CAST(8 AS INT), CAST(11 AS INT), CAST(12 AS INT)), tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_customer_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=8 row-size=20B cardinality=4.63M(filtered from 14.74M) cost=12012000
|     in pipelines: 07(GETNEXT)
|
06:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF003[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4,6 row-size=119B cardinality=86.68M cost=38309048
|  in pipelines: 00(GETNEXT), 05(OPEN)
|
|--05:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IS NOT NULL
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=6 row-size=32B cardinality=360.00K cost=113796
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk = tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk = tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk
|  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk, RF005[min_max] <- tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk
|  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0
|  tuple-ids=0,2,4 row-size=87B cardinality=86.72M cost=91684580
|  in pipelines: 00(GETNEXT), 03(OPEN)
|
|--03:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_demographics]
|     HDFS partitions=1/1 files=1 size=11.15MB
|     predicates: tpcds_partitioned_parquet_snap.customer_demographics.cd_education_status = 'Primary', tpcds_partitioned_parquet_snap.customer_demographics.cd_gender = 'F', tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk IS NOT NULL
|     stored statistics:
|       table: rows=1.92M size=11.15MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=197.97K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.customer_demographics.cd_education_status = 'Primary', tpcds_partitioned_parquet_snap.customer_demographics.cd_gender = 'F'
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer_demographics.cd_education_status = 'Primary', tpcds_partitioned_parquet_snap.customer_demographics.cd_gender = 'F', tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=4 row-size=43B cardinality=194.03K cost=675600
|     in pipelines: 03(GETNEXT)
|
02:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=44B cardinality=295.43M(filtered from 869.12M) cost=233261294
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=8B cardinality=373 cost=12520
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
   partition predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk IS NOT NULL
   HDFS partitions=1830/1831 files=1830 size=280.81GB
   predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk IS NOT NULL, tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk IS NOT NULL, tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk IS NOT NULL
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk, RF005[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk, RF003[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk, RF006[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk
   stored statistics:
     table: rows=4.32G size=280.96GB
     partitions: 1830/1830 rows=4.30G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=5.09M est-scan-range=373(filtered from 1830)
   parquet dictionary predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk IS NOT NULL, tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk IS NOT NULL, tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk IS NOT NULL
   mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
   tuple-ids=0 row-size=36B cardinality=295.43M(filtered from 4.27G) cost=527770054
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
Max Per-Host Resource Reservation: Memory=2.85GB Threads=27
Per-Host Resource Estimates: Memory=4.84GB
F09:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.21MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[1146] cpu-comparison-result=110 [max(1 (self) vs 110 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 17 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 19 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 21 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 23 THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 19 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 21 THEN NULL WHEN 23 THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_county WHEN 17 THEN NULL WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END, aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=1100
|
25:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 19 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_county WHEN 17 THEN NULL WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 17 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 19 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 21 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 23 THEN NULL END ASC NULLS LAST
|  limit: 100
|  mem-estimate=211.95KB mem-reservation=0B thread-reservation=0
|  tuple-ids=25 row-size=104B cardinality=100 cost=46
|  in pipelines: 15(GETNEXT)
|
F08:PLAN FRAGMENT [HASH(CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 16 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 18 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 20 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 22 THEN murmur_hash(NULL) END,CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_country) WHEN 16 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_country) WHEN 18 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_country) WHEN 20 THEN murmur_hash(NULL) WHEN 22 THEN murmur_hash(NULL) END,CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_state) WHEN 16 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_state) WHEN 18 THEN murmur_hash(NULL) WHEN 20 THEN murmur_hash(NULL) WHEN 22 THEN murmur_hash(NULL) END,CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_county) WHEN 16 THEN murmur_hash(NULL) WHEN 18 THEN murmur_hash(NULL) WHEN 20 THEN murmur_hash(NULL) WHEN 22 THEN murmur_hash(NULL) END)] hosts=10 instances=20 (adjusted from 120)
Per-Instance Resources: mem-estimate=689.57MB mem-reservation=171.94MB thread-reservation=1
max-parallelism=20 segment-costs=[145835006, 48223089, 98313230, 303] cpu-comparison-result=110 [max(20 (self) vs 110 (sum children))]
15:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 19 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_county WHEN 17 THEN NULL WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 17 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 19 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 21 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 23 THEN NULL END ASC NULLS LAST
|  mem-estimate=10.16KB mem-reservation=0B thread-reservation=0
|  tuple-ids=25 row-size=104B cardinality=100 cost=98313230
|  in pipelines: 15(GETNEXT), 14(OPEN)
|
14:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) END)
|  group by: CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN CAST(17 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN CAST(19 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN CAST(21 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN CAST(23 AS INT) THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN CAST(17 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN CAST(19 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN CAST(21 AS INT) THEN NULL WHEN CAST(23 AS INT) THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN CAST(17 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN CAST(19 AS INT) THEN NULL WHEN CAST(21 AS INT) THEN NULL WHEN CAST(23 AS INT) THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_county WHEN CAST(17 AS INT) THEN NULL WHEN CAST(19 AS INT) THEN NULL WHEN CAST(21 AS INT) THEN NULL WHEN CAST(23 AS INT) THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN CAST(15 AS INT) WHEN CAST(17 AS INT) THEN CAST(17 AS INT) WHEN CAST(19 AS INT) THEN CAST(19 AS INT) WHEN CAST(21 AS INT) THEN CAST(21 AS INT) WHEN CAST(23 AS INT) THEN CAST(23 AS INT) END
|  mem-estimate=43.64MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=24 row-size=108B cardinality=7.63M cost=48223089
|  in pipelines: 14(GETNEXT), 24(OPEN)
|
24:AGGREGATE [FINALIZE]
|  Class 0
|    output: avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit), avg:merge(tpcds_partitioned_parquet_snap.customer.c_birth_year), avg:merge(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count)
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, tpcds_partitioned_parquet_snap.customer_address.ca_state, tpcds_partitioned_parquet_snap.customer_address.ca_county
|  Class 1
|    output: avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit), avg:merge(tpcds_partitioned_parquet_snap.customer.c_birth_year), avg:merge(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count)
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, tpcds_partitioned_parquet_snap.customer_address.ca_state, NULL
|  Class 2
|    output: avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit), avg:merge(tpcds_partitioned_parquet_snap.customer.c_birth_year), avg:merge(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count)
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, NULL, NULL
|  Class 3
|    output: avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit), avg:merge(tpcds_partitioned_parquet_snap.customer.c_birth_year), avg:merge(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count)
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, NULL, NULL, NULL
|  Class 4
|    output: avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit), avg:merge(tpcds_partitioned_parquet_snap.customer.c_birth_year), avg:merge(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=608.57MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=15N,17N,19N,21N,23N row-size=641B cardinality=7.63M cost=74467863
|  in pipelines: 24(GETNEXT), 00(OPEN)
|
23:EXCHANGE [HASH(CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 16 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 18 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 20 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 22 THEN murmur_hash(NULL) END,CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_country) WHEN 16 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_country) WHEN 18 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_country) WHEN 20 THEN murmur_hash(NULL) WHEN 22 THEN murmur_hash(NULL) END,CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_state) WHEN 16 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_state) WHEN 18 THEN murmur_hash(NULL) WHEN 20 THEN murmur_hash(NULL) WHEN 22 THEN murmur_hash(NULL) END,CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_county) WHEN 16 THEN murmur_hash(NULL) WHEN 18 THEN murmur_hash(NULL) WHEN 20 THEN murmur_hash(NULL) WHEN 22 THEN murmur_hash(NULL) END)]
|  mem-estimate=81.00MB mem-reservation=0B thread-reservation=0
|  tuple-ids=14N,16N,18N,20N,22N row-size=641B cardinality=22.26M cost=71367143
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=110 (adjusted from 120)
Per-Host Shared Resources: mem-estimate=5.00MB mem-reservation=5.00MB thread-reservation=0 runtime-filters-memory=5.00MB
Per-Instance Resources: mem-estimate=213.64MB mem-reservation=138.25MB thread-reservation=1
max-parallelism=110 segment-costs=[1068003099, 975989858] cpu-comparison-result=110 [max(110 (self) vs 85 (sum children))]
13:AGGREGATE [STREAMING]
|  Class 0
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, tpcds_partitioned_parquet_snap.customer_address.ca_state, tpcds_partitioned_parquet_snap.customer_address.ca_county
|  Class 1
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, tpcds_partitioned_parquet_snap.customer_address.ca_state, NULL
|  Class 2
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, NULL, NULL
|  Class 3
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, NULL, NULL, NULL
|  Class 4
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=146.00MB mem-reservation=138.00MB thread-reservation=0
|  tuple-ids=14N,16N,18N,20N,22N row-size=641B cardinality=22.26M cost=154220821
|  in pipelines: 00(GETNEXT)
|
12:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=00
|  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4,6,8,10,12 row-size=212B cardinality=5.96M cost=23311705
|  in pipelines: 00(GETNEXT), 07(OPEN)
|
|--F10:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=387.03MB mem-reservation=376.00MB thread-reservation=1 runtime-filters-memory=2.00MB
|  |  max-parallelism=10 segment-costs=[5231037] cpu-comparison-result=40 [max(30 (self) vs 40 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  |  mem-estimate=374.00MB mem-reservation=374.00MB spill-buffer=2.00MB thread-reservation=0 cost=2246047
|  |
|  22:EXCHANGE [BROADCAST]
|  |  mem-estimate=11.03MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=8,10,12 row-size=93B cardinality=2.25M cost=2984990
|  |  in pipelines: 07(GETNEXT)
|  |
|  F07:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)] hosts=10 instances=10
|  Per-Instance Resources: mem-estimate=10.72MB mem-reservation=0B thread-reservation=1
|  max-parallelism=10 segment-costs=[3499543]
|  11:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk = tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk = tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=8,10,12 row-size=93B cardinality=2.25M cost=1594451
|  |  in pipelines: 07(GETNEXT), 10(OPEN)
|  |
|  |--F11:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=46.71MB mem-reservation=36.00MB thread-reservation=1 runtime-filters-memory=2.00MB
|  |  |  max-parallelism=10 segment-costs=[2940664]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|  |  |  runtime filters: RF008[bloom] <- tpcds_partitioned_parquet_snap.customer_address.ca_address_sk, RF009[min_max] <- tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=2058824
|  |  |
|  |  21:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_address.ca_address_sk)]
|  |  |  mem-estimate=10.71MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=12 row-size=69B cardinality=2.06M cost=881840
|  |  |  in pipelines: 10(GETNEXT)
|  |  |
|  |  F06:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=18.85MB mem-reservation=128.00KB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[18166835]
|  |  10:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_address, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=307.36MB
|  |     predicates: tpcds_partitioned_parquet_snap.customer_address.ca_state IN ('GA', 'IL', 'KS', 'LA', 'PA', 'TX', 'WV'), tpcds_partitioned_parquet_snap.customer_address.ca_address_sk IS NOT NULL
|  |     stored statistics:
|  |       table: rows=15.00M size=307.36MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1.58M
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.customer_address.ca_state IN ('GA', 'IL', 'KS', 'LA', 'PA', 'TX', 'WV')
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer_address.ca_state IN ('GA', 'IL', 'KS', 'LA', 'PA', 'TX', 'WV'), tpcds_partitioned_parquet_snap.customer_address.ca_address_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=12 row-size=69B cardinality=2.06M cost=7962659
|  |     in pipelines: 10(GETNEXT)
|  |
|  20:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)]
|  |  mem-estimate=10.31MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=8,10 row-size=24B cardinality=4.63M(filtered from 14.55M) cost=1195800
|  |  in pipelines: 07(GETNEXT)
|  |
|  F04:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  Per-Host Shared Resources: mem-estimate=4.00MB mem-reservation=4.00MB thread-reservation=0 runtime-filters-memory=4.00MB
|  Per-Instance Resources: mem-estimate=17.25MB mem-reservation=1.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[27762395]
|  09:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=02
|  |  hash predicates: tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk = tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk = tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=8,10 row-size=24B cardinality=4.63M(filtered from 14.55M) cost=3824793
|  |  in pipelines: 07(GETNEXT), 08(OPEN)
|  |
|  |--F12:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=64.73MB mem-reservation=36.00MB thread-reservation=1 runtime-filters-memory=2.00MB
|  |  |  max-parallelism=10 segment-costs=[4473540]
|  |  JOIN BUILD
|  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk
|  |  |  runtime filters: RF010[bloom] <- tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk, RF011[min_max] <- tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk
|  |  |  mem-estimate=55.33MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=1920800
|  |  |
|  |  19:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=7.41MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=10 row-size=4B cardinality=1.92M cost=2552740
|  |  |  in pipelines: 08(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.03MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[226845]
|  |  08:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_demographics, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=11.15MB
|  |     predicates: tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk IS NOT NULL
|  |     stored statistics:
|  |       table: rows=1.92M size=11.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=197.97K
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=10 row-size=4B cardinality=1.92M cost=164612
|  |     in pipelines: 08(GETNEXT)
|  |
|  07:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|     HDFS partitions=1/1 files=1 size=1.55GB
|     predicates: tpcds_partitioned_parquet_snap.customer.c_birth_month IN (CAST(3 AS INT), CAST(6 AS INT), CAST(7 AS INT), CAST(8 AS INT), CAST(11 AS INT), CAST(12 AS INT)), tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_customer_sk IS NOT NULL
|     runtime filters: RF009[min_max] -> tpcds_partitioned_parquet_snap.customer.c_current_addr_sk, RF011[min_max] -> tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk, RF008[bloom] -> tpcds_partitioned_parquet_snap.customer.c_current_addr_sk, RF010[bloom] -> tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk
|     stored statistics:
|       table: rows=30.00M size=1.55GB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.10M
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.customer.c_birth_month IN (CAST(3 AS INT), CAST(6 AS INT), CAST(7 AS INT), CAST(8 AS INT), CAST(11 AS INT), CAST(12 AS INT))
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer.c_birth_month IN (CAST(3 AS INT), CAST(6 AS INT), CAST(7 AS INT), CAST(8 AS INT), CAST(11 AS INT), CAST(12 AS INT)), tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_customer_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=8 row-size=20B cardinality=4.63M(filtered from 14.74M) cost=12012000
|     in pipelines: 07(GETNEXT)
|
06:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=03
|  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4,6 row-size=119B cardinality=86.68M cost=37949048
|  in pipelines: 00(GETNEXT), 05(OPEN)
|
|--F13:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=385.14MB mem-reservation=375.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=03 plan-id=04 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF003[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=374.00MB mem-reservation=374.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  18:EXCHANGE [BROADCAST]
|  |  mem-estimate=10.14MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=6 row-size=32B cardinality=360.00K cost=478440
|  |  in pipelines: 05(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=16.14MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[152676]
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IS NOT NULL
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=6 row-size=32B cardinality=360.00K cost=113796
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=04
|  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk = tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk = tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  tuple-ids=0,2,4 row-size=87B cardinality=86.72M cost=91490550
|  in pipelines: 00(GETNEXT), 03(OPEN)
|
|--F14:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=196.33MB mem-reservation=188.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[451890]
|  JOIN BUILD
|  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk, RF005[min_max] <- tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk
|  |  mem-estimate=187.00MB mem-reservation=187.00MB spill-buffer=1.00MB thread-reservation=0 cost=194030
|  |
|  17:EXCHANGE [BROADCAST]
|  |  mem-estimate=8.33MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=4 row-size=43B cardinality=194.03K cost=257860
|  |  in pipelines: 03(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  Per-Instance Resources: mem-estimate=16.18MB mem-reservation=1.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[702093]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_demographics, RANDOM]
|     HDFS partitions=1/1 files=1 size=11.15MB
|     predicates: tpcds_partitioned_parquet_snap.customer_demographics.cd_education_status = 'Primary', tpcds_partitioned_parquet_snap.customer_demographics.cd_gender = 'F', tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk IS NOT NULL
|     stored statistics:
|       table: rows=1.92M size=11.15MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=197.97K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.customer_demographics.cd_education_status = 'Primary', tpcds_partitioned_parquet_snap.customer_demographics.cd_gender = 'F'
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer_demographics.cd_education_status = 'Primary', tpcds_partitioned_parquet_snap.customer_demographics.cd_gender = 'F', tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=4 row-size=43B cardinality=194.03K cost=675600
|     in pipelines: 03(GETNEXT)
|
02:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=05
|  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=44B cardinality=295.43M(filtered from 869.12M) cost=233260921
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--F15:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=22.33MB mem-reservation=22.31MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[863]
|  JOIN BUILD
|  |  join-table-id=05 plan-id=06 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=373
|  |
|  16:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=8B cardinality=373 cost=490
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[12536]
|  01:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=8B cardinality=373 cost=12520
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
   partition predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk IS NOT NULL
   HDFS partitions=1830/1831 files=1830 size=280.81GB
   predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk IS NOT NULL, tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk IS NOT NULL, tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk IS NOT NULL
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk, RF005[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk, RF003[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk, RF006[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk
   stored statistics:
     table: rows=4.32G size=280.96GB
     partitions: 1830/1830 rows=4.30G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=5.09M est-scan-range=373(filtered from 1830)
   parquet dictionary predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk IS NOT NULL, tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk IS NOT NULL, tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk IS NOT NULL
   mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
   tuple-ids=0 row-size=36B cardinality=295.43M(filtered from 4.27G) cost=527770054
   in pipelines: 00(GETNEXT)
---- PARALLELPLANS
Max Per-Host Resource Reservation: Memory=2.85GB Threads=27
Per-Host Resource Estimates: Memory=4.84GB
F09:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.21MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[1146] cpu-comparison-result=110 [max(1 (self) vs 110 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 17 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 19 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 21 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 23 THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 19 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 21 THEN NULL WHEN 23 THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_county WHEN 17 THEN NULL WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END, aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) END), aggif(valid_tid(17,19,21,23,15) IN (15, 17, 19, 21, 23), CASE valid_tid(17,19,21,23,15) WHEN 15 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN 17 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN 19 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN 21 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN 23 THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=1100
|
25:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 19 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_county WHEN 17 THEN NULL WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 17 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 19 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 21 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 23 THEN NULL END ASC NULLS LAST
|  limit: 100
|  mem-estimate=211.95KB mem-reservation=0B thread-reservation=0
|  tuple-ids=25 row-size=104B cardinality=100 cost=46
|  in pipelines: 15(GETNEXT)
|
F08:PLAN FRAGMENT [HASH(CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 16 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 18 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 20 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 22 THEN murmur_hash(NULL) END,CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_country) WHEN 16 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_country) WHEN 18 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_country) WHEN 20 THEN murmur_hash(NULL) WHEN 22 THEN murmur_hash(NULL) END,CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_state) WHEN 16 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_state) WHEN 18 THEN murmur_hash(NULL) WHEN 20 THEN murmur_hash(NULL) WHEN 22 THEN murmur_hash(NULL) END,CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_county) WHEN 16 THEN murmur_hash(NULL) WHEN 18 THEN murmur_hash(NULL) WHEN 20 THEN murmur_hash(NULL) WHEN 22 THEN murmur_hash(NULL) END)] hosts=10 instances=20 (adjusted from 120)
Per-Instance Resources: mem-estimate=689.57MB mem-reservation=171.94MB thread-reservation=1
max-parallelism=20 segment-costs=[145835006, 48223089, 98313230, 303] cpu-comparison-result=110 [max(20 (self) vs 110 (sum children))]
15:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 19 THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 17 THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.customer_address.ca_county WHEN 17 THEN NULL WHEN 19 THEN NULL WHEN 21 THEN NULL WHEN 23 THEN NULL END ASC NULLS LAST, CASE valid_tid(17,19,21,23,15) WHEN 15 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 17 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 19 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 21 THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN 23 THEN NULL END ASC NULLS LAST
|  mem-estimate=10.16KB mem-reservation=0B thread-reservation=0
|  tuple-ids=25 row-size=104B cardinality=100 cost=98313230
|  in pipelines: 15(GETNEXT), 14(OPEN)
|
14:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer.c_birth_year) END), aggif(valid_tid(17,19,21,23,15) IN (CAST(15 AS INT), CAST(17 AS INT), CAST(19 AS INT), CAST(21 AS INT), CAST(23 AS INT)), CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN CAST(17 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN CAST(19 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN CAST(21 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) WHEN CAST(23 AS INT) THEN avg(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count) END)
|  group by: CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN CAST(17 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN CAST(19 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN CAST(21 AS INT) THEN tpcds_partitioned_parquet_snap.item.i_item_id WHEN CAST(23 AS INT) THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN CAST(17 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN CAST(19 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_country WHEN CAST(21 AS INT) THEN NULL WHEN CAST(23 AS INT) THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN CAST(17 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_state WHEN CAST(19 AS INT) THEN NULL WHEN CAST(21 AS INT) THEN NULL WHEN CAST(23 AS INT) THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN tpcds_partitioned_parquet_snap.customer_address.ca_county WHEN CAST(17 AS INT) THEN NULL WHEN CAST(19 AS INT) THEN NULL WHEN CAST(21 AS INT) THEN NULL WHEN CAST(23 AS INT) THEN NULL END, CASE valid_tid(17,19,21,23,15) WHEN CAST(15 AS INT) THEN CAST(15 AS INT) WHEN CAST(17 AS INT) THEN CAST(17 AS INT) WHEN CAST(19 AS INT) THEN CAST(19 AS INT) WHEN CAST(21 AS INT) THEN CAST(21 AS INT) WHEN CAST(23 AS INT) THEN CAST(23 AS INT) END
|  mem-estimate=43.64MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=24 row-size=108B cardinality=7.63M cost=48223089
|  in pipelines: 14(GETNEXT), 24(OPEN)
|
24:AGGREGATE [FINALIZE]
|  Class 0
|    output: avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit), avg:merge(tpcds_partitioned_parquet_snap.customer.c_birth_year), avg:merge(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count)
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, tpcds_partitioned_parquet_snap.customer_address.ca_state, tpcds_partitioned_parquet_snap.customer_address.ca_county
|  Class 1
|    output: avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit), avg:merge(tpcds_partitioned_parquet_snap.customer.c_birth_year), avg:merge(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count)
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, tpcds_partitioned_parquet_snap.customer_address.ca_state, NULL
|  Class 2
|    output: avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit), avg:merge(tpcds_partitioned_parquet_snap.customer.c_birth_year), avg:merge(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count)
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, NULL, NULL
|  Class 3
|    output: avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit), avg:merge(tpcds_partitioned_parquet_snap.customer.c_birth_year), avg:merge(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count)
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, NULL, NULL, NULL
|  Class 4
|    output: avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price), avg:merge(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit), avg:merge(tpcds_partitioned_parquet_snap.customer.c_birth_year), avg:merge(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=608.57MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=15N,17N,19N,21N,23N row-size=641B cardinality=7.63M cost=74467863
|  in pipelines: 24(GETNEXT), 00(OPEN)
|
23:EXCHANGE [HASH(CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 16 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 18 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 20 THEN murmur_hash(tpcds_partitioned_parquet_snap.item.i_item_id) WHEN 22 THEN murmur_hash(NULL) END,CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_country) WHEN 16 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_country) WHEN 18 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_country) WHEN 20 THEN murmur_hash(NULL) WHEN 22 THEN murmur_hash(NULL) END,CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_state) WHEN 16 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_state) WHEN 18 THEN murmur_hash(NULL) WHEN 20 THEN murmur_hash(NULL) WHEN 22 THEN murmur_hash(NULL) END,CASE valid_tid(16,18,20,22,14) WHEN 14 THEN murmur_hash(tpcds_partitioned_parquet_snap.customer_address.ca_county) WHEN 16 THEN murmur_hash(NULL) WHEN 18 THEN murmur_hash(NULL) WHEN 20 THEN murmur_hash(NULL) WHEN 22 THEN murmur_hash(NULL) END)]
|  mem-estimate=81.00MB mem-reservation=0B thread-reservation=0
|  tuple-ids=14N,16N,18N,20N,22N row-size=641B cardinality=22.26M cost=71367143
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=110 (adjusted from 120)
Per-Host Shared Resources: mem-estimate=5.00MB mem-reservation=5.00MB thread-reservation=0 runtime-filters-memory=5.00MB
Per-Instance Resources: mem-estimate=213.64MB mem-reservation=138.25MB thread-reservation=1
max-parallelism=110 segment-costs=[1068003099, 975989858] cpu-comparison-result=110 [max(110 (self) vs 85 (sum children))]
13:AGGREGATE [STREAMING]
|  Class 0
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, tpcds_partitioned_parquet_snap.customer_address.ca_state, tpcds_partitioned_parquet_snap.customer_address.ca_county
|  Class 1
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, tpcds_partitioned_parquet_snap.customer_address.ca_state, NULL
|  Class 2
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, tpcds_partitioned_parquet_snap.customer_address.ca_country, NULL, NULL
|  Class 3
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: tpcds_partitioned_parquet_snap.item.i_item_id, NULL, NULL, NULL
|  Class 4
|    output: avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_quantity AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_list_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_coupon_amt AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_sales_price AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.catalog_sales.cs_net_profit AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer.c_birth_year AS DECIMAL(12,2))), avg(CAST(tpcds_partitioned_parquet_snap.customer_demographics.cd_dep_count AS DECIMAL(12,2)))
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=146.00MB mem-reservation=138.00MB thread-reservation=0
|  tuple-ids=14N,16N,18N,20N,22N row-size=641B cardinality=22.26M cost=154220821
|  in pipelines: 00(GETNEXT)
|
12:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=00
|  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4,6,8,10,12 row-size=212B cardinality=5.96M cost=23311705
|  in pipelines: 00(GETNEXT), 07(OPEN)
|
|--F10:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=387.03MB mem-reservation=376.00MB thread-reservation=1 runtime-filters-memory=2.00MB
|  |  max-parallelism=10 segment-costs=[5231037] cpu-comparison-result=40 [max(30 (self) vs 40 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  |  mem-estimate=374.00MB mem-reservation=374.00MB spill-buffer=2.00MB thread-reservation=0 cost=2246047
|  |
|  22:EXCHANGE [BROADCAST]
|  |  mem-estimate=11.03MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=8,10,12 row-size=93B cardinality=2.25M cost=2984990
|  |  in pipelines: 07(GETNEXT)
|  |
|  F07:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)] hosts=10 instances=10
|  Per-Instance Resources: mem-estimate=10.72MB mem-reservation=0B thread-reservation=1
|  max-parallelism=10 segment-costs=[3499543]
|  11:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk = tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk = tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=8,10,12 row-size=93B cardinality=2.25M cost=1594451
|  |  in pipelines: 07(GETNEXT), 10(OPEN)
|  |
|  |--F11:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=46.71MB mem-reservation=36.00MB thread-reservation=1 runtime-filters-memory=2.00MB
|  |  |  max-parallelism=10 segment-costs=[2940664]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|  |  |  runtime filters: RF008[bloom] <- tpcds_partitioned_parquet_snap.customer_address.ca_address_sk, RF009[min_max] <- tpcds_partitioned_parquet_snap.customer_address.ca_address_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=2058824
|  |  |
|  |  21:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_address.ca_address_sk)]
|  |  |  mem-estimate=10.71MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=12 row-size=69B cardinality=2.06M cost=881840
|  |  |  in pipelines: 10(GETNEXT)
|  |  |
|  |  F06:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=18.85MB mem-reservation=128.00KB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[18166835]
|  |  10:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_address, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=307.36MB
|  |     predicates: tpcds_partitioned_parquet_snap.customer_address.ca_state IN ('GA', 'IL', 'KS', 'LA', 'PA', 'TX', 'WV'), tpcds_partitioned_parquet_snap.customer_address.ca_address_sk IS NOT NULL
|  |     stored statistics:
|  |       table: rows=15.00M size=307.36MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1.58M
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.customer_address.ca_state IN ('GA', 'IL', 'KS', 'LA', 'PA', 'TX', 'WV')
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer_address.ca_state IN ('GA', 'IL', 'KS', 'LA', 'PA', 'TX', 'WV'), tpcds_partitioned_parquet_snap.customer_address.ca_address_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=12 row-size=69B cardinality=2.06M cost=7962659
|  |     in pipelines: 10(GETNEXT)
|  |
|  20:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)]
|  |  mem-estimate=10.31MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=8,10 row-size=24B cardinality=4.63M(filtered from 14.55M) cost=1195800
|  |  in pipelines: 07(GETNEXT)
|  |
|  F04:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  Per-Host Shared Resources: mem-estimate=4.00MB mem-reservation=4.00MB thread-reservation=0 runtime-filters-memory=4.00MB
|  Per-Instance Resources: mem-estimate=17.25MB mem-reservation=1.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[27762395]
|  09:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=02
|  |  hash predicates: tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk = tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk = tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=8,10 row-size=24B cardinality=4.63M(filtered from 14.55M) cost=3824793
|  |  in pipelines: 07(GETNEXT), 08(OPEN)
|  |
|  |--F12:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=64.73MB mem-reservation=36.00MB thread-reservation=1 runtime-filters-memory=2.00MB
|  |  |  max-parallelism=10 segment-costs=[4473540]
|  |  JOIN BUILD
|  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk
|  |  |  runtime filters: RF010[bloom] <- tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk, RF011[min_max] <- tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk
|  |  |  mem-estimate=55.33MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=1920800
|  |  |
|  |  19:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=7.41MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=10 row-size=4B cardinality=1.92M cost=2552740
|  |  |  in pipelines: 08(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.03MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[226845]
|  |  08:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_demographics, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=11.15MB
|  |     predicates: tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk IS NOT NULL
|  |     stored statistics:
|  |       table: rows=1.92M size=11.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=197.97K
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer_demographics_0.cd_demo_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=10 row-size=4B cardinality=1.92M cost=164612
|  |     in pipelines: 08(GETNEXT)
|  |
|  07:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|     HDFS partitions=1/1 files=1 size=1.55GB
|     predicates: tpcds_partitioned_parquet_snap.customer.c_birth_month IN (CAST(3 AS INT), CAST(6 AS INT), CAST(7 AS INT), CAST(8 AS INT), CAST(11 AS INT), CAST(12 AS INT)), tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_customer_sk IS NOT NULL
|     runtime filters: RF009[min_max] -> tpcds_partitioned_parquet_snap.customer.c_current_addr_sk, RF011[min_max] -> tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk, RF008[bloom] -> tpcds_partitioned_parquet_snap.customer.c_current_addr_sk, RF010[bloom] -> tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk
|     stored statistics:
|       table: rows=30.00M size=1.55GB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.10M
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.customer.c_birth_month IN (CAST(3 AS INT), CAST(6 AS INT), CAST(7 AS INT), CAST(8 AS INT), CAST(11 AS INT), CAST(12 AS INT))
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer.c_birth_month IN (CAST(3 AS INT), CAST(6 AS INT), CAST(7 AS INT), CAST(8 AS INT), CAST(11 AS INT), CAST(12 AS INT)), tpcds_partitioned_parquet_snap.customer.c_current_cdemo_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL, tpcds_partitioned_parquet_snap.customer.c_customer_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=8 row-size=20B cardinality=4.63M(filtered from 14.74M) cost=12012000
|     in pipelines: 07(GETNEXT)
|
06:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=03
|  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4,6 row-size=119B cardinality=86.68M cost=37949048
|  in pipelines: 00(GETNEXT), 05(OPEN)
|
|--F13:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=385.14MB mem-reservation=375.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=03 plan-id=04 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF003[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=374.00MB mem-reservation=374.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  18:EXCHANGE [BROADCAST]
|  |  mem-estimate=10.14MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=6 row-size=32B cardinality=360.00K cost=478440
|  |  in pipelines: 05(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=16.14MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[152676]
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IS NOT NULL
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.item.i_item_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=6 row-size=32B cardinality=360.00K cost=113796
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=04
|  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk = tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk = tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  tuple-ids=0,2,4 row-size=87B cardinality=86.72M cost=91490550
|  in pipelines: 00(GETNEXT), 03(OPEN)
|
|--F14:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=196.33MB mem-reservation=188.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[451890]
|  JOIN BUILD
|  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk, RF005[min_max] <- tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk
|  |  mem-estimate=187.00MB mem-reservation=187.00MB spill-buffer=1.00MB thread-reservation=0 cost=194030
|  |
|  17:EXCHANGE [BROADCAST]
|  |  mem-estimate=8.33MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=4 row-size=43B cardinality=194.03K cost=257860
|  |  in pipelines: 03(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  Per-Instance Resources: mem-estimate=16.18MB mem-reservation=1.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[702093]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_demographics, RANDOM]
|     HDFS partitions=1/1 files=1 size=11.15MB
|     predicates: tpcds_partitioned_parquet_snap.customer_demographics.cd_education_status = 'Primary', tpcds_partitioned_parquet_snap.customer_demographics.cd_gender = 'F', tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk IS NOT NULL
|     stored statistics:
|       table: rows=1.92M size=11.15MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=197.97K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.customer_demographics.cd_education_status = 'Primary', tpcds_partitioned_parquet_snap.customer_demographics.cd_gender = 'F'
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer_demographics.cd_education_status = 'Primary', tpcds_partitioned_parquet_snap.customer_demographics.cd_gender = 'F', tpcds_partitioned_parquet_snap.customer_demographics.cd_demo_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=4 row-size=43B cardinality=194.03K cost=675600
|     in pipelines: 03(GETNEXT)
|
02:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=05
|  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=44B cardinality=295.43M(filtered from 869.12M) cost=233260921
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--F15:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=22.33MB mem-reservation=22.31MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[863]
|  JOIN BUILD
|  |  join-table-id=05 plan-id=06 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=373
|  |
|  16:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=8B cardinality=373 cost=490
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[12536]
|  01:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1999 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=8B cardinality=373 cost=12520
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
   partition predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk IS NOT NULL
   HDFS partitions=1830/1831 files=1830 size=280.81GB
   predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk IS NOT NULL, tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk IS NOT NULL, tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk IS NOT NULL
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk, RF005[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk, RF003[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk, RF006[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk
   stored statistics:
     table: rows=4.32G size=280.96GB
     partitions: 1830/1830 rows=4.30G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=5.09M est-scan-range=373(filtered from 1830)
   parquet dictionary predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk IS NOT NULL, tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_cdemo_sk IS NOT NULL, tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk IS NOT NULL
   mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
   tuple-ids=0 row-size=36B cardinality=295.43M(filtered from 4.27G) cost=527770054
   in pipelines: 00(GETNEXT)
====
