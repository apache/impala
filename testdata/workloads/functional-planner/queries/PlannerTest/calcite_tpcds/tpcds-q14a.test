# TPCDS-Q14a first of two
# start query 14 in stream 0 using template query14.tpl using seed 521152908
with  cross_items as
 (select i_item_sk ss_item_sk
 from item,
 (select iss.i_brand_id brand_id
     ,iss.i_class_id class_id
     ,iss.i_category_id category_id
 from store_sales
     ,item iss
     ,date_dim d1
 where ss_item_sk = iss.i_item_sk
   and ss_sold_date_sk = d1.d_date_sk
   and d1.d_year between 1998 AND 1998 + 2
 intersect
 select ics.i_brand_id
     ,ics.i_class_id
     ,ics.i_category_id
 from catalog_sales
     ,item ics
     ,date_dim d2
 where cs_item_sk = ics.i_item_sk
   and cs_sold_date_sk = d2.d_date_sk
   and d2.d_year between 1998 AND 1998 + 2
 intersect
 select iws.i_brand_id
     ,iws.i_class_id
     ,iws.i_category_id
 from web_sales
     ,item iws
     ,date_dim d3
 where ws_item_sk = iws.i_item_sk
   and ws_sold_date_sk = d3.d_date_sk
   and d3.d_year between 1998 AND 1998 + 2) x
 where i_brand_id = brand_id
      and i_class_id = class_id
      and i_category_id = category_id
),
 avg_sales as
 (select avg(quantity*list_price) average_sales
  from (select ss_quantity quantity
             ,ss_list_price list_price
       from store_sales
           ,date_dim
       where ss_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2
       union all
       select cs_quantity quantity
             ,cs_list_price list_price
       from catalog_sales
           ,date_dim
       where cs_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2
       union all
       select ws_quantity quantity
             ,ws_list_price list_price
       from web_sales
           ,date_dim
       where ws_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2) x)
  select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)
 from(
       select 'store' channel, i_brand_id,i_class_id
             ,i_category_id,sum(ss_quantity*ss_list_price) sales
             , count(*) number_sales
       from store_sales
           ,item
           ,date_dim
       where ss_item_sk in (select ss_item_sk from cross_items)
         and ss_item_sk = i_item_sk
         and ss_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)
       union all
       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales
       from catalog_sales
           ,item
           ,date_dim
       where cs_item_sk in (select ss_item_sk from cross_items)
         and cs_item_sk = i_item_sk
         and cs_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)
       union all
       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales
       from web_sales
           ,item
           ,date_dim
       where ws_item_sk in (select ss_item_sk from cross_items)
         and ws_item_sk = i_item_sk
         and ws_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)
 ) y
 group by rollup (channel, i_brand_id,i_class_id,i_category_id)
 order by channel,i_brand_id,i_class_id,i_category_id
 limit 100
---- PLAN
Max Per-Host Resource Reservation: Memory=319.38MB Threads=1
Per-Host Resource Estimates: Memory=1009MB
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=1008.70MB mem-reservation=319.38MB thread-reservation=1 runtime-filters-memory=10.00MB
|  max-parallelism=1 segment-costs=[5106581694, 20423062286, 10212361080, 1760391, 2659596, 354720, 579617089, 11061232872, 5106581694, 20423062286, 10212361080, 1760391, 2659596, 354720, 289295727, 11061232872, 5106581694, 20423062286, 10212361080, 1760391, 2659596, 354720, 145781513, 11061232872, 11504873, 10687615, 20955666, 600]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END, aggif(valid_tid(155,156,157,158,159) IN (155, 156, 157, 158, 159), CASE valid_tid(155,156,157,158,159) WHEN 155 THEN sum(SALES) WHEN 156 THEN sum(SALES) WHEN 157 THEN sum(SALES) WHEN 158 THEN sum(SALES) WHEN 159 THEN sum(SALES) END), aggif(valid_tid(155,156,157,158,159) IN (155, 156, 157, 158, 159), CASE valid_tid(155,156,157,158,159) WHEN 155 THEN sum(NUMBER_SALES) WHEN 156 THEN sum(NUMBER_SALES) WHEN 157 THEN sum(NUMBER_SALES) WHEN 158 THEN sum(NUMBER_SALES) WHEN 159 THEN sum(NUMBER_SALES) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
139:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=161 row-size=48B cardinality=100 cost=20955666
|  in pipelines: 139(GETNEXT), 138(OPEN)
|
138:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(155,156,157,158,159) IN (CAST(155 AS INT), CAST(156 AS INT), CAST(157 AS INT), CAST(158 AS INT), CAST(159 AS INT)), CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN sum(SALES) WHEN CAST(156 AS INT) THEN sum(SALES) WHEN CAST(157 AS INT) THEN sum(SALES) WHEN CAST(158 AS INT) THEN sum(SALES) WHEN CAST(159 AS INT) THEN sum(SALES) END), aggif(valid_tid(155,156,157,158,159) IN (CAST(155 AS INT), CAST(156 AS INT), CAST(157 AS INT), CAST(158 AS INT), CAST(159 AS INT)), CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(156 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(157 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(158 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(159 AS INT) THEN sum(NUMBER_SALES) END)
|  group by: CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN CHANNEL WHEN CAST(156 AS INT) THEN CHANNEL WHEN CAST(157 AS INT) THEN CHANNEL WHEN CAST(158 AS INT) THEN CHANNEL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_BRAND_ID WHEN CAST(156 AS INT) THEN I_BRAND_ID WHEN CAST(157 AS INT) THEN I_BRAND_ID WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_CLASS_ID WHEN CAST(156 AS INT) THEN I_CLASS_ID WHEN CAST(157 AS INT) THEN NULL WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_CATEGORY_ID WHEN CAST(156 AS INT) THEN NULL WHEN CAST(157 AS INT) THEN NULL WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN CAST(155 AS INT) WHEN CAST(156 AS INT) THEN CAST(156 AS INT) WHEN CAST(157 AS INT) THEN CAST(157 AS INT) WHEN CAST(158 AS INT) THEN CAST(158 AS INT) WHEN CAST(159 AS INT) THEN CAST(159 AS INT) END
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=160 row-size=52B cardinality=1.79M cost=10687615
|  in pipelines: 138(GETNEXT), 137(OPEN)
|
137:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=1.79M cost=11333645
|  in pipelines: 137(GETNEXT), 33(OPEN), 78(OPEN), 123(OPEN)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=154 row-size=48B cardinality=447.36K cost=26522
|  in pipelines: 33(GETNEXT), 78(GETNEXT), 123(GETNEXT)
|
|--136:NESTED LOOP JOIN [INNER JOIN]
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=137,153 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 123(GETNEXT), 135(OPEN)
|  |
|  |--135:AGGREGATE [FINALIZE]
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=153 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 135(GETNEXT), 126(OPEN), 129(OPEN), 132(OPEN)
|  |  |
|  |  124:UNION
|  |  |  pass-through-operands: 125
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=151 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 126(GETNEXT), 129(GETNEXT), 132(GETNEXT)
|  |  |
|  |  |--134:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=147,149 row-size=20B cardinality=2.16G cost=945425284
|  |  |  |  in pipelines: 132(GETNEXT), 133(OPEN)
|  |  |  |
|  |  |  |--133:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=149 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 133(GETNEXT)
|  |  |  |
|  |  |  132:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=147 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 132(GETNEXT)
|  |  |
|  |  125:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=146 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 126(GETNEXT), 129(GETNEXT)
|  |  |
|  |  |--131:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=142,144 row-size=20B cardinality=4.32G cost=1890905436
|  |  |  |  in pipelines: 129(GETNEXT), 130(OPEN)
|  |  |  |
|  |  |  |--130:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=144 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 130(GETNEXT)
|  |  |  |
|  |  |  129:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=142 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 129(GETNEXT)
|  |  |
|  |  128:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=138,140 row-size=20B cardinality=8.64G cost=3781706938
|  |  |  in pipelines: 126(GETNEXT), 127(OPEN)
|  |  |
|  |  |--127:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=140 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 127(GETNEXT)
|  |  |
|  |  126:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=138 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 126(GETNEXT)
|  |
|  123:AGGREGATE [FINALIZE]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=137 row-size=36B cardinality=149.12K cost=19125840
|  |  in pipelines: 123(GETNEXT), 92(OPEN)
|  |
|  122:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  runtime filters: RF061[min_max] <- tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=103,105,134,135 row-size=48B cardinality=12.78M cost=5953914
|  |  in pipelines: 92(GETNEXT), 121(OPEN)
|  |
|  |--121:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=135 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 121(GETNEXT)
|  |
|  120:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  runtime filters: RF063[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=103,105,134 row-size=32B cardinality=12.78M cost=35156773
|  |  in pipelines: 92(GETNEXT), 119(OPEN)
|  |
|  |--119:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=134 row-size=4B cardinality=36.00K cost=104389
|  |  |  in pipelines: 119(GETNEXT), 117(OPEN)
|  |  |
|  |  118:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_9.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_9.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_9.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  runtime filters: RF066[bloom] <- tpcds_partitioned_parquet_snap.item_9.i_brand_id, RF069[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_brand_id, RF070[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_category_id, RF071[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_class_id
|  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=133,107 row-size=36B cardinality=36.00K cost=157271
|  |  |  in pipelines: 117(GETNEXT), 95(OPEN)
|  |  |
|  |  |--95:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_9.i_item_sk)
|  |  |     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_9.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=107 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  117:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 117(GETNEXT), 116(OPEN), 110(OPEN)
|  |  |
|  |  96:UNION
|  |  |  pass-through-operands: 116
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=132 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 116(GETNEXT), 110(GETNEXT)
|  |  |
|  |  |--110:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 110(GETNEXT), 103(OPEN), 109(OPEN)
|  |  |  |
|  |  |  97:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=123 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 103(GETNEXT), 109(GETNEXT)
|  |  |  |
|  |  |  |--109:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=149.12K cost=5933927815
|  |  |  |  |  in pipelines: 109(GETNEXT), 104(OPEN)
|  |  |  |  |
|  |  |  |  108:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  runtime filters: RF081[min_max] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=116,118,120 row-size=32B cardinality=4.32G cost=1890313155
|  |  |  |  |  in pipelines: 104(GETNEXT), 107(OPEN)
|  |  |  |  |
|  |  |  |  |--107:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     runtime filters: RF069[min_max] -> tpcds_partitioned_parquet_snap.item_11.i_brand_id, RF070[min_max] -> tpcds_partitioned_parquet_snap.item_11.i_category_id, RF071[min_max] -> tpcds_partitioned_parquet_snap.item_11.i_class_id, RF066[bloom] -> tpcds_partitioned_parquet_snap.item_11.i_brand_id
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=120 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 107(GETNEXT)
|  |  |  |  |
|  |  |  |  106:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=116,118 row-size=16B cardinality=4.32G(filtered from 4.32G) cost=1890351663
|  |  |  |  |  in pipelines: 104(GETNEXT), 105(OPEN)
|  |  |  |  |
|  |  |  |  |--105:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=118 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 105(GETNEXT)
|  |  |  |  |
|  |  |  |  104:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF081[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=116 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 104(GETNEXT)
|  |  |  |
|  |  |  103:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=149.12K cost=11866877138
|  |  |  |  in pipelines: 103(GETNEXT), 98(OPEN)
|  |  |  |
|  |  |  102:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  runtime filters: RF077[min_max] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=109,111,113 row-size=32B cardinality=8.64G cost=3780169729
|  |  |  |  in pipelines: 98(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--101:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     runtime filters: RF069[min_max] -> tpcds_partitioned_parquet_snap.item_10.i_brand_id, RF070[min_max] -> tpcds_partitioned_parquet_snap.item_10.i_category_id, RF071[min_max] -> tpcds_partitioned_parquet_snap.item_10.i_class_id, RF066[bloom] -> tpcds_partitioned_parquet_snap.item_10.i_brand_id
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=113 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=109,111 row-size=16B cardinality=8.64G(filtered from 8.64G) cost=3780599421
|  |  |  |  in pipelines: 98(GETNEXT), 99(OPEN)
|  |  |  |
|  |  |  |--99:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=111 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 99(GETNEXT)
|  |  |  |
|  |  |  98:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF077[min_max] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=109 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 98(GETNEXT)
|  |  |
|  |  116:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_class_id, tpcds_partitioned_parquet_snap.item_12.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=149.12K cost=2967204009
|  |  |  in pipelines: 116(GETNEXT), 111(OPEN)
|  |  |
|  |  115:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  runtime filters: RF073[min_max] <- tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=125,127,129 row-size=32B cardinality=2.16G cost=945305506
|  |  |  in pipelines: 111(GETNEXT), 114(OPEN)
|  |  |
|  |  |--114:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     runtime filters: RF069[min_max] -> tpcds_partitioned_parquet_snap.item_12.i_brand_id, RF070[min_max] -> tpcds_partitioned_parquet_snap.item_12.i_category_id, RF071[min_max] -> tpcds_partitioned_parquet_snap.item_12.i_class_id, RF066[bloom] -> tpcds_partitioned_parquet_snap.item_12.i_brand_id
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=129 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 114(GETNEXT)
|  |  |
|  |  113:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=125,127 row-size=16B cardinality=2.16G(filtered from 2.16G) cost=945148406
|  |  |  in pipelines: 111(GETNEXT), 112(OPEN)
|  |  |
|  |  |--112:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=127 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 112(GETNEXT)
|  |  |
|  |  111:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF073[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=125 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 111(GETNEXT)
|  |
|  94:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  runtime filters: RF064[bloom] <- tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=103,105 row-size=28B cardinality=127.89M cost=55978804
|  |  in pipelines: 92(GETNEXT), 93(OPEN)
|  |
|  |--93:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=105 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 93(GETNEXT)
|  |
|  92:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF063[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk, RF061[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk, RF064[bloom] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=103 row-size=16B cardinality=127.89M(filtered from 2.16G) cost=29466510
|     in pipelines: 92(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=298.24K cost=53044
|  in pipelines: 33(GETNEXT), 78(GETNEXT)
|
|--91:NESTED LOOP JOIN [INNER JOIN]
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=85,101 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 78(GETNEXT), 90(OPEN)
|  |
|  |--90:AGGREGATE [FINALIZE]
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=101 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 90(GETNEXT), 81(OPEN), 84(OPEN), 87(OPEN)
|  |  |
|  |  79:UNION
|  |  |  pass-through-operands: 80
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=99 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 81(GETNEXT), 84(GETNEXT), 87(GETNEXT)
|  |  |
|  |  |--89:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=95,97 row-size=20B cardinality=2.16G cost=945425284
|  |  |  |  in pipelines: 87(GETNEXT), 88(OPEN)
|  |  |  |
|  |  |  |--88:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=97 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 88(GETNEXT)
|  |  |  |
|  |  |  87:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=95 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 87(GETNEXT)
|  |  |
|  |  80:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=94 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 81(GETNEXT), 84(GETNEXT)
|  |  |
|  |  |--86:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=90,92 row-size=20B cardinality=4.32G cost=1890905436
|  |  |  |  in pipelines: 84(GETNEXT), 85(OPEN)
|  |  |  |
|  |  |  |--85:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=92 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 85(GETNEXT)
|  |  |  |
|  |  |  84:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=90 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 84(GETNEXT)
|  |  |
|  |  83:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=86,88 row-size=20B cardinality=8.64G cost=3781706938
|  |  |  in pipelines: 81(GETNEXT), 82(OPEN)
|  |  |
|  |  |--82:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=88 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 82(GETNEXT)
|  |  |
|  |  81:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=86 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 81(GETNEXT)
|  |
|  78:AGGREGATE [FINALIZE]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=85 row-size=36B cardinality=149.12K cost=37436524
|  |  in pipelines: 78(GETNEXT), 47(OPEN)
|  |
|  77:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  runtime filters: RF031[min_max] <- tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=51,53,82,83 row-size=48B cardinality=25.46M cost=11505424
|  |  in pipelines: 47(GETNEXT), 76(OPEN)
|  |
|  |--76:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=83 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 76(GETNEXT)
|  |
|  75:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  runtime filters: RF033[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=51,53,82 row-size=32B cardinality=25.47M cost=70011311
|  |  in pipelines: 47(GETNEXT), 74(OPEN)
|  |
|  |--74:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=82 row-size=4B cardinality=36.00K cost=104389
|  |  |  in pipelines: 74(GETNEXT), 72(OPEN)
|  |  |
|  |  73:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_4.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_4.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_4.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  runtime filters: RF036[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_brand_id, RF037[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_category_id, RF038[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_class_id, RF039[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_brand_id, RF040[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_category_id, RF041[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_class_id
|  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=81,55 row-size=36B cardinality=36.00K cost=157271
|  |  |  in pipelines: 72(GETNEXT), 50(OPEN)
|  |  |
|  |  |--50:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_4.i_item_sk)
|  |  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_4.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=55 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 50(GETNEXT)
|  |  |
|  |  72:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=81 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 72(GETNEXT), 71(OPEN), 65(OPEN)
|  |  |
|  |  51:UNION
|  |  |  pass-through-operands: 71
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=80 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 71(GETNEXT), 65(GETNEXT)
|  |  |
|  |  |--65:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=72 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 65(GETNEXT), 58(OPEN), 64(OPEN)
|  |  |  |
|  |  |  52:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=71 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 58(GETNEXT), 64(GETNEXT)
|  |  |  |
|  |  |  |--64:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=70 row-size=12B cardinality=149.12K cost=5933927815
|  |  |  |  |  in pipelines: 64(GETNEXT), 59(OPEN)
|  |  |  |  |
|  |  |  |  63:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  runtime filters: RF051[min_max] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=64,66,68 row-size=32B cardinality=4.32G cost=1890313155
|  |  |  |  |  in pipelines: 59(GETNEXT), 62(OPEN)
|  |  |  |  |
|  |  |  |  |--62:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     runtime filters: RF039[min_max] -> tpcds_partitioned_parquet_snap.item_6.i_brand_id, RF040[min_max] -> tpcds_partitioned_parquet_snap.item_6.i_category_id, RF041[min_max] -> tpcds_partitioned_parquet_snap.item_6.i_class_id, RF036[bloom] -> tpcds_partitioned_parquet_snap.item_6.i_brand_id, RF037[bloom] -> tpcds_partitioned_parquet_snap.item_6.i_category_id, RF038[bloom] -> tpcds_partitioned_parquet_snap.item_6.i_class_id
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=68 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 62(GETNEXT)
|  |  |  |  |
|  |  |  |  61:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=64,66 row-size=16B cardinality=4.32G(filtered from 4.32G) cost=1890351663
|  |  |  |  |  in pipelines: 59(GETNEXT), 60(OPEN)
|  |  |  |  |
|  |  |  |  |--60:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=66 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 60(GETNEXT)
|  |  |  |  |
|  |  |  |  59:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF051[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=64 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |
|  |  |  58:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=63 row-size=12B cardinality=149.12K cost=11866877138
|  |  |  |  in pipelines: 58(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  57:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  runtime filters: RF047[min_max] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=57,59,61 row-size=32B cardinality=8.64G cost=3780169729
|  |  |  |  in pipelines: 53(GETNEXT), 56(OPEN)
|  |  |  |
|  |  |  |--56:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     runtime filters: RF039[min_max] -> tpcds_partitioned_parquet_snap.item_5.i_brand_id, RF040[min_max] -> tpcds_partitioned_parquet_snap.item_5.i_category_id, RF041[min_max] -> tpcds_partitioned_parquet_snap.item_5.i_class_id, RF036[bloom] -> tpcds_partitioned_parquet_snap.item_5.i_brand_id, RF037[bloom] -> tpcds_partitioned_parquet_snap.item_5.i_category_id, RF038[bloom] -> tpcds_partitioned_parquet_snap.item_5.i_class_id
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=61 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 56(GETNEXT)
|  |  |  |
|  |  |  55:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=57,59 row-size=16B cardinality=8.64G(filtered from 8.64G) cost=3780599421
|  |  |  |  in pipelines: 53(GETNEXT), 54(OPEN)
|  |  |  |
|  |  |  |--54:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=59 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  53:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF047[min_max] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=57 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 53(GETNEXT)
|  |  |
|  |  71:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_class_id, tpcds_partitioned_parquet_snap.item_7.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=79 row-size=12B cardinality=149.12K cost=2967204009
|  |  |  in pipelines: 71(GETNEXT), 66(OPEN)
|  |  |
|  |  70:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  runtime filters: RF043[min_max] <- tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=73,75,77 row-size=32B cardinality=2.16G cost=945305506
|  |  |  in pipelines: 66(GETNEXT), 69(OPEN)
|  |  |
|  |  |--69:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     runtime filters: RF039[min_max] -> tpcds_partitioned_parquet_snap.item_7.i_brand_id, RF040[min_max] -> tpcds_partitioned_parquet_snap.item_7.i_category_id, RF041[min_max] -> tpcds_partitioned_parquet_snap.item_7.i_class_id, RF036[bloom] -> tpcds_partitioned_parquet_snap.item_7.i_brand_id, RF037[bloom] -> tpcds_partitioned_parquet_snap.item_7.i_category_id, RF038[bloom] -> tpcds_partitioned_parquet_snap.item_7.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=77 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 69(GETNEXT)
|  |  |
|  |  68:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=73,75 row-size=16B cardinality=2.16G(filtered from 2.16G) cost=945148406
|  |  |  in pipelines: 66(GETNEXT), 67(OPEN)
|  |  |
|  |  |--67:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=75 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 67(GETNEXT)
|  |  |
|  |  66:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF043[min_max] -> tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=73 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 66(GETNEXT)
|  |
|  49:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  runtime filters: RF034[bloom] <- tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=51,53 row-size=28B cardinality=254.82M cost=111533149
|  |  in pipelines: 47(GETNEXT), 48(OPEN)
|  |
|  |--48:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=53 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 48(GETNEXT)
|  |
|  47:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF033[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF034[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=51 row-size=16B cardinality=254.82M(filtered from 4.32G) cost=58709647
|     in pipelines: 47(GETNEXT)
|
46:NESTED LOOP JOIN [INNER JOIN]
|  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  tuple-ids=34,50 row-size=52B cardinality=149.12K cost=30554
|  in pipelines: 33(GETNEXT), 45(OPEN)
|
|--45:AGGREGATE [FINALIZE]
|  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=50 row-size=16B cardinality=1 cost=1058398679
|  |  in pipelines: 45(GETNEXT), 36(OPEN), 39(OPEN), 42(OPEN)
|  |
|  34:UNION
|  |  pass-through-operands: 35
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=48 row-size=8B cardinality=15.12G cost=110287964
|  |  in pipelines: 36(GETNEXT), 39(GETNEXT), 42(GETNEXT)
|  |
|  |--44:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=44,46 row-size=20B cardinality=2.16G cost=945425284
|  |  |  in pipelines: 42(GETNEXT), 43(OPEN)
|  |  |
|  |  |--43:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=46 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 43(GETNEXT)
|  |  |
|  |  42:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=44 row-size=12B cardinality=2.16G cost=373242464
|  |     in pipelines: 42(GETNEXT)
|  |
|  35:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=43 row-size=8B cardinality=12.96G cost=661738272
|  |  in pipelines: 36(GETNEXT), 39(GETNEXT)
|  |
|  |--41:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=39,41 row-size=20B cardinality=4.32G cost=1890905436
|  |  |  in pipelines: 39(GETNEXT), 40(OPEN)
|  |  |
|  |  |--40:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=41 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 40(GETNEXT)
|  |  |
|  |  39:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=39 row-size=12B cardinality=4.32G cost=746509474
|  |     in pipelines: 39(GETNEXT)
|  |
|  38:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=35,37 row-size=20B cardinality=8.64G cost=3781706938
|  |  in pipelines: 36(GETNEXT), 37(OPEN)
|  |
|  |--37:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=37 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 37(GETNEXT)
|  |
|  36:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=35 row-size=12B cardinality=8.64G cost=1492980801
|     in pipelines: 36(GETNEXT)
|
33:AGGREGATE [FINALIZE]
|  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count()
|  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=34 row-size=36B cardinality=149.12K cost=74478032
|  in pipelines: 33(GETNEXT), 02(OPEN)
|
32:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  runtime filters: RF001[min_max] <- tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,31,32 row-size=48B cardinality=51.11M cost=22735822
|  in pipelines: 02(GETNEXT), 31(OPEN)
|
|--31:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=32 row-size=16B cardinality=360.00K cost=82944
|     in pipelines: 31(GETNEXT)
|
30:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  runtime filters: RF003[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,31 row-size=32B cardinality=51.13M cost=140520124
|  in pipelines: 02(GETNEXT), 29(OPEN)
|
|--29:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=31 row-size=4B cardinality=36.00K cost=104389
|  |  in pipelines: 29(GETNEXT), 27(OPEN)
|  |
|  28:HASH JOIN [INNER JOIN]
|  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item.i_class_id
|  |  fk/pk conjuncts: assumed fk/pk
|  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.item.i_brand_id, RF007[bloom] <- tpcds_partitioned_parquet_snap.item.i_category_id, RF008[bloom] <- tpcds_partitioned_parquet_snap.item.i_class_id, RF009[min_max] <- tpcds_partitioned_parquet_snap.item.i_brand_id, RF010[min_max] <- tpcds_partitioned_parquet_snap.item.i_category_id, RF011[min_max] <- tpcds_partitioned_parquet_snap.item.i_class_id
|  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=30,4 row-size=36B cardinality=36.00K cost=157271
|  |  in pipelines: 27(GETNEXT), 05(OPEN)
|  |
|  |--05:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item.i_item_sk)
|  |     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item.i_item_sk)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=4 row-size=16B cardinality=36.00K cost=93060
|  |     in pipelines: 05(GETNEXT)
|  |
|  27:AGGREGATE [FINALIZE]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=30 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 27(GETNEXT), 26(OPEN), 20(OPEN)
|  |
|  06:UNION
|  |  pass-through-operands: 26
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=29 row-size=12B cardinality=447.36K cost=19009
|  |  in pipelines: 26(GETNEXT), 20(GETNEXT)
|  |
|  |--20:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 20(GETNEXT), 13(OPEN), 19(OPEN)
|  |  |
|  |  07:UNION
|  |  |  pass-through-operands: all
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=20 row-size=12B cardinality=298.24K cost=0
|  |  |  in pipelines: 13(GETNEXT), 19(GETNEXT)
|  |  |
|  |  |--19:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=19 row-size=12B cardinality=149.12K cost=5933927815
|  |  |  |  in pipelines: 19(GETNEXT), 14(OPEN)
|  |  |  |
|  |  |  18:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  runtime filters: RF021[min_max] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=13,15,17 row-size=32B cardinality=4.32G cost=1890313155
|  |  |  |  in pipelines: 14(GETNEXT), 17(OPEN)
|  |  |  |
|  |  |  |--17:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     runtime filters: RF009[min_max] -> tpcds_partitioned_parquet_snap.item_1.i_brand_id, RF010[min_max] -> tpcds_partitioned_parquet_snap.item_1.i_category_id, RF011[min_max] -> tpcds_partitioned_parquet_snap.item_1.i_class_id, RF006[bloom] -> tpcds_partitioned_parquet_snap.item_1.i_brand_id, RF007[bloom] -> tpcds_partitioned_parquet_snap.item_1.i_category_id, RF008[bloom] -> tpcds_partitioned_parquet_snap.item_1.i_class_id
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=17 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  16:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=13,15 row-size=16B cardinality=4.32G(filtered from 4.32G) cost=1890351663
|  |  |  |  in pipelines: 14(GETNEXT), 15(OPEN)
|  |  |  |
|  |  |  |--15:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=15 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 15(GETNEXT)
|  |  |  |
|  |  |  14:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF021[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=13 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 14(GETNEXT)
|  |  |
|  |  13:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=12 row-size=12B cardinality=149.12K cost=11866877138
|  |  |  in pipelines: 13(GETNEXT), 08(OPEN)
|  |  |
|  |  12:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  runtime filters: RF017[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=6,8,10 row-size=32B cardinality=8.64G cost=3780169729
|  |  |  in pipelines: 08(GETNEXT), 11(OPEN)
|  |  |
|  |  |--11:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     runtime filters: RF009[min_max] -> tpcds_partitioned_parquet_snap.item_0.i_brand_id, RF010[min_max] -> tpcds_partitioned_parquet_snap.item_0.i_category_id, RF011[min_max] -> tpcds_partitioned_parquet_snap.item_0.i_class_id, RF006[bloom] -> tpcds_partitioned_parquet_snap.item_0.i_brand_id, RF007[bloom] -> tpcds_partitioned_parquet_snap.item_0.i_category_id, RF008[bloom] -> tpcds_partitioned_parquet_snap.item_0.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=10 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 11(GETNEXT)
|  |  |
|  |  10:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=6,8 row-size=16B cardinality=8.64G(filtered from 8.64G) cost=3780599421
|  |  |  in pipelines: 08(GETNEXT), 09(OPEN)
|  |  |
|  |  |--09:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=8 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 09(GETNEXT)
|  |  |
|  |  08:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF017[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=6 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 08(GETNEXT)
|  |
|  26:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=28 row-size=12B cardinality=149.12K cost=2967204009
|  |  in pipelines: 26(GETNEXT), 21(OPEN)
|  |
|  25:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  runtime filters: RF013[min_max] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=22,24,26 row-size=32B cardinality=2.16G cost=945305506
|  |  in pipelines: 21(GETNEXT), 24(OPEN)
|  |
|  |--24:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF009[min_max] -> tpcds_partitioned_parquet_snap.item_2.i_brand_id, RF010[min_max] -> tpcds_partitioned_parquet_snap.item_2.i_category_id, RF011[min_max] -> tpcds_partitioned_parquet_snap.item_2.i_class_id, RF006[bloom] -> tpcds_partitioned_parquet_snap.item_2.i_brand_id, RF007[bloom] -> tpcds_partitioned_parquet_snap.item_2.i_category_id, RF008[bloom] -> tpcds_partitioned_parquet_snap.item_2.i_class_id
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=26 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 24(GETNEXT)
|  |
|  23:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=22,24 row-size=16B cardinality=2.16G(filtered from 2.16G) cost=945148406
|  |  in pipelines: 21(GETNEXT), 22(OPEN)
|  |
|  |--22:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=24 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 22(GETNEXT)
|  |
|  21:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF013[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=22 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|     in pipelines: 21(GETNEXT)
|
04:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=28B cardinality=511.58M cost=223916534
|  in pipelines: 02(GETNEXT), 03(OPEN)
|
|--03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108 cost=16728
|     in pipelines: 03(GETNEXT)
|
02:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=16B cardinality=511.58M(filtered from 8.64G) cost=117866905
   in pipelines: 02(GETNEXT)
---- DISTRIBUTEDPLAN
Max Per-Host Resource Reservation: Memory=10.73GB Threads=325
Per-Host Resource Estimates: Memory=29.41GB
F96:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.05MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[634] cpu-comparison-result=1557 [max(1 (self) vs 1557 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END, aggif(valid_tid(155,156,157,158,159) IN (155, 156, 157, 158, 159), CASE valid_tid(155,156,157,158,159) WHEN 155 THEN sum(SALES) WHEN 156 THEN sum(SALES) WHEN 157 THEN sum(SALES) WHEN 158 THEN sum(SALES) WHEN 159 THEN sum(SALES) END), aggif(valid_tid(155,156,157,158,159) IN (155, 156, 157, 158, 159), CASE valid_tid(155,156,157,158,159) WHEN 155 THEN sum(NUMBER_SALES) WHEN 156 THEN sum(NUMBER_SALES) WHEN 157 THEN sum(NUMBER_SALES) WHEN 158 THEN sum(NUMBER_SALES) WHEN 159 THEN sum(NUMBER_SALES) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
232:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST
|  limit: 100
|  mem-estimate=51.25KB mem-reservation=0B thread-reservation=0
|  tuple-ids=161 row-size=48B cardinality=100 cost=34
|  in pipelines: 139(GETNEXT)
|
F95:PLAN FRAGMENT [HASH(CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(CHANNEL) WHEN 156 THEN murmur_hash(CHANNEL) WHEN 157 THEN murmur_hash(CHANNEL) WHEN 158 THEN murmur_hash(CHANNEL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_BRAND_ID) WHEN 156 THEN murmur_hash(I_BRAND_ID) WHEN 157 THEN murmur_hash(I_BRAND_ID) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CLASS_ID) WHEN 156 THEN murmur_hash(I_CLASS_ID) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CATEGORY_ID) WHEN 156 THEN murmur_hash(NULL) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=650.00MB mem-reservation=171.94MB thread-reservation=1
max-parallelism=10 segment-costs=[13125702, 10687615, 20955666, 157] cpu-comparison-result=1557 [max(10 (self) vs 1557 (sum children))]
139:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=161 row-size=48B cardinality=100 cost=20955666
|  in pipelines: 139(GETNEXT), 138(OPEN)
|
138:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(155,156,157,158,159) IN (CAST(155 AS INT), CAST(156 AS INT), CAST(157 AS INT), CAST(158 AS INT), CAST(159 AS INT)), CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN sum(SALES) WHEN CAST(156 AS INT) THEN sum(SALES) WHEN CAST(157 AS INT) THEN sum(SALES) WHEN CAST(158 AS INT) THEN sum(SALES) WHEN CAST(159 AS INT) THEN sum(SALES) END), aggif(valid_tid(155,156,157,158,159) IN (CAST(155 AS INT), CAST(156 AS INT), CAST(157 AS INT), CAST(158 AS INT), CAST(159 AS INT)), CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(156 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(157 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(158 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(159 AS INT) THEN sum(NUMBER_SALES) END)
|  group by: CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN CHANNEL WHEN CAST(156 AS INT) THEN CHANNEL WHEN CAST(157 AS INT) THEN CHANNEL WHEN CAST(158 AS INT) THEN CHANNEL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_BRAND_ID WHEN CAST(156 AS INT) THEN I_BRAND_ID WHEN CAST(157 AS INT) THEN I_BRAND_ID WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_CLASS_ID WHEN CAST(156 AS INT) THEN I_CLASS_ID WHEN CAST(157 AS INT) THEN NULL WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_CATEGORY_ID WHEN CAST(156 AS INT) THEN NULL WHEN CAST(157 AS INT) THEN NULL WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN CAST(155 AS INT) WHEN CAST(156 AS INT) THEN CAST(156 AS INT) WHEN CAST(157 AS INT) THEN CAST(157 AS INT) WHEN CAST(158 AS INT) THEN CAST(158 AS INT) WHEN CAST(159 AS INT) THEN CAST(159 AS INT) END
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=160 row-size=52B cardinality=1.79M cost=10687615
|  in pipelines: 138(GETNEXT), 231(OPEN)
|
231:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=1.79M cost=10687785
|  in pipelines: 231(GETNEXT), 163(OPEN), 193(OPEN), 223(OPEN)
|
230:EXCHANGE [HASH(CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(CHANNEL) WHEN 156 THEN murmur_hash(CHANNEL) WHEN 157 THEN murmur_hash(CHANNEL) WHEN 158 THEN murmur_hash(CHANNEL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_BRAND_ID) WHEN 156 THEN murmur_hash(I_BRAND_ID) WHEN 157 THEN murmur_hash(I_BRAND_ID) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CLASS_ID) WHEN 156 THEN murmur_hash(I_CLASS_ID) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CATEGORY_ID) WHEN 156 THEN murmur_hash(NULL) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END)]
|  mem-estimate=27.77MB mem-reservation=0B thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=1.79M cost=2437917
|  in pipelines: 163(GETNEXT), 193(GETNEXT), 223(GETNEXT)
|
F94:PLAN FRAGMENT [RANDOM] hosts=10 instances=70 (adjusted from 120)
Per-Instance Resources: mem-estimate=554.89MB mem-reservation=146.50MB thread-reservation=1
max-parallelism=70 segment-costs=[29697476, 24044235, 16389428, 11505411, 32269345] cpu-comparison-result=1557 [max(70 (self) vs 1557 (sum children))]
137:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=138.00MB thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=1.79M cost=11334183
|  in pipelines: 163(GETNEXT), 193(GETNEXT), 223(GETNEXT)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=154 row-size=48B cardinality=447.36K cost=26522
|  in pipelines: 163(GETNEXT), 193(GETNEXT), 223(GETNEXT)
|
|--136:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 08
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=137,153 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 223(GETNEXT), 228(OPEN)
|  |
|  |--F105:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  229:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=153 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 228(GETNEXT)
|  |  |
|  |  F93:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  228:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=153 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 228(GETNEXT), 135(OPEN)
|  |  |
|  |  227:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=152 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 135(GETNEXT)
|  |  |
|  |  F92:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  135:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=152 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 135(GETNEXT), 126(OPEN), 129(OPEN), 132(OPEN)
|  |  |
|  |  124:UNION
|  |  |  pass-through-operands: 125
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=151 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 126(GETNEXT), 129(GETNEXT), 132(GETNEXT)
|  |  |
|  |  |--134:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=11
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=147,149 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 132(GETNEXT), 133(OPEN)
|  |  |  |
|  |  |  |--F108:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=11 plan-id=12 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  226:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=149 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 133(GETNEXT)
|  |  |  |  |
|  |  |  |  F91:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  133:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=149 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 133(GETNEXT)
|  |  |  |
|  |  |  132:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=147 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 132(GETNEXT)
|  |  |
|  |  125:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=146 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 126(GETNEXT), 129(GETNEXT)
|  |  |
|  |  |--131:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=10
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=142,144 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 129(GETNEXT), 130(OPEN)
|  |  |  |
|  |  |  |--F107:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=10 plan-id=11 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  225:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=144 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 130(GETNEXT)
|  |  |  |  |
|  |  |  |  F88:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  130:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=144 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 130(GETNEXT)
|  |  |  |
|  |  |  129:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=142 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 129(GETNEXT)
|  |  |
|  |  128:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=09
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=138,140 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 126(GETNEXT), 127(OPEN)
|  |  |
|  |  |--F106:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=09 plan-id=10 cohort-id=04
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  224:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=140 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 127(GETNEXT)
|  |  |  |
|  |  |  F86:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  127:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=140 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 127(GETNEXT)
|  |  |
|  |  126:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=138 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 126(GETNEXT)
|  |
|  223:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=137 row-size=36B cardinality=149.12K cost=13862637
|  |  in pipelines: 223(GETNEXT), 92(OPEN)
|  |
|  222:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_13.i_brand_id,tpcds_partitioned_parquet_snap.item_13.i_class_id,tpcds_partitioned_parquet_snap.item_13.i_category_id)]
|  |  mem-estimate=10.78MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=137 row-size=36B cardinality=9.13M cost=2526791
|  |  in pipelines: 92(GETNEXT)
|  |
|  F63:PLAN FRAGMENT [RANDOM] hosts=10 instances=20 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=36.94MB mem-reservation=9.12MB thread-reservation=1
|  max-parallelism=20 segment-costs=[185964162, 25876095] cpu-comparison-result=399 [max(20 (self) vs 399 (sum children))]
|  123:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=137 row-size=36B cardinality=9.13M cost=59804269
|  |  in pipelines: 92(GETNEXT)
|  |
|  122:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=32
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=103,105,134,135 row-size=48B cardinality=12.78M cost=5593914
|  |  in pipelines: 92(GETNEXT), 121(OPEN)
|  |
|  |--F129:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=73.57MB mem-reservation=68.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=32 plan-id=33 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  runtime filters: RF061[min_max] <- tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  mem-estimate=68.00MB mem-reservation=68.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  221:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=135 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 121(GETNEXT)
|  |  |
|  |  F83:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  121:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=135 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 121(GETNEXT)
|  |
|  120:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=33
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=103,105,134 row-size=32B cardinality=12.78M cost=35120773
|  |  in pipelines: 92(GETNEXT), 219(OPEN)
|  |
|  |--F130:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=4.09MB mem-reservation=3.88MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[83840] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=33 plan-id=34 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  runtime filters: RF063[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |
|  |  220:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=134 row-size=4B cardinality=36.00K cost=47840
|  |  |  in pipelines: 219(GETNEXT)
|  |  |
|  |  F82:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_9.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.09MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[109051, 1166] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  219:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=134 row-size=4B cardinality=36.00K cost=104389
|  |  |  in pipelines: 219(GETNEXT), 216(OPEN)
|  |  |
|  |  218:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_9.i_item_sk)]
|  |  |  mem-estimate=94.06KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=134 row-size=4B cardinality=36.00K cost=4662
|  |  |  in pipelines: 216(GETNEXT)
|  |  |
|  |  F80:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 225660, 27820] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  119:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=134 row-size=4B cardinality=36.00K cost=104389
|  |  |  in pipelines: 216(GETNEXT)
|  |  |
|  |  118:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=34
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_9.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_9.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_9.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=133,107 row-size=36B cardinality=36.00K cost=121271
|  |  |  in pipelines: 216(GETNEXT), 95(OPEN)
|  |  |
|  |  |--F131:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=3.15MB mem-reservation=2.94MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[42649]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=34 plan-id=35 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_category_id, tpcds_partitioned_parquet_snap.item_9.i_class_id
|  |  |  |  runtime filters: RF066[bloom] <- tpcds_partitioned_parquet_snap.item_9.i_brand_id, RF069[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_brand_id, RF070[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_category_id, RF071[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |  |
|  |  |  217:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_9.i_brand_id,tpcds_partitioned_parquet_snap.item_9.i_class_id,tpcds_partitioned_parquet_snap.item_9.i_category_id)]
|  |  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=107 row-size=16B cardinality=36.00K cost=6649
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  F81:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[148701]
|  |  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_9.i_item_sk)
|  |  |     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_9.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=107 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  216:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 216(GETNEXT), 204(OPEN), 214(OPEN)
|  |  |
|  |  215:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 204(GETNEXT), 214(GETNEXT)
|  |  |
|  |  F79:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  117:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 204(GETNEXT), 214(GETNEXT)
|  |  |
|  |  96:UNION
|  |  |  pass-through-operands: 204
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=132 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 204(GETNEXT), 214(GETNEXT)
|  |  |
|  |  |--214:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 214(GETNEXT), 208(OPEN), 212(OPEN)
|  |  |  |
|  |  |  213:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=60572
|  |  |  |  in pipelines: 208(GETNEXT), 212(GETNEXT)
|  |  |  |
|  |  |  F77:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  |  110:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 208(GETNEXT), 212(GETNEXT)
|  |  |  |
|  |  |  97:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=123 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 208(GETNEXT), 212(GETNEXT)
|  |  |  |
|  |  |  |--212:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  |  in pipelines: 212(GETNEXT), 104(OPEN)
|  |  |  |  |
|  |  |  |  211:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_11.i_brand_id,tpcds_partitioned_parquet_snap.item_11.i_class_id,tpcds_partitioned_parquet_snap.item_11.i_category_id)]
|  |  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  |  in pipelines: 104(GETNEXT)
|  |  |  |  |
|  |  |  |  F73:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  |  max-parallelism=1030 segment-costs=[10292257811, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  |  109:AGGREGATE [STREAMING]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  |  in pipelines: 104(GETNEXT)
|  |  |  |  |
|  |  |  |  108:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=39
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=116,118,120 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 104(GETNEXT), 107(OPEN)
|  |  |  |  |
|  |  |  |  |--F136:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=39 plan-id=40 cohort-id=07
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  |  runtime filters: RF081[min_max] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |  |
|  |  |  |  |  210:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=120 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  |  in pipelines: 107(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F75:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  |  107:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     runtime filters: RF069[min_max] -> tpcds_partitioned_parquet_snap.item_11.i_brand_id, RF070[min_max] -> tpcds_partitioned_parquet_snap.item_11.i_category_id, RF071[min_max] -> tpcds_partitioned_parquet_snap.item_11.i_class_id, RF066[bloom] -> tpcds_partitioned_parquet_snap.item_11.i_brand_id
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=120 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 107(GETNEXT)
|  |  |  |  |
|  |  |  |  106:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=40
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=116,118 row-size=16B cardinality=4.32G(filtered from 4.32G) cost=1890344358
|  |  |  |  |  in pipelines: 104(GETNEXT), 105(OPEN)
|  |  |  |  |
|  |  |  |  |--F137:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=40 plan-id=41 cohort-id=07
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |  |
|  |  |  |  |  209:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=118 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  |  in pipelines: 105(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F74:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  |  105:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=118 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 105(GETNEXT)
|  |  |  |  |
|  |  |  |  104:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF081[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=116 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 104(GETNEXT)
|  |  |  |
|  |  |  208:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 208(GETNEXT), 98(OPEN)
|  |  |  |
|  |  |  207:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_10.i_brand_id,tpcds_partitioned_parquet_snap.item_10.i_class_id,tpcds_partitioned_parquet_snap.item_10.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  F69:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  |  max-parallelism=1824 segment-costs=[20502959018, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  103:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  102:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=37
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=109,111,113 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 98(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--F134:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=37 plan-id=38 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  runtime filters: RF077[min_max] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  206:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=113 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 101(GETNEXT)
|  |  |  |  |
|  |  |  |  F71:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  101:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     runtime filters: RF069[min_max] -> tpcds_partitioned_parquet_snap.item_10.i_brand_id, RF070[min_max] -> tpcds_partitioned_parquet_snap.item_10.i_category_id, RF071[min_max] -> tpcds_partitioned_parquet_snap.item_10.i_class_id, RF066[bloom] -> tpcds_partitioned_parquet_snap.item_10.i_brand_id
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=113 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=38
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=109,111 row-size=16B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  |  |  |  in pipelines: 98(GETNEXT), 99(OPEN)
|  |  |  |
|  |  |  |--F135:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=38 plan-id=39 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  205:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=111 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 99(GETNEXT)
|  |  |  |  |
|  |  |  |  F70:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  99:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=111 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 99(GETNEXT)
|  |  |  |
|  |  |  98:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF077[min_max] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=109 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 98(GETNEXT)
|  |  |
|  |  204:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_class_id, tpcds_partitioned_parquet_snap.item_12.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 204(GETNEXT), 111(OPEN)
|  |  |
|  |  203:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_12.i_brand_id,tpcds_partitioned_parquet_snap.item_12.i_class_id,tpcds_partitioned_parquet_snap.item_12.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 111(GETNEXT)
|  |  |
|  |  F65:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186478425, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  116:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_class_id, tpcds_partitioned_parquet_snap.item_12.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 111(GETNEXT)
|  |  |
|  |  115:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=35
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=125,127,129 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 111(GETNEXT), 114(OPEN)
|  |  |
|  |  |--F132:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=35 plan-id=36 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  runtime filters: RF073[min_max] <- tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  202:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=129 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 114(GETNEXT)
|  |  |  |
|  |  |  F67:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  114:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     runtime filters: RF069[min_max] -> tpcds_partitioned_parquet_snap.item_12.i_brand_id, RF070[min_max] -> tpcds_partitioned_parquet_snap.item_12.i_category_id, RF071[min_max] -> tpcds_partitioned_parquet_snap.item_12.i_class_id, RF066[bloom] -> tpcds_partitioned_parquet_snap.item_12.i_brand_id
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=129 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 114(GETNEXT)
|  |  |
|  |  113:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=36
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=125,127 row-size=16B cardinality=2.16G(filtered from 2.16G) cost=945141101
|  |  |  in pipelines: 111(GETNEXT), 112(OPEN)
|  |  |
|  |  |--F133:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=36 plan-id=37 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  201:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=127 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 112(GETNEXT)
|  |  |  |
|  |  |  F66:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  112:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=127 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 112(GETNEXT)
|  |  |
|  |  111:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF073[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=125 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 111(GETNEXT)
|  |
|  94:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=41
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=103,105 row-size=28B cardinality=127.89M cost=55978696
|  |  in pipelines: 92(GETNEXT), 93(OPEN)
|  |
|  |--F138:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=41 plan-id=42 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  runtime filters: RF064[bloom] <- tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  200:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=105 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 93(GETNEXT)
|  |  |
|  |  F64:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  93:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=105 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 93(GETNEXT)
|  |
|  92:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF063[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk, RF061[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk, RF064[bloom] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=103 row-size=16B cardinality=127.89M(filtered from 2.16G) cost=29466510
|     in pipelines: 92(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=298.24K cost=53044
|  in pipelines: 163(GETNEXT), 193(GETNEXT)
|
|--91:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 04
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=85,101 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 193(GETNEXT), 198(OPEN)
|  |
|  |--F101:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  199:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=101 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 198(GETNEXT)
|  |  |
|  |  F61:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  198:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=101 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 198(GETNEXT), 90(OPEN)
|  |  |
|  |  197:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=100 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 90(GETNEXT)
|  |  |
|  |  F60:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  90:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=100 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 90(GETNEXT), 81(OPEN), 84(OPEN), 87(OPEN)
|  |  |
|  |  79:UNION
|  |  |  pass-through-operands: 80
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=99 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 81(GETNEXT), 84(GETNEXT), 87(GETNEXT)
|  |  |
|  |  |--89:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=07
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=95,97 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 87(GETNEXT), 88(OPEN)
|  |  |  |
|  |  |  |--F104:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=07 plan-id=08 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  196:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=97 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 88(GETNEXT)
|  |  |  |  |
|  |  |  |  F59:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  88:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=97 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 88(GETNEXT)
|  |  |  |
|  |  |  87:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=95 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 87(GETNEXT)
|  |  |
|  |  80:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=94 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 81(GETNEXT), 84(GETNEXT)
|  |  |
|  |  |--86:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=06
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=90,92 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 84(GETNEXT), 85(OPEN)
|  |  |  |
|  |  |  |--F103:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=06 plan-id=07 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  195:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=92 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 85(GETNEXT)
|  |  |  |  |
|  |  |  |  F56:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  85:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=92 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 85(GETNEXT)
|  |  |  |
|  |  |  84:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=90 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 84(GETNEXT)
|  |  |
|  |  83:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=86,88 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 81(GETNEXT), 82(OPEN)
|  |  |
|  |  |--F102:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  194:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=88 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 82(GETNEXT)
|  |  |  |
|  |  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  82:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=88 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 82(GETNEXT)
|  |  |
|  |  81:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=86 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 81(GETNEXT)
|  |
|  193:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=85 row-size=36B cardinality=149.12K cost=20286572
|  |  in pipelines: 193(GETNEXT), 47(OPEN)
|  |
|  192:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_8.i_brand_id,tpcds_partitioned_parquet_snap.item_8.i_class_id,tpcds_partitioned_parquet_snap.item_8.i_category_id)]
|  |  mem-estimate=11.56MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=85 row-size=36B cardinality=13.58M cost=3757663
|  |  in pipelines: 47(GETNEXT)
|  |
|  F31:PLAN FRAGMENT [RANDOM] hosts=10 instances=40 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=36.94MB mem-reservation=10.00MB thread-reservation=1
|  max-parallelism=40 segment-costs=[349622955, 38481081] cpu-comparison-result=399 [max(40 (self) vs 399 (sum children))]
|  78:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=85 row-size=36B cardinality=13.58M cost=98259532
|  |  in pipelines: 47(GETNEXT)
|  |
|  77:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=22
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=51,53,82,83 row-size=48B cardinality=25.46M cost=11145424
|  |  in pipelines: 47(GETNEXT), 76(OPEN)
|  |
|  |--F119:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=141.57MB mem-reservation=136.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=22 plan-id=23 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  runtime filters: RF031[min_max] <- tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  mem-estimate=136.00MB mem-reservation=136.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  191:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=83 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 76(GETNEXT)
|  |  |
|  |  F51:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  76:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=83 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 76(GETNEXT)
|  |
|  75:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=23
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=51,53,82 row-size=32B cardinality=25.47M cost=69975311
|  |  in pipelines: 47(GETNEXT), 189(OPEN)
|  |
|  |--F120:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=7.97MB mem-reservation=7.75MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[83840] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=23 plan-id=24 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  runtime filters: RF033[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |
|  |  190:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=82 row-size=4B cardinality=36.00K cost=47840
|  |  |  in pipelines: 189(GETNEXT)
|  |  |
|  |  F50:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_4.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.09MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[109051, 1166] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  189:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=82 row-size=4B cardinality=36.00K cost=104389
|  |  |  in pipelines: 189(GETNEXT), 186(OPEN)
|  |  |
|  |  188:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_4.i_item_sk)]
|  |  |  mem-estimate=94.06KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=82 row-size=4B cardinality=36.00K cost=4662
|  |  |  in pipelines: 186(GETNEXT)
|  |  |
|  |  F48:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 225660, 27820] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  74:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=82 row-size=4B cardinality=36.00K cost=104389
|  |  |  in pipelines: 186(GETNEXT)
|  |  |
|  |  73:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=24
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_4.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_4.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_4.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=81,55 row-size=36B cardinality=36.00K cost=121271
|  |  |  in pipelines: 186(GETNEXT), 50(OPEN)
|  |  |
|  |  |--F121:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=5.15MB mem-reservation=4.94MB thread-reservation=1 runtime-filters-memory=3.00MB
|  |  |  |  max-parallelism=10 segment-costs=[42649]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=24 plan-id=25 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_category_id, tpcds_partitioned_parquet_snap.item_4.i_class_id
|  |  |  |  runtime filters: RF036[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_brand_id, RF037[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_category_id, RF038[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_class_id, RF039[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_brand_id, RF040[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_category_id, RF041[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |  |
|  |  |  187:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_4.i_brand_id,tpcds_partitioned_parquet_snap.item_4.i_class_id,tpcds_partitioned_parquet_snap.item_4.i_category_id)]
|  |  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=55 row-size=16B cardinality=36.00K cost=6649
|  |  |  |  in pipelines: 50(GETNEXT)
|  |  |  |
|  |  |  F49:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[148701]
|  |  |  50:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_4.i_item_sk)
|  |  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_4.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=55 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 50(GETNEXT)
|  |  |
|  |  186:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=81 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 186(GETNEXT), 174(OPEN), 184(OPEN)
|  |  |
|  |  185:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=81 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 174(GETNEXT), 184(GETNEXT)
|  |  |
|  |  F47:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  72:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=81 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 174(GETNEXT), 184(GETNEXT)
|  |  |
|  |  51:UNION
|  |  |  pass-through-operands: 174
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=80 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 174(GETNEXT), 184(GETNEXT)
|  |  |
|  |  |--184:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=72 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 184(GETNEXT), 178(OPEN), 182(OPEN)
|  |  |  |
|  |  |  183:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=72 row-size=20B cardinality=298.24K cost=60572
|  |  |  |  in pipelines: 178(GETNEXT), 182(GETNEXT)
|  |  |  |
|  |  |  F45:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  |  65:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=72 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 178(GETNEXT), 182(GETNEXT)
|  |  |  |
|  |  |  52:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=71 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 178(GETNEXT), 182(GETNEXT)
|  |  |  |
|  |  |  |--182:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=70 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  |  in pipelines: 182(GETNEXT), 59(OPEN)
|  |  |  |  |
|  |  |  |  181:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_6.i_brand_id,tpcds_partitioned_parquet_snap.item_6.i_class_id,tpcds_partitioned_parquet_snap.item_6.i_category_id)]
|  |  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=70 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  |  in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  F41:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  |  max-parallelism=1030 segment-costs=[10292257811, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  |  64:AGGREGATE [STREAMING]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=70 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  |  in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  63:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=29
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=64,66,68 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 59(GETNEXT), 62(OPEN)
|  |  |  |  |
|  |  |  |  |--F126:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=29 plan-id=30 cohort-id=06
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  |  runtime filters: RF051[min_max] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |  |
|  |  |  |  |  180:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=68 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  |  in pipelines: 62(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F43:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  |  Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  |  62:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     runtime filters: RF039[min_max] -> tpcds_partitioned_parquet_snap.item_6.i_brand_id, RF040[min_max] -> tpcds_partitioned_parquet_snap.item_6.i_category_id, RF041[min_max] -> tpcds_partitioned_parquet_snap.item_6.i_class_id, RF036[bloom] -> tpcds_partitioned_parquet_snap.item_6.i_brand_id, RF037[bloom] -> tpcds_partitioned_parquet_snap.item_6.i_category_id, RF038[bloom] -> tpcds_partitioned_parquet_snap.item_6.i_class_id
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=68 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 62(GETNEXT)
|  |  |  |  |
|  |  |  |  61:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=30
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=64,66 row-size=16B cardinality=4.32G(filtered from 4.32G) cost=1890344358
|  |  |  |  |  in pipelines: 59(GETNEXT), 60(OPEN)
|  |  |  |  |
|  |  |  |  |--F127:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=30 plan-id=31 cohort-id=06
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |  |
|  |  |  |  |  179:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=66 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  |  in pipelines: 60(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F42:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  |  60:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=66 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 60(GETNEXT)
|  |  |  |  |
|  |  |  |  59:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF051[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=64 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |
|  |  |  178:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=63 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 178(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  177:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_5.i_brand_id,tpcds_partitioned_parquet_snap.item_5.i_class_id,tpcds_partitioned_parquet_snap.item_5.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=63 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  F37:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  |  max-parallelism=1824 segment-costs=[20502959018, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  58:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=63 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  57:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=27
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=57,59,61 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 53(GETNEXT), 56(OPEN)
|  |  |  |
|  |  |  |--F124:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=27 plan-id=28 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  runtime filters: RF047[min_max] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  176:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=61 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 56(GETNEXT)
|  |  |  |  |
|  |  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  56:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     runtime filters: RF039[min_max] -> tpcds_partitioned_parquet_snap.item_5.i_brand_id, RF040[min_max] -> tpcds_partitioned_parquet_snap.item_5.i_category_id, RF041[min_max] -> tpcds_partitioned_parquet_snap.item_5.i_class_id, RF036[bloom] -> tpcds_partitioned_parquet_snap.item_5.i_brand_id, RF037[bloom] -> tpcds_partitioned_parquet_snap.item_5.i_category_id, RF038[bloom] -> tpcds_partitioned_parquet_snap.item_5.i_class_id
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=61 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 56(GETNEXT)
|  |  |  |
|  |  |  55:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=28
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=57,59 row-size=16B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  |  |  |  in pipelines: 53(GETNEXT), 54(OPEN)
|  |  |  |
|  |  |  |--F125:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=28 plan-id=29 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  175:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=59 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |  |
|  |  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  54:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=59 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  53:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF047[min_max] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=57 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 53(GETNEXT)
|  |  |
|  |  174:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_class_id, tpcds_partitioned_parquet_snap.item_7.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=79 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 174(GETNEXT), 66(OPEN)
|  |  |
|  |  173:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_7.i_brand_id,tpcds_partitioned_parquet_snap.item_7.i_class_id,tpcds_partitioned_parquet_snap.item_7.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=79 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 66(GETNEXT)
|  |  |
|  |  F33:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186478425, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  71:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_class_id, tpcds_partitioned_parquet_snap.item_7.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=79 row-size=12B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 66(GETNEXT)
|  |  |
|  |  70:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=25
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=73,75,77 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 66(GETNEXT), 69(OPEN)
|  |  |
|  |  |--F122:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  runtime filters: RF043[min_max] <- tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  172:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=77 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 69(GETNEXT)
|  |  |  |
|  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  69:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     runtime filters: RF039[min_max] -> tpcds_partitioned_parquet_snap.item_7.i_brand_id, RF040[min_max] -> tpcds_partitioned_parquet_snap.item_7.i_category_id, RF041[min_max] -> tpcds_partitioned_parquet_snap.item_7.i_class_id, RF036[bloom] -> tpcds_partitioned_parquet_snap.item_7.i_brand_id, RF037[bloom] -> tpcds_partitioned_parquet_snap.item_7.i_category_id, RF038[bloom] -> tpcds_partitioned_parquet_snap.item_7.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=77 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 69(GETNEXT)
|  |  |
|  |  68:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=26
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=73,75 row-size=16B cardinality=2.16G(filtered from 2.16G) cost=945141101
|  |  |  in pipelines: 66(GETNEXT), 67(OPEN)
|  |  |
|  |  |--F123:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=26 plan-id=27 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  171:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 67(GETNEXT)
|  |  |  |
|  |  |  F34:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  67:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=75 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 67(GETNEXT)
|  |  |
|  |  66:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF043[min_max] -> tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=73 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 66(GETNEXT)
|  |
|  49:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=31
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=51,53 row-size=28B cardinality=254.82M cost=111533041
|  |  in pipelines: 47(GETNEXT), 48(OPEN)
|  |
|  |--F128:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=8.77MB mem-reservation=8.75MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=31 plan-id=32 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  runtime filters: RF034[bloom] <- tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  170:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=53 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 48(GETNEXT)
|  |  |
|  |  F32:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  48:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=53 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 48(GETNEXT)
|  |
|  47:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF033[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF034[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=51 row-size=16B cardinality=254.82M(filtered from 4.32G) cost=58709647
|     in pipelines: 47(GETNEXT)
|
46:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  join table id: 00
|  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=34,50 row-size=52B cardinality=149.12K cost=30554
|  in pipelines: 163(GETNEXT), 168(OPEN)
|
|--F97:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  169:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=50 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 168(GETNEXT)
|  |
|  F30:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  168:AGGREGATE [FINALIZE]
|  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=50 row-size=16B cardinality=1 cost=8
|  |  in pipelines: 168(GETNEXT), 45(OPEN)
|  |
|  167:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=49 row-size=16B cardinality=120 cost=22
|  |  in pipelines: 45(GETNEXT)
|  |
|  F29:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  45:AGGREGATE
|  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=49 row-size=16B cardinality=120 cost=1058398679
|  |  in pipelines: 45(GETNEXT), 36(OPEN), 39(OPEN), 42(OPEN)
|  |
|  34:UNION
|  |  pass-through-operands: 35
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=48 row-size=8B cardinality=15.12G cost=110287964
|  |  in pipelines: 36(GETNEXT), 39(GETNEXT), 42(GETNEXT)
|  |
|  |--44:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=44,46 row-size=20B cardinality=2.16G cost=945417979
|  |  |  in pipelines: 42(GETNEXT), 43(OPEN)
|  |  |
|  |  |--F100:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  166:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=46 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 43(GETNEXT)
|  |  |  |
|  |  |  F28:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  43:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=46 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 43(GETNEXT)
|  |  |
|  |  42:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=44 row-size=12B cardinality=2.16G cost=373242464
|  |     in pipelines: 42(GETNEXT)
|  |
|  35:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=43 row-size=8B cardinality=12.96G cost=661738272
|  |  in pipelines: 36(GETNEXT), 39(GETNEXT)
|  |
|  |--41:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=02
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=39,41 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  in pipelines: 39(GETNEXT), 40(OPEN)
|  |  |
|  |  |--F99:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  165:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=41 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 40(GETNEXT)
|  |  |  |
|  |  |  F25:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  40:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=41 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 40(GETNEXT)
|  |  |
|  |  39:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=39 row-size=12B cardinality=4.32G cost=746509474
|  |     in pipelines: 39(GETNEXT)
|  |
|  38:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=35,37 row-size=20B cardinality=8.64G cost=3781699633
|  |  in pipelines: 36(GETNEXT), 37(OPEN)
|  |
|  |--F98:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  164:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=37 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 37(GETNEXT)
|  |  |
|  |  F23:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  37:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=37 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 37(GETNEXT)
|  |
|  36:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=35 row-size=12B cardinality=8.64G cost=1492980801
|     in pipelines: 36(GETNEXT)
|
163:AGGREGATE [FINALIZE]
|  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count:merge()
|  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=34 row-size=36B cardinality=149.12K cost=25030787
|  in pipelines: 163(GETNEXT), 02(OPEN)
|
162:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_3.i_brand_id,tpcds_partitioned_parquet_snap.item_3.i_class_id,tpcds_partitioned_parquet_snap.item_3.i_category_id)]
|  mem-estimate=12.73MB mem-reservation=0B thread-reservation=0
|  tuple-ids=34 row-size=36B cardinality=16.87M cost=4666689
|  in pipelines: 02(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=70 (adjusted from 120)
Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
Per-Instance Resources: mem-estimate=36.94MB mem-reservation=17.00MB thread-reservation=1
max-parallelism=70 segment-costs=[654821526, 47790137] cpu-comparison-result=399 [max(70 (self) vs 399 (sum children))]
33:AGGREGATE [STREAMING]
|  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count()
|  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=34 row-size=36B cardinality=16.87M cost=150178249
|  in pipelines: 02(GETNEXT)
|
32:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=12
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,31,32 row-size=48B cardinality=51.11M cost=22375822
|  in pipelines: 02(GETNEXT), 31(OPEN)
|
|--F109:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=243.57MB mem-reservation=238.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=12 plan-id=13 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  runtime filters: RF001[min_max] <- tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=238.00MB mem-reservation=238.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  161:EXCHANGE [BROADCAST]
|  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=32 row-size=16B cardinality=360.00K cost=478440
|  |  in pipelines: 31(GETNEXT)
|  |
|  F20:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[106272]
|  31:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=32 row-size=16B cardinality=360.00K cost=82944
|     in pipelines: 31(GETNEXT)
|
30:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=13
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,31 row-size=32B cardinality=51.13M cost=140484124
|  in pipelines: 02(GETNEXT), 159(OPEN)
|
|--F110:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=13.78MB mem-reservation=13.56MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[83840] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  JOIN BUILD
|  |  join-table-id=13 plan-id=14 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF003[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=13.56MB mem-reservation=13.56MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |
|  160:EXCHANGE [BROADCAST]
|  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=4B cardinality=36.00K cost=47840
|  |  in pipelines: 159(GETNEXT)
|  |
|  F19:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=10.09MB mem-reservation=1.94MB thread-reservation=1
|  max-parallelism=10 segment-costs=[109051, 1166] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  159:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=31 row-size=4B cardinality=36.00K cost=104389
|  |  in pipelines: 159(GETNEXT), 156(OPEN)
|  |
|  158:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  mem-estimate=94.06KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=4B cardinality=36.00K cost=4662
|  |  in pipelines: 156(GETNEXT)
|  |
|  F17:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[2731445, 225660, 27820] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  29:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=31 row-size=4B cardinality=36.00K cost=104389
|  |  in pipelines: 156(GETNEXT)
|  |
|  28:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=14
|  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item.i_class_id
|  |  fk/pk conjuncts: assumed fk/pk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=30,4 row-size=36B cardinality=36.00K cost=121271
|  |  in pipelines: 156(GETNEXT), 05(OPEN)
|  |
|  |--F111:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=5.15MB mem-reservation=4.94MB thread-reservation=1 runtime-filters-memory=3.00MB
|  |  |  max-parallelism=10 segment-costs=[42649]
|  |  JOIN BUILD
|  |  |  join-table-id=14 plan-id=15 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_category_id, tpcds_partitioned_parquet_snap.item.i_class_id
|  |  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.item.i_brand_id, RF007[bloom] <- tpcds_partitioned_parquet_snap.item.i_category_id, RF008[bloom] <- tpcds_partitioned_parquet_snap.item.i_class_id, RF009[min_max] <- tpcds_partitioned_parquet_snap.item.i_brand_id, RF010[min_max] <- tpcds_partitioned_parquet_snap.item.i_category_id, RF011[min_max] <- tpcds_partitioned_parquet_snap.item.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |
|  |  157:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_brand_id,tpcds_partitioned_parquet_snap.item.i_class_id,tpcds_partitioned_parquet_snap.item.i_category_id)]
|  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=4 row-size=16B cardinality=36.00K cost=6649
|  |  |  in pipelines: 05(GETNEXT)
|  |  |
|  |  F18:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[148701]
|  |  05:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item.i_item_sk)
|  |     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item.i_item_sk)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=4 row-size=16B cardinality=36.00K cost=93060
|  |     in pipelines: 05(GETNEXT)
|  |
|  156:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=30 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 156(GETNEXT), 144(OPEN), 154(OPEN)
|  |
|  155:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=30 row-size=20B cardinality=447.36K cost=90858
|  |  in pipelines: 144(GETNEXT), 154(GETNEXT)
|  |
|  F16:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  27:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=30 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 144(GETNEXT), 154(GETNEXT)
|  |
|  06:UNION
|  |  pass-through-operands: 144
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=29 row-size=12B cardinality=447.36K cost=19009
|  |  in pipelines: 144(GETNEXT), 154(GETNEXT)
|  |
|  |--154:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 154(GETNEXT), 148(OPEN), 152(OPEN)
|  |  |
|  |  153:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=60572
|  |  |  in pipelines: 148(GETNEXT), 152(GETNEXT)
|  |  |
|  |  F14:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  20:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 148(GETNEXT), 152(GETNEXT)
|  |  |
|  |  07:UNION
|  |  |  pass-through-operands: all
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=20 row-size=12B cardinality=298.24K cost=0
|  |  |  in pipelines: 148(GETNEXT), 152(GETNEXT)
|  |  |
|  |  |--152:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=19 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 152(GETNEXT), 14(OPEN)
|  |  |  |
|  |  |  151:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_1.i_brand_id,tpcds_partitioned_parquet_snap.item_1.i_class_id,tpcds_partitioned_parquet_snap.item_1.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=19 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 14(GETNEXT)
|  |  |  |
|  |  |  F10:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  max-parallelism=1030 segment-costs=[10292257811, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  19:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=19 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  in pipelines: 14(GETNEXT)
|  |  |  |
|  |  |  18:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=19
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=13,15,17 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 14(GETNEXT), 17(OPEN)
|  |  |  |
|  |  |  |--F116:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=19 plan-id=20 cohort-id=05
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  |  runtime filters: RF021[min_max] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  150:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=17 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 17(GETNEXT)
|  |  |  |  |
|  |  |  |  F12:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  17:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     runtime filters: RF009[min_max] -> tpcds_partitioned_parquet_snap.item_1.i_brand_id, RF010[min_max] -> tpcds_partitioned_parquet_snap.item_1.i_category_id, RF011[min_max] -> tpcds_partitioned_parquet_snap.item_1.i_class_id, RF006[bloom] -> tpcds_partitioned_parquet_snap.item_1.i_brand_id, RF007[bloom] -> tpcds_partitioned_parquet_snap.item_1.i_category_id, RF008[bloom] -> tpcds_partitioned_parquet_snap.item_1.i_class_id
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=17 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  16:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=20
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=13,15 row-size=16B cardinality=4.32G(filtered from 4.32G) cost=1890344358
|  |  |  |  in pipelines: 14(GETNEXT), 15(OPEN)
|  |  |  |
|  |  |  |--F117:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=20 plan-id=21 cohort-id=05
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  149:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=15 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 15(GETNEXT)
|  |  |  |  |
|  |  |  |  F11:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  15:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=15 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 15(GETNEXT)
|  |  |  |
|  |  |  14:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF021[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=13 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 14(GETNEXT)
|  |  |
|  |  148:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=12 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 148(GETNEXT), 08(OPEN)
|  |  |
|  |  147:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_0.i_brand_id,tpcds_partitioned_parquet_snap.item_0.i_class_id,tpcds_partitioned_parquet_snap.item_0.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=12 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 08(GETNEXT)
|  |  |
|  |  F06:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[20502959018, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  13:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=12 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  in pipelines: 08(GETNEXT)
|  |  |
|  |  12:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=17
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=6,8,10 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 08(GETNEXT), 11(OPEN)
|  |  |
|  |  |--F114:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=17 plan-id=18 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  runtime filters: RF017[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  146:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=10 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 11(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     runtime filters: RF009[min_max] -> tpcds_partitioned_parquet_snap.item_0.i_brand_id, RF010[min_max] -> tpcds_partitioned_parquet_snap.item_0.i_category_id, RF011[min_max] -> tpcds_partitioned_parquet_snap.item_0.i_class_id, RF006[bloom] -> tpcds_partitioned_parquet_snap.item_0.i_brand_id, RF007[bloom] -> tpcds_partitioned_parquet_snap.item_0.i_category_id, RF008[bloom] -> tpcds_partitioned_parquet_snap.item_0.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=10 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 11(GETNEXT)
|  |  |
|  |  10:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=18
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=6,8 row-size=16B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  |  |  in pipelines: 08(GETNEXT), 09(OPEN)
|  |  |
|  |  |--F115:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=18 plan-id=19 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  145:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=8 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 09(GETNEXT)
|  |  |  |
|  |  |  F07:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  09:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=8 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 09(GETNEXT)
|  |  |
|  |  08:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF017[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=6 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 08(GETNEXT)
|  |
|  144:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=28 row-size=12B cardinality=149.12K cost=25263984
|  |  in pipelines: 144(GETNEXT), 21(OPEN)
|  |
|  143:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_2.i_brand_id,tpcds_partitioned_parquet_snap.item_2.i_class_id,tpcds_partitioned_parquet_snap.item_2.i_category_id)]
|  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=28 row-size=12B cardinality=17.89M cost=2975838
|  |  in pipelines: 21(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  max-parallelism=520 segment-costs=[5186478425, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  26:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=28 row-size=12B cardinality=17.89M cost=3047563509
|  |  in pipelines: 21(GETNEXT)
|  |
|  25:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=15
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=22,24,26 row-size=32B cardinality=2.16G cost=944945506
|  |  in pipelines: 21(GETNEXT), 24(OPEN)
|  |
|  |--F112:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=15 plan-id=16 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  runtime filters: RF013[min_max] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  142:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=26 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 24(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  24:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF009[min_max] -> tpcds_partitioned_parquet_snap.item_2.i_brand_id, RF010[min_max] -> tpcds_partitioned_parquet_snap.item_2.i_category_id, RF011[min_max] -> tpcds_partitioned_parquet_snap.item_2.i_class_id, RF006[bloom] -> tpcds_partitioned_parquet_snap.item_2.i_brand_id, RF007[bloom] -> tpcds_partitioned_parquet_snap.item_2.i_category_id, RF008[bloom] -> tpcds_partitioned_parquet_snap.item_2.i_class_id
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=26 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 24(GETNEXT)
|  |
|  23:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=16
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=22,24 row-size=16B cardinality=2.16G(filtered from 2.16G) cost=945141101
|  |  in pipelines: 21(GETNEXT), 22(OPEN)
|  |
|  |--F113:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=16 plan-id=17 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  141:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=24 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 22(GETNEXT)
|  |  |
|  |  F03:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  22:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=24 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 22(GETNEXT)
|  |
|  21:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF013[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=22 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|     in pipelines: 21(GETNEXT)
|
04:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=21
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=28B cardinality=511.58M cost=223916426
|  in pipelines: 02(GETNEXT), 03(OPEN)
|
|--F118:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=14.58MB mem-reservation=14.56MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[248]
|  JOIN BUILD
|  |  join-table-id=21 plan-id=22 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=13.56MB mem-reservation=13.56MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |
|  140:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=108 cost=140
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[16733]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108 cost=16728
|     in pipelines: 03(GETNEXT)
|
02:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=16B cardinality=511.58M(filtered from 8.64G) cost=117866905
   in pipelines: 02(GETNEXT)
---- PARALLELPLANS
Max Per-Host Resource Reservation: Memory=10.73GB Threads=325
Per-Host Resource Estimates: Memory=29.41GB
F96:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.05MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[634] cpu-comparison-result=1557 [max(1 (self) vs 1557 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END, aggif(valid_tid(155,156,157,158,159) IN (155, 156, 157, 158, 159), CASE valid_tid(155,156,157,158,159) WHEN 155 THEN sum(SALES) WHEN 156 THEN sum(SALES) WHEN 157 THEN sum(SALES) WHEN 158 THEN sum(SALES) WHEN 159 THEN sum(SALES) END), aggif(valid_tid(155,156,157,158,159) IN (155, 156, 157, 158, 159), CASE valid_tid(155,156,157,158,159) WHEN 155 THEN sum(NUMBER_SALES) WHEN 156 THEN sum(NUMBER_SALES) WHEN 157 THEN sum(NUMBER_SALES) WHEN 158 THEN sum(NUMBER_SALES) WHEN 159 THEN sum(NUMBER_SALES) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
232:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST
|  limit: 100
|  mem-estimate=51.25KB mem-reservation=0B thread-reservation=0
|  tuple-ids=161 row-size=48B cardinality=100 cost=34
|  in pipelines: 139(GETNEXT)
|
F95:PLAN FRAGMENT [HASH(CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(CHANNEL) WHEN 156 THEN murmur_hash(CHANNEL) WHEN 157 THEN murmur_hash(CHANNEL) WHEN 158 THEN murmur_hash(CHANNEL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_BRAND_ID) WHEN 156 THEN murmur_hash(I_BRAND_ID) WHEN 157 THEN murmur_hash(I_BRAND_ID) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CLASS_ID) WHEN 156 THEN murmur_hash(I_CLASS_ID) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CATEGORY_ID) WHEN 156 THEN murmur_hash(NULL) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=650.00MB mem-reservation=171.94MB thread-reservation=1
max-parallelism=10 segment-costs=[13125702, 10687615, 20955666, 157] cpu-comparison-result=1557 [max(10 (self) vs 1557 (sum children))]
139:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(155,156,157,158,159) WHEN 155 THEN CHANNEL WHEN 156 THEN CHANNEL WHEN 157 THEN CHANNEL WHEN 158 THEN CHANNEL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_BRAND_ID WHEN 156 THEN I_BRAND_ID WHEN 157 THEN I_BRAND_ID WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CLASS_ID WHEN 156 THEN I_CLASS_ID WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST, CASE valid_tid(155,156,157,158,159) WHEN 155 THEN I_CATEGORY_ID WHEN 156 THEN NULL WHEN 157 THEN NULL WHEN 158 THEN NULL WHEN 159 THEN NULL END ASC NULLS LAST
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=161 row-size=48B cardinality=100 cost=20955666
|  in pipelines: 139(GETNEXT), 138(OPEN)
|
138:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(155,156,157,158,159) IN (CAST(155 AS INT), CAST(156 AS INT), CAST(157 AS INT), CAST(158 AS INT), CAST(159 AS INT)), CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN sum(SALES) WHEN CAST(156 AS INT) THEN sum(SALES) WHEN CAST(157 AS INT) THEN sum(SALES) WHEN CAST(158 AS INT) THEN sum(SALES) WHEN CAST(159 AS INT) THEN sum(SALES) END), aggif(valid_tid(155,156,157,158,159) IN (CAST(155 AS INT), CAST(156 AS INT), CAST(157 AS INT), CAST(158 AS INT), CAST(159 AS INT)), CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(156 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(157 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(158 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(159 AS INT) THEN sum(NUMBER_SALES) END)
|  group by: CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN CHANNEL WHEN CAST(156 AS INT) THEN CHANNEL WHEN CAST(157 AS INT) THEN CHANNEL WHEN CAST(158 AS INT) THEN CHANNEL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_BRAND_ID WHEN CAST(156 AS INT) THEN I_BRAND_ID WHEN CAST(157 AS INT) THEN I_BRAND_ID WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_CLASS_ID WHEN CAST(156 AS INT) THEN I_CLASS_ID WHEN CAST(157 AS INT) THEN NULL WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN I_CATEGORY_ID WHEN CAST(156 AS INT) THEN NULL WHEN CAST(157 AS INT) THEN NULL WHEN CAST(158 AS INT) THEN NULL WHEN CAST(159 AS INT) THEN NULL END, CASE valid_tid(155,156,157,158,159) WHEN CAST(155 AS INT) THEN CAST(155 AS INT) WHEN CAST(156 AS INT) THEN CAST(156 AS INT) WHEN CAST(157 AS INT) THEN CAST(157 AS INT) WHEN CAST(158 AS INT) THEN CAST(158 AS INT) WHEN CAST(159 AS INT) THEN CAST(159 AS INT) END
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=160 row-size=52B cardinality=1.79M cost=10687615
|  in pipelines: 138(GETNEXT), 231(OPEN)
|
231:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=1.79M cost=10687785
|  in pipelines: 231(GETNEXT), 163(OPEN), 193(OPEN), 223(OPEN)
|
230:EXCHANGE [HASH(CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(CHANNEL) WHEN 156 THEN murmur_hash(CHANNEL) WHEN 157 THEN murmur_hash(CHANNEL) WHEN 158 THEN murmur_hash(CHANNEL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_BRAND_ID) WHEN 156 THEN murmur_hash(I_BRAND_ID) WHEN 157 THEN murmur_hash(I_BRAND_ID) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CLASS_ID) WHEN 156 THEN murmur_hash(I_CLASS_ID) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END,CASE valid_tid(155,156,157,158,159) WHEN 155 THEN murmur_hash(I_CATEGORY_ID) WHEN 156 THEN murmur_hash(NULL) WHEN 157 THEN murmur_hash(NULL) WHEN 158 THEN murmur_hash(NULL) WHEN 159 THEN murmur_hash(NULL) END)]
|  mem-estimate=27.77MB mem-reservation=0B thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=1.79M cost=2437917
|  in pipelines: 163(GETNEXT), 193(GETNEXT), 223(GETNEXT)
|
F94:PLAN FRAGMENT [RANDOM] hosts=10 instances=70 (adjusted from 120)
Per-Instance Resources: mem-estimate=554.89MB mem-reservation=146.50MB thread-reservation=1
max-parallelism=70 segment-costs=[29697476, 24044235, 16389428, 11505411, 32269345] cpu-comparison-result=1557 [max(70 (self) vs 1557 (sum children))]
137:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=138.00MB thread-reservation=0
|  tuple-ids=155N,156N,157N,158N,159N row-size=240B cardinality=1.79M cost=11334183
|  in pipelines: 163(GETNEXT), 193(GETNEXT), 223(GETNEXT)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=154 row-size=48B cardinality=447.36K cost=26522
|  in pipelines: 163(GETNEXT), 193(GETNEXT), 223(GETNEXT)
|
|--136:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 08
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=137,153 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 223(GETNEXT), 228(OPEN)
|  |
|  |--F105:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  229:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=153 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 228(GETNEXT)
|  |  |
|  |  F93:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  228:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=153 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 228(GETNEXT), 135(OPEN)
|  |  |
|  |  227:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=152 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 135(GETNEXT)
|  |  |
|  |  F92:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  135:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=152 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 135(GETNEXT), 126(OPEN), 129(OPEN), 132(OPEN)
|  |  |
|  |  124:UNION
|  |  |  pass-through-operands: 125
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=151 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 126(GETNEXT), 129(GETNEXT), 132(GETNEXT)
|  |  |
|  |  |--134:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=11
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=147,149 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 132(GETNEXT), 133(OPEN)
|  |  |  |
|  |  |  |--F108:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=11 plan-id=12 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  226:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=149 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 133(GETNEXT)
|  |  |  |  |
|  |  |  |  F91:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  133:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=149 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 133(GETNEXT)
|  |  |  |
|  |  |  132:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=147 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 132(GETNEXT)
|  |  |
|  |  125:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=146 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 126(GETNEXT), 129(GETNEXT)
|  |  |
|  |  |--131:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=10
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=142,144 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 129(GETNEXT), 130(OPEN)
|  |  |  |
|  |  |  |--F107:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=10 plan-id=11 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  225:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=144 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 130(GETNEXT)
|  |  |  |  |
|  |  |  |  F88:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  130:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=144 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 130(GETNEXT)
|  |  |  |
|  |  |  129:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=142 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 129(GETNEXT)
|  |  |
|  |  128:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=09
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=138,140 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 126(GETNEXT), 127(OPEN)
|  |  |
|  |  |--F106:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=09 plan-id=10 cohort-id=04
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  224:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=140 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 127(GETNEXT)
|  |  |  |
|  |  |  F86:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  127:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=140 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 127(GETNEXT)
|  |  |
|  |  126:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=138 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 126(GETNEXT)
|  |
|  223:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=137 row-size=36B cardinality=149.12K cost=13862637
|  |  in pipelines: 223(GETNEXT), 92(OPEN)
|  |
|  222:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_13.i_brand_id,tpcds_partitioned_parquet_snap.item_13.i_class_id,tpcds_partitioned_parquet_snap.item_13.i_category_id)]
|  |  mem-estimate=10.78MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=137 row-size=36B cardinality=9.13M cost=2526791
|  |  in pipelines: 92(GETNEXT)
|  |
|  F63:PLAN FRAGMENT [RANDOM] hosts=10 instances=20 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=36.94MB mem-reservation=9.12MB thread-reservation=1
|  max-parallelism=20 segment-costs=[185964162, 25876095] cpu-comparison-result=399 [max(20 (self) vs 399 (sum children))]
|  123:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.web_sales_3.ws_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.web_sales_3.ws_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=137 row-size=36B cardinality=9.13M cost=59804269
|  |  in pipelines: 92(GETNEXT)
|  |
|  122:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=32
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=103,105,134,135 row-size=48B cardinality=12.78M cost=5593914
|  |  in pipelines: 92(GETNEXT), 121(OPEN)
|  |
|  |--F129:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=73.57MB mem-reservation=68.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=32 plan-id=33 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  runtime filters: RF061[min_max] <- tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  mem-estimate=68.00MB mem-reservation=68.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  221:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=135 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 121(GETNEXT)
|  |  |
|  |  F83:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  121:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=135 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 121(GETNEXT)
|  |
|  120:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=33
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=103,105,134 row-size=32B cardinality=12.78M cost=35120773
|  |  in pipelines: 92(GETNEXT), 219(OPEN)
|  |
|  |--F130:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=4.09MB mem-reservation=3.88MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[83840] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=33 plan-id=34 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  runtime filters: RF063[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |
|  |  220:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=134 row-size=4B cardinality=36.00K cost=47840
|  |  |  in pipelines: 219(GETNEXT)
|  |  |
|  |  F82:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_9.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.09MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[109051, 1166] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  219:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=134 row-size=4B cardinality=36.00K cost=104389
|  |  |  in pipelines: 219(GETNEXT), 216(OPEN)
|  |  |
|  |  218:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_9.i_item_sk)]
|  |  |  mem-estimate=94.06KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=134 row-size=4B cardinality=36.00K cost=4662
|  |  |  in pipelines: 216(GETNEXT)
|  |  |
|  |  F80:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 225660, 27820] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  119:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=134 row-size=4B cardinality=36.00K cost=104389
|  |  |  in pipelines: 216(GETNEXT)
|  |  |
|  |  118:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=34
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_9.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_9.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_9.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=133,107 row-size=36B cardinality=36.00K cost=121271
|  |  |  in pipelines: 216(GETNEXT), 95(OPEN)
|  |  |
|  |  |--F131:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=3.15MB mem-reservation=2.94MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[42649]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=34 plan-id=35 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_category_id, tpcds_partitioned_parquet_snap.item_9.i_class_id
|  |  |  |  runtime filters: RF066[bloom] <- tpcds_partitioned_parquet_snap.item_9.i_brand_id, RF069[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_brand_id, RF070[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_category_id, RF071[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |  |
|  |  |  217:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_9.i_brand_id,tpcds_partitioned_parquet_snap.item_9.i_class_id,tpcds_partitioned_parquet_snap.item_9.i_category_id)]
|  |  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=107 row-size=16B cardinality=36.00K cost=6649
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  F81:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[148701]
|  |  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_9.i_item_sk)
|  |  |     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_9.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=107 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  216:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 216(GETNEXT), 204(OPEN), 214(OPEN)
|  |  |
|  |  215:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 204(GETNEXT), 214(GETNEXT)
|  |  |
|  |  F79:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  117:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=133 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 204(GETNEXT), 214(GETNEXT)
|  |  |
|  |  96:UNION
|  |  |  pass-through-operands: 204
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=132 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 204(GETNEXT), 214(GETNEXT)
|  |  |
|  |  |--214:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 214(GETNEXT), 208(OPEN), 212(OPEN)
|  |  |  |
|  |  |  213:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=60572
|  |  |  |  in pipelines: 208(GETNEXT), 212(GETNEXT)
|  |  |  |
|  |  |  F77:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  |  110:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 208(GETNEXT), 212(GETNEXT)
|  |  |  |
|  |  |  97:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=123 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 208(GETNEXT), 212(GETNEXT)
|  |  |  |
|  |  |  |--212:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  |  in pipelines: 212(GETNEXT), 104(OPEN)
|  |  |  |  |
|  |  |  |  211:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_11.i_brand_id,tpcds_partitioned_parquet_snap.item_11.i_class_id,tpcds_partitioned_parquet_snap.item_11.i_category_id)]
|  |  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  |  in pipelines: 104(GETNEXT)
|  |  |  |  |
|  |  |  |  F73:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  |  max-parallelism=1030 segment-costs=[10292257811, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  |  109:AGGREGATE [STREAMING]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=122 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  |  in pipelines: 104(GETNEXT)
|  |  |  |  |
|  |  |  |  108:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=39
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=116,118,120 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 104(GETNEXT), 107(OPEN)
|  |  |  |  |
|  |  |  |  |--F136:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=39 plan-id=40 cohort-id=07
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  |  runtime filters: RF081[min_max] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |  |
|  |  |  |  |  210:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=120 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  |  in pipelines: 107(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F75:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  |  107:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     runtime filters: RF069[min_max] -> tpcds_partitioned_parquet_snap.item_11.i_brand_id, RF070[min_max] -> tpcds_partitioned_parquet_snap.item_11.i_category_id, RF071[min_max] -> tpcds_partitioned_parquet_snap.item_11.i_class_id, RF066[bloom] -> tpcds_partitioned_parquet_snap.item_11.i_brand_id
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=120 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 107(GETNEXT)
|  |  |  |  |
|  |  |  |  106:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=40
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=116,118 row-size=16B cardinality=4.32G(filtered from 4.32G) cost=1890344358
|  |  |  |  |  in pipelines: 104(GETNEXT), 105(OPEN)
|  |  |  |  |
|  |  |  |  |--F137:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=40 plan-id=41 cohort-id=07
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |  |
|  |  |  |  |  209:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=118 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  |  in pipelines: 105(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F74:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  |  105:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=118 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 105(GETNEXT)
|  |  |  |  |
|  |  |  |  104:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF081[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=116 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 104(GETNEXT)
|  |  |  |
|  |  |  208:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 208(GETNEXT), 98(OPEN)
|  |  |  |
|  |  |  207:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_10.i_brand_id,tpcds_partitioned_parquet_snap.item_10.i_class_id,tpcds_partitioned_parquet_snap.item_10.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  F69:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  |  max-parallelism=1824 segment-costs=[20502959018, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  103:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=115 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  102:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=37
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=109,111,113 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 98(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--F134:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=37 plan-id=38 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  runtime filters: RF077[min_max] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  206:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=113 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 101(GETNEXT)
|  |  |  |  |
|  |  |  |  F71:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  101:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     runtime filters: RF069[min_max] -> tpcds_partitioned_parquet_snap.item_10.i_brand_id, RF070[min_max] -> tpcds_partitioned_parquet_snap.item_10.i_category_id, RF071[min_max] -> tpcds_partitioned_parquet_snap.item_10.i_class_id, RF066[bloom] -> tpcds_partitioned_parquet_snap.item_10.i_brand_id
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=113 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=38
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=109,111 row-size=16B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  |  |  |  in pipelines: 98(GETNEXT), 99(OPEN)
|  |  |  |
|  |  |  |--F135:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=38 plan-id=39 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  205:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=111 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 99(GETNEXT)
|  |  |  |  |
|  |  |  |  F70:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  99:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=111 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 99(GETNEXT)
|  |  |  |
|  |  |  98:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF077[min_max] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=109 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 98(GETNEXT)
|  |  |
|  |  204:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_class_id, tpcds_partitioned_parquet_snap.item_12.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 204(GETNEXT), 111(OPEN)
|  |  |
|  |  203:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_12.i_brand_id,tpcds_partitioned_parquet_snap.item_12.i_class_id,tpcds_partitioned_parquet_snap.item_12.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 111(GETNEXT)
|  |  |
|  |  F65:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186478425, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  116:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_class_id, tpcds_partitioned_parquet_snap.item_12.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=131 row-size=12B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 111(GETNEXT)
|  |  |
|  |  115:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=35
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=125,127,129 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 111(GETNEXT), 114(OPEN)
|  |  |
|  |  |--F132:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=35 plan-id=36 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  runtime filters: RF073[min_max] <- tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  202:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=129 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 114(GETNEXT)
|  |  |  |
|  |  |  F67:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  114:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     runtime filters: RF069[min_max] -> tpcds_partitioned_parquet_snap.item_12.i_brand_id, RF070[min_max] -> tpcds_partitioned_parquet_snap.item_12.i_category_id, RF071[min_max] -> tpcds_partitioned_parquet_snap.item_12.i_class_id, RF066[bloom] -> tpcds_partitioned_parquet_snap.item_12.i_brand_id
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=129 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 114(GETNEXT)
|  |  |
|  |  113:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=36
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=125,127 row-size=16B cardinality=2.16G(filtered from 2.16G) cost=945141101
|  |  |  in pipelines: 111(GETNEXT), 112(OPEN)
|  |  |
|  |  |--F133:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=36 plan-id=37 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  201:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=127 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 112(GETNEXT)
|  |  |  |
|  |  |  F66:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  112:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=127 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 112(GETNEXT)
|  |  |
|  |  111:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF073[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=125 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 111(GETNEXT)
|  |
|  94:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=41
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=103,105 row-size=28B cardinality=127.89M cost=55978696
|  |  in pipelines: 92(GETNEXT), 93(OPEN)
|  |
|  |--F138:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=41 plan-id=42 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  runtime filters: RF064[bloom] <- tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  200:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=105 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 93(GETNEXT)
|  |  |
|  |  F64:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  93:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=105 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 93(GETNEXT)
|  |
|  92:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF063[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk, RF061[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk, RF064[bloom] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=103 row-size=16B cardinality=127.89M(filtered from 2.16G) cost=29466510
|     in pipelines: 92(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=298.24K cost=53044
|  in pipelines: 163(GETNEXT), 193(GETNEXT)
|
|--91:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 04
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=85,101 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 193(GETNEXT), 198(OPEN)
|  |
|  |--F101:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  199:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=101 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 198(GETNEXT)
|  |  |
|  |  F61:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  198:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=101 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 198(GETNEXT), 90(OPEN)
|  |  |
|  |  197:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=100 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 90(GETNEXT)
|  |  |
|  |  F60:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  90:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=100 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 90(GETNEXT), 81(OPEN), 84(OPEN), 87(OPEN)
|  |  |
|  |  79:UNION
|  |  |  pass-through-operands: 80
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=99 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 81(GETNEXT), 84(GETNEXT), 87(GETNEXT)
|  |  |
|  |  |--89:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=07
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=95,97 row-size=20B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 87(GETNEXT), 88(OPEN)
|  |  |  |
|  |  |  |--F104:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=07 plan-id=08 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  196:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=97 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 88(GETNEXT)
|  |  |  |  |
|  |  |  |  F59:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  88:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=97 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 88(GETNEXT)
|  |  |  |
|  |  |  87:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=95 row-size=12B cardinality=2.16G cost=373242464
|  |  |     in pipelines: 87(GETNEXT)
|  |  |
|  |  80:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=94 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 81(GETNEXT), 84(GETNEXT)
|  |  |
|  |  |--86:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=06
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=90,92 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 84(GETNEXT), 85(OPEN)
|  |  |  |
|  |  |  |--F103:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=06 plan-id=07 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  195:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=92 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 85(GETNEXT)
|  |  |  |  |
|  |  |  |  F56:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  85:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=92 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 85(GETNEXT)
|  |  |  |
|  |  |  84:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=90 row-size=12B cardinality=4.32G cost=746509474
|  |  |     in pipelines: 84(GETNEXT)
|  |  |
|  |  83:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=86,88 row-size=20B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 81(GETNEXT), 82(OPEN)
|  |  |
|  |  |--F102:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  194:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=88 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 82(GETNEXT)
|  |  |  |
|  |  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  82:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=88 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 82(GETNEXT)
|  |  |
|  |  81:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=86 row-size=12B cardinality=8.64G cost=1492980801
|  |     in pipelines: 81(GETNEXT)
|  |
|  193:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=85 row-size=36B cardinality=149.12K cost=20286572
|  |  in pipelines: 193(GETNEXT), 47(OPEN)
|  |
|  192:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_8.i_brand_id,tpcds_partitioned_parquet_snap.item_8.i_class_id,tpcds_partitioned_parquet_snap.item_8.i_category_id)]
|  |  mem-estimate=11.56MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=85 row-size=36B cardinality=13.58M cost=3757663
|  |  in pipelines: 47(GETNEXT)
|  |
|  F31:PLAN FRAGMENT [RANDOM] hosts=10 instances=40 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=36.94MB mem-reservation=10.00MB thread-reservation=1
|  max-parallelism=40 segment-costs=[349622955, 38481081] cpu-comparison-result=399 [max(40 (self) vs 399 (sum children))]
|  78:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=85 row-size=36B cardinality=13.58M cost=98259532
|  |  in pipelines: 47(GETNEXT)
|  |
|  77:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=22
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=51,53,82,83 row-size=48B cardinality=25.46M cost=11145424
|  |  in pipelines: 47(GETNEXT), 76(OPEN)
|  |
|  |--F119:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=141.57MB mem-reservation=136.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=22 plan-id=23 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  runtime filters: RF031[min_max] <- tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  mem-estimate=136.00MB mem-reservation=136.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  191:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=83 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 76(GETNEXT)
|  |  |
|  |  F51:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  76:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=83 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 76(GETNEXT)
|  |
|  75:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=23
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=51,53,82 row-size=32B cardinality=25.47M cost=69975311
|  |  in pipelines: 47(GETNEXT), 189(OPEN)
|  |
|  |--F120:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=7.97MB mem-reservation=7.75MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[83840] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=23 plan-id=24 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  runtime filters: RF033[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |
|  |  190:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=82 row-size=4B cardinality=36.00K cost=47840
|  |  |  in pipelines: 189(GETNEXT)
|  |  |
|  |  F50:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_4.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.09MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[109051, 1166] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  189:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=82 row-size=4B cardinality=36.00K cost=104389
|  |  |  in pipelines: 189(GETNEXT), 186(OPEN)
|  |  |
|  |  188:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_4.i_item_sk)]
|  |  |  mem-estimate=94.06KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=82 row-size=4B cardinality=36.00K cost=4662
|  |  |  in pipelines: 186(GETNEXT)
|  |  |
|  |  F48:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 225660, 27820] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  74:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=82 row-size=4B cardinality=36.00K cost=104389
|  |  |  in pipelines: 186(GETNEXT)
|  |  |
|  |  73:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=24
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_4.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_4.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_4.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=81,55 row-size=36B cardinality=36.00K cost=121271
|  |  |  in pipelines: 186(GETNEXT), 50(OPEN)
|  |  |
|  |  |--F121:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=5.15MB mem-reservation=4.94MB thread-reservation=1 runtime-filters-memory=3.00MB
|  |  |  |  max-parallelism=10 segment-costs=[42649]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=24 plan-id=25 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_category_id, tpcds_partitioned_parquet_snap.item_4.i_class_id
|  |  |  |  runtime filters: RF036[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_brand_id, RF037[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_category_id, RF038[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_class_id, RF039[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_brand_id, RF040[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_category_id, RF041[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |  |
|  |  |  187:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_4.i_brand_id,tpcds_partitioned_parquet_snap.item_4.i_class_id,tpcds_partitioned_parquet_snap.item_4.i_category_id)]
|  |  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=55 row-size=16B cardinality=36.00K cost=6649
|  |  |  |  in pipelines: 50(GETNEXT)
|  |  |  |
|  |  |  F49:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[148701]
|  |  |  50:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_4.i_item_sk)
|  |  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item_4.i_item_sk)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=55 row-size=16B cardinality=36.00K cost=93060
|  |  |     in pipelines: 50(GETNEXT)
|  |  |
|  |  186:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=81 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 186(GETNEXT), 174(OPEN), 184(OPEN)
|  |  |
|  |  185:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=81 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 174(GETNEXT), 184(GETNEXT)
|  |  |
|  |  F47:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  72:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=81 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 174(GETNEXT), 184(GETNEXT)
|  |  |
|  |  51:UNION
|  |  |  pass-through-operands: 174
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=80 row-size=12B cardinality=447.36K cost=19009
|  |  |  in pipelines: 174(GETNEXT), 184(GETNEXT)
|  |  |
|  |  |--184:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=72 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 184(GETNEXT), 178(OPEN), 182(OPEN)
|  |  |  |
|  |  |  183:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=72 row-size=20B cardinality=298.24K cost=60572
|  |  |  |  in pipelines: 178(GETNEXT), 182(GETNEXT)
|  |  |  |
|  |  |  F45:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  |  65:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=72 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 178(GETNEXT), 182(GETNEXT)
|  |  |  |
|  |  |  52:UNION
|  |  |  |  pass-through-operands: all
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=71 row-size=12B cardinality=298.24K cost=0
|  |  |  |  in pipelines: 178(GETNEXT), 182(GETNEXT)
|  |  |  |
|  |  |  |--182:AGGREGATE [FINALIZE]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=70 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  |  in pipelines: 182(GETNEXT), 59(OPEN)
|  |  |  |  |
|  |  |  |  181:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_6.i_brand_id,tpcds_partitioned_parquet_snap.item_6.i_class_id,tpcds_partitioned_parquet_snap.item_6.i_category_id)]
|  |  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=70 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  |  in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  F41:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  |  max-parallelism=1030 segment-costs=[10292257811, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  |  64:AGGREGATE [STREAMING]
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=70 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  |  in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  63:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=29
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=64,66,68 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  |  in pipelines: 59(GETNEXT), 62(OPEN)
|  |  |  |  |
|  |  |  |  |--F126:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=29 plan-id=30 cohort-id=06
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  |  runtime filters: RF051[min_max] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |  |
|  |  |  |  |  180:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=68 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  |  in pipelines: 62(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F43:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  |  Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  |  62:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     runtime filters: RF039[min_max] -> tpcds_partitioned_parquet_snap.item_6.i_brand_id, RF040[min_max] -> tpcds_partitioned_parquet_snap.item_6.i_category_id, RF041[min_max] -> tpcds_partitioned_parquet_snap.item_6.i_class_id, RF036[bloom] -> tpcds_partitioned_parquet_snap.item_6.i_brand_id, RF037[bloom] -> tpcds_partitioned_parquet_snap.item_6.i_category_id, RF038[bloom] -> tpcds_partitioned_parquet_snap.item_6.i_class_id
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=68 row-size=16B cardinality=360.00K cost=82944
|  |  |  |  |     in pipelines: 62(GETNEXT)
|  |  |  |  |
|  |  |  |  61:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  |  hash-table-id=30
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=64,66 row-size=16B cardinality=4.32G(filtered from 4.32G) cost=1890344358
|  |  |  |  |  in pipelines: 59(GETNEXT), 60(OPEN)
|  |  |  |  |
|  |  |  |  |--F127:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  |  JOIN BUILD
|  |  |  |  |  |  join-table-id=30 plan-id=31 cohort-id=06
|  |  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |  |
|  |  |  |  |  179:EXCHANGE [BROADCAST]
|  |  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  |  tuple-ids=66 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  |  in pipelines: 60(GETNEXT)
|  |  |  |  |  |
|  |  |  |  |  F42:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  |  60:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=66 row-size=8B cardinality=7.30K cost=12520
|  |  |  |  |     in pipelines: 60(GETNEXT)
|  |  |  |  |
|  |  |  |  59:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF051[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=64 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |
|  |  |  178:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=63 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 178(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  177:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_5.i_brand_id,tpcds_partitioned_parquet_snap.item_5.i_class_id,tpcds_partitioned_parquet_snap.item_5.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=63 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  F37:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  |  max-parallelism=1824 segment-costs=[20502959018, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  58:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=63 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  57:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=27
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=57,59,61 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  |  in pipelines: 53(GETNEXT), 56(OPEN)
|  |  |  |
|  |  |  |--F124:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=27 plan-id=28 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  runtime filters: RF047[min_max] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  176:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=61 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 56(GETNEXT)
|  |  |  |  |
|  |  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  56:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     runtime filters: RF039[min_max] -> tpcds_partitioned_parquet_snap.item_5.i_brand_id, RF040[min_max] -> tpcds_partitioned_parquet_snap.item_5.i_category_id, RF041[min_max] -> tpcds_partitioned_parquet_snap.item_5.i_class_id, RF036[bloom] -> tpcds_partitioned_parquet_snap.item_5.i_brand_id, RF037[bloom] -> tpcds_partitioned_parquet_snap.item_5.i_category_id, RF038[bloom] -> tpcds_partitioned_parquet_snap.item_5.i_class_id
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=61 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 56(GETNEXT)
|  |  |  |
|  |  |  55:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=28
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=57,59 row-size=16B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  |  |  |  in pipelines: 53(GETNEXT), 54(OPEN)
|  |  |  |
|  |  |  |--F125:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=28 plan-id=29 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  175:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=59 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |  |
|  |  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  54:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=59 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  53:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF047[min_max] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=57 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |  |     in pipelines: 53(GETNEXT)
|  |  |
|  |  174:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_class_id, tpcds_partitioned_parquet_snap.item_7.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=79 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 174(GETNEXT), 66(OPEN)
|  |  |
|  |  173:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_7.i_brand_id,tpcds_partitioned_parquet_snap.item_7.i_class_id,tpcds_partitioned_parquet_snap.item_7.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=79 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 66(GETNEXT)
|  |  |
|  |  F33:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=520 segment-costs=[5186478425, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  71:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_class_id, tpcds_partitioned_parquet_snap.item_7.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=79 row-size=12B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 66(GETNEXT)
|  |  |
|  |  70:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=25
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=73,75,77 row-size=32B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 66(GETNEXT), 69(OPEN)
|  |  |
|  |  |--F122:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  runtime filters: RF043[min_max] <- tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  172:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=77 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 69(GETNEXT)
|  |  |  |
|  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  69:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     runtime filters: RF039[min_max] -> tpcds_partitioned_parquet_snap.item_7.i_brand_id, RF040[min_max] -> tpcds_partitioned_parquet_snap.item_7.i_category_id, RF041[min_max] -> tpcds_partitioned_parquet_snap.item_7.i_class_id, RF036[bloom] -> tpcds_partitioned_parquet_snap.item_7.i_brand_id, RF037[bloom] -> tpcds_partitioned_parquet_snap.item_7.i_category_id, RF038[bloom] -> tpcds_partitioned_parquet_snap.item_7.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=77 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 69(GETNEXT)
|  |  |
|  |  68:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=26
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=73,75 row-size=16B cardinality=2.16G(filtered from 2.16G) cost=945141101
|  |  |  in pipelines: 66(GETNEXT), 67(OPEN)
|  |  |
|  |  |--F123:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=26 plan-id=27 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  171:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 67(GETNEXT)
|  |  |  |
|  |  |  F34:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  67:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=75 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 67(GETNEXT)
|  |  |
|  |  66:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF043[min_max] -> tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=73 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|  |     in pipelines: 66(GETNEXT)
|  |
|  49:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=31
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=51,53 row-size=28B cardinality=254.82M cost=111533041
|  |  in pipelines: 47(GETNEXT), 48(OPEN)
|  |
|  |--F128:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=8.77MB mem-reservation=8.75MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=31 plan-id=32 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  runtime filters: RF034[bloom] <- tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  170:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=53 row-size=12B cardinality=108 cost=140
|  |  |  in pipelines: 48(GETNEXT)
|  |  |
|  |  F32:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[16733]
|  |  48:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=53 row-size=12B cardinality=108 cost=16728
|  |     in pipelines: 48(GETNEXT)
|  |
|  47:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF033[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF034[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=51 row-size=16B cardinality=254.82M(filtered from 4.32G) cost=58709647
|     in pipelines: 47(GETNEXT)
|
46:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  join table id: 00
|  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=34,50 row-size=52B cardinality=149.12K cost=30554
|  in pipelines: 163(GETNEXT), 168(OPEN)
|
|--F97:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  169:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=50 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 168(GETNEXT)
|  |
|  F30:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  168:AGGREGATE [FINALIZE]
|  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=50 row-size=16B cardinality=1 cost=8
|  |  in pipelines: 168(GETNEXT), 45(OPEN)
|  |
|  167:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=49 row-size=16B cardinality=120 cost=22
|  |  in pipelines: 45(GETNEXT)
|  |
|  F29:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[11061173397, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  45:AGGREGATE
|  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=49 row-size=16B cardinality=120 cost=1058398679
|  |  in pipelines: 45(GETNEXT), 36(OPEN), 39(OPEN), 42(OPEN)
|  |
|  34:UNION
|  |  pass-through-operands: 35
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=48 row-size=8B cardinality=15.12G cost=110287964
|  |  in pipelines: 36(GETNEXT), 39(GETNEXT), 42(GETNEXT)
|  |
|  |--44:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=44,46 row-size=20B cardinality=2.16G cost=945417979
|  |  |  in pipelines: 42(GETNEXT), 43(OPEN)
|  |  |
|  |  |--F100:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  166:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=46 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 43(GETNEXT)
|  |  |  |
|  |  |  F28:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  43:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=46 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 43(GETNEXT)
|  |  |
|  |  42:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=44 row-size=12B cardinality=2.16G cost=373242464
|  |     in pipelines: 42(GETNEXT)
|  |
|  35:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=43 row-size=8B cardinality=12.96G cost=661738272
|  |  in pipelines: 36(GETNEXT), 39(GETNEXT)
|  |
|  |--41:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=02
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=39,41 row-size=20B cardinality=4.32G cost=1890898131
|  |  |  in pipelines: 39(GETNEXT), 40(OPEN)
|  |  |
|  |  |--F99:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  165:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=41 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 40(GETNEXT)
|  |  |  |
|  |  |  F25:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  40:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=41 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 40(GETNEXT)
|  |  |
|  |  39:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=39 row-size=12B cardinality=4.32G cost=746509474
|  |     in pipelines: 39(GETNEXT)
|  |
|  38:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=35,37 row-size=20B cardinality=8.64G cost=3781699633
|  |  in pipelines: 36(GETNEXT), 37(OPEN)
|  |
|  |--F98:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  164:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=37 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 37(GETNEXT)
|  |  |
|  |  F23:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  37:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=37 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 37(GETNEXT)
|  |
|  36:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=35 row-size=12B cardinality=8.64G cost=1492980801
|     in pipelines: 36(GETNEXT)
|
163:AGGREGATE [FINALIZE]
|  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count:merge()
|  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=34 row-size=36B cardinality=149.12K cost=25030787
|  in pipelines: 163(GETNEXT), 02(OPEN)
|
162:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_3.i_brand_id,tpcds_partitioned_parquet_snap.item_3.i_class_id,tpcds_partitioned_parquet_snap.item_3.i_category_id)]
|  mem-estimate=12.73MB mem-reservation=0B thread-reservation=0
|  tuple-ids=34 row-size=36B cardinality=16.87M cost=4666689
|  in pipelines: 02(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=70 (adjusted from 120)
Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
Per-Instance Resources: mem-estimate=36.94MB mem-reservation=17.00MB thread-reservation=1
max-parallelism=70 segment-costs=[654821526, 47790137] cpu-comparison-result=399 [max(70 (self) vs 399 (sum children))]
33:AGGREGATE [STREAMING]
|  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count()
|  group by: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_class_id, tpcds_partitioned_parquet_snap.item_3.i_category_id
|  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=34 row-size=36B cardinality=16.87M cost=150178249
|  in pipelines: 02(GETNEXT)
|
32:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=12
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,31,32 row-size=48B cardinality=51.11M cost=22375822
|  in pipelines: 02(GETNEXT), 31(OPEN)
|
|--F109:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=243.57MB mem-reservation=238.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=12 plan-id=13 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  runtime filters: RF001[min_max] <- tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=238.00MB mem-reservation=238.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  161:EXCHANGE [BROADCAST]
|  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=32 row-size=16B cardinality=360.00K cost=478440
|  |  in pipelines: 31(GETNEXT)
|  |
|  F20:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[106272]
|  31:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=32 row-size=16B cardinality=360.00K cost=82944
|     in pipelines: 31(GETNEXT)
|
30:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=13
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,31 row-size=32B cardinality=51.13M cost=140484124
|  in pipelines: 02(GETNEXT), 159(OPEN)
|
|--F110:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=13.78MB mem-reservation=13.56MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[83840] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  JOIN BUILD
|  |  join-table-id=13 plan-id=14 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF003[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=13.56MB mem-reservation=13.56MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |
|  160:EXCHANGE [BROADCAST]
|  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=4B cardinality=36.00K cost=47840
|  |  in pipelines: 159(GETNEXT)
|  |
|  F19:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=10.09MB mem-reservation=1.94MB thread-reservation=1
|  max-parallelism=10 segment-costs=[109051, 1166] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  159:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=31 row-size=4B cardinality=36.00K cost=104389
|  |  in pipelines: 159(GETNEXT), 156(OPEN)
|  |
|  158:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  mem-estimate=94.06KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=4B cardinality=36.00K cost=4662
|  |  in pipelines: 156(GETNEXT)
|  |
|  F17:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[2731445, 225660, 27820] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  29:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=31 row-size=4B cardinality=36.00K cost=104389
|  |  in pipelines: 156(GETNEXT)
|  |
|  28:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=14
|  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item.i_class_id
|  |  fk/pk conjuncts: assumed fk/pk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=30,4 row-size=36B cardinality=36.00K cost=121271
|  |  in pipelines: 156(GETNEXT), 05(OPEN)
|  |
|  |--F111:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=5.15MB mem-reservation=4.94MB thread-reservation=1 runtime-filters-memory=3.00MB
|  |  |  max-parallelism=10 segment-costs=[42649]
|  |  JOIN BUILD
|  |  |  join-table-id=14 plan-id=15 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_category_id, tpcds_partitioned_parquet_snap.item.i_class_id
|  |  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.item.i_brand_id, RF007[bloom] <- tpcds_partitioned_parquet_snap.item.i_category_id, RF008[bloom] <- tpcds_partitioned_parquet_snap.item.i_class_id, RF009[min_max] <- tpcds_partitioned_parquet_snap.item.i_brand_id, RF010[min_max] <- tpcds_partitioned_parquet_snap.item.i_category_id, RF011[min_max] <- tpcds_partitioned_parquet_snap.item.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=36000
|  |  |
|  |  157:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_brand_id,tpcds_partitioned_parquet_snap.item.i_class_id,tpcds_partitioned_parquet_snap.item.i_category_id)]
|  |  |  mem-estimate=220.62KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=4 row-size=16B cardinality=36.00K cost=6649
|  |  |  in pipelines: 05(GETNEXT)
|  |  |
|  |  F18:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=16.78MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[148701]
|  |  05:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item.i_item_sk)
|  |     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     parquet dictionary predicates: is_not_null_pred(tpcds_partitioned_parquet_snap.item.i_item_sk)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=4 row-size=16B cardinality=36.00K cost=93060
|  |     in pipelines: 05(GETNEXT)
|  |
|  156:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=30 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 156(GETNEXT), 144(OPEN), 154(OPEN)
|  |
|  155:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=30 row-size=20B cardinality=447.36K cost=90858
|  |  in pipelines: 144(GETNEXT), 154(GETNEXT)
|  |
|  F16:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=260.32MB mem-reservation=68.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[28239822, 1820963, 2659596, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  27:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=30 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 144(GETNEXT), 154(GETNEXT)
|  |
|  06:UNION
|  |  pass-through-operands: 144
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=29 row-size=12B cardinality=447.36K cost=19009
|  |  in pipelines: 144(GETNEXT), 154(GETNEXT)
|  |
|  |--154:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 154(GETNEXT), 148(OPEN), 152(OPEN)
|  |  |
|  |  153:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=60572
|  |  |  in pipelines: 148(GETNEXT), 152(GETNEXT)
|  |  |
|  |  F14:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=161.12MB mem-reservation=38.75MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28239822, 28239822, 1760391, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  20:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 148(GETNEXT), 152(GETNEXT)
|  |  |
|  |  07:UNION
|  |  |  pass-through-operands: all
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=20 row-size=12B cardinality=298.24K cost=0
|  |  |  in pipelines: 148(GETNEXT), 152(GETNEXT)
|  |  |
|  |  |--152:AGGREGATE [FINALIZE]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=19 row-size=12B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 152(GETNEXT), 14(OPEN)
|  |  |  |
|  |  |  151:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_1.i_brand_id,tpcds_partitioned_parquet_snap.item_1.i_class_id,tpcds_partitioned_parquet_snap.item_1.i_category_id)]
|  |  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=19 row-size=12B cardinality=17.89M cost=2975838
|  |  |  |  in pipelines: 14(GETNEXT)
|  |  |  |
|  |  |  F10:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=6.00MB thread-reservation=1
|  |  |  max-parallelism=1030 segment-costs=[10292257811, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  19:AGGREGATE [STREAMING]
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=19 row-size=12B cardinality=17.89M cost=6014287315
|  |  |  |  in pipelines: 14(GETNEXT)
|  |  |  |
|  |  |  18:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=19
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=13,15,17 row-size=32B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 14(GETNEXT), 17(OPEN)
|  |  |  |
|  |  |  |--F116:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=19 plan-id=20 cohort-id=05
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  |  runtime filters: RF021[min_max] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  150:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=17 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 17(GETNEXT)
|  |  |  |  |
|  |  |  |  F12:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
|  |  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  |  17:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     runtime filters: RF009[min_max] -> tpcds_partitioned_parquet_snap.item_1.i_brand_id, RF010[min_max] -> tpcds_partitioned_parquet_snap.item_1.i_category_id, RF011[min_max] -> tpcds_partitioned_parquet_snap.item_1.i_class_id, RF006[bloom] -> tpcds_partitioned_parquet_snap.item_1.i_brand_id, RF007[bloom] -> tpcds_partitioned_parquet_snap.item_1.i_category_id, RF008[bloom] -> tpcds_partitioned_parquet_snap.item_1.i_class_id
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=17 row-size=16B cardinality=360.00K cost=82944
|  |  |  |     in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  16:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=20
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=13,15 row-size=16B cardinality=4.32G(filtered from 4.32G) cost=1890344358
|  |  |  |  in pipelines: 14(GETNEXT), 15(OPEN)
|  |  |  |
|  |  |  |--F117:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=20 plan-id=21 cohort-id=05
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  149:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=15 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 15(GETNEXT)
|  |  |  |  |
|  |  |  |  F11:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  |  15:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=15 row-size=8B cardinality=7.30K cost=12520
|  |  |  |     in pipelines: 15(GETNEXT)
|  |  |  |
|  |  |  14:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF021[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=13 row-size=8B cardinality=4.32G(filtered from 4.32G) cost=497672983
|  |  |     in pipelines: 14(GETNEXT)
|  |  |
|  |  148:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=12 row-size=12B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 148(GETNEXT), 08(OPEN)
|  |  |
|  |  147:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_0.i_brand_id,tpcds_partitioned_parquet_snap.item_0.i_class_id,tpcds_partitioned_parquet_snap.item_0.i_category_id)]
|  |  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=12 row-size=12B cardinality=17.89M cost=2975838
|  |  |  in pipelines: 08(GETNEXT)
|  |  |
|  |  F06:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=9.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[20502959018, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  13:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=12 row-size=12B cardinality=17.89M cost=11947236639
|  |  |  in pipelines: 08(GETNEXT)
|  |  |
|  |  12:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=17
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=6,8,10 row-size=32B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 08(GETNEXT), 11(OPEN)
|  |  |
|  |  |--F114:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=17 plan-id=18 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  runtime filters: RF017[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  146:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=10 row-size=16B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 11(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
|  |  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[106272]
|  |  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     runtime filters: RF009[min_max] -> tpcds_partitioned_parquet_snap.item_0.i_brand_id, RF010[min_max] -> tpcds_partitioned_parquet_snap.item_0.i_category_id, RF011[min_max] -> tpcds_partitioned_parquet_snap.item_0.i_class_id, RF006[bloom] -> tpcds_partitioned_parquet_snap.item_0.i_brand_id, RF007[bloom] -> tpcds_partitioned_parquet_snap.item_0.i_category_id, RF008[bloom] -> tpcds_partitioned_parquet_snap.item_0.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=10 row-size=16B cardinality=360.00K cost=82944
|  |  |     in pipelines: 11(GETNEXT)
|  |  |
|  |  10:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=18
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=6,8 row-size=16B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  |  |  in pipelines: 08(GETNEXT), 09(OPEN)
|  |  |
|  |  |--F115:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=18 plan-id=19 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  145:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=8 row-size=8B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 09(GETNEXT)
|  |  |  |
|  |  |  F07:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[12835]
|  |  |  09:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=8 row-size=8B cardinality=7.30K cost=12520
|  |  |     in pipelines: 09(GETNEXT)
|  |  |
|  |  08:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF017[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=6 row-size=8B cardinality=8.64G(filtered from 8.64G) cost=995320534
|  |     in pipelines: 08(GETNEXT)
|  |
|  144:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=28 row-size=12B cardinality=149.12K cost=25263984
|  |  in pipelines: 144(GETNEXT), 21(OPEN)
|  |
|  143:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_2.i_brand_id,tpcds_partitioned_parquet_snap.item_2.i_class_id,tpcds_partitioned_parquet_snap.item_2.i_category_id)]
|  |  mem-estimate=11.88MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=28 row-size=12B cardinality=17.89M cost=2975838
|  |  in pipelines: 21(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=33.50MB mem-reservation=5.12MB thread-reservation=1
|  max-parallelism=520 segment-costs=[5186478425, 23047987] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  26:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=28 row-size=12B cardinality=17.89M cost=3047563509
|  |  in pipelines: 21(GETNEXT)
|  |
|  25:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=15
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=22,24,26 row-size=32B cardinality=2.16G cost=944945506
|  |  in pipelines: 21(GETNEXT), 24(OPEN)
|  |
|  |--F112:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=413.57MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=15 plan-id=16 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  runtime filters: RF013[min_max] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  142:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=5.57MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=26 row-size=16B cardinality=360.00K cost=478440
|  |  |  in pipelines: 24(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
|  |  Per-Instance Resources: mem-estimate=16.08MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[106272]
|  |  24:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF009[min_max] -> tpcds_partitioned_parquet_snap.item_2.i_brand_id, RF010[min_max] -> tpcds_partitioned_parquet_snap.item_2.i_category_id, RF011[min_max] -> tpcds_partitioned_parquet_snap.item_2.i_class_id, RF006[bloom] -> tpcds_partitioned_parquet_snap.item_2.i_brand_id, RF007[bloom] -> tpcds_partitioned_parquet_snap.item_2.i_category_id, RF008[bloom] -> tpcds_partitioned_parquet_snap.item_2.i_class_id
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=26 row-size=16B cardinality=360.00K cost=82944
|  |     in pipelines: 24(GETNEXT)
|  |
|  23:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=16
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=22,24 row-size=16B cardinality=2.16G(filtered from 2.16G) cost=945141101
|  |  in pipelines: 21(GETNEXT), 22(OPEN)
|  |
|  |--F113:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=23.32MB mem-reservation=23.25MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=16 plan-id=17 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  141:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=24 row-size=8B cardinality=7.30K cost=9700
|  |  |  in pipelines: 22(GETNEXT)
|  |  |
|  |  F03:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[12835]
|  |  22:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=24 row-size=8B cardinality=7.30K cost=12520
|  |     in pipelines: 22(GETNEXT)
|  |
|  21:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF013[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=22 row-size=8B cardinality=2.16G(filtered from 2.16G) cost=248828309
|     in pipelines: 21(GETNEXT)
|
04:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=21
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=28B cardinality=511.58M cost=223916426
|  in pipelines: 02(GETNEXT), 03(OPEN)
|
|--F118:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=14.58MB mem-reservation=14.56MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[248]
|  JOIN BUILD
|  |  join-table-id=21 plan-id=22 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=13.56MB mem-reservation=13.56MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |
|  140:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=108 cost=140
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[16733]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108 cost=16728
|     in pipelines: 03(GETNEXT)
|
02:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=16B cardinality=511.58M(filtered from 8.64G) cost=117866905
   in pipelines: 02(GETNEXT)
====
