# TPCDS-Q8
# start query 8 in stream 0 using template query8.tpl using seed 835798745
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '47602','16704','35863','28577','83910','36201',
                          '58412','48162','28055','41419','80332',
                          '38607','77817','24891','16226','18410',
                          '21231','59345','13918','51089','20317',
                          '17167','54585','67881','78366','47770',
                          '18360','51717','73108','14440','21800',
                          '89338','45859','65501','34948','25973',
                          '73219','25333','17291','10374','18829',
                          '60736','82620','41351','52094','19326',
                          '25214','54207','40936','21814','79077',
                          '25178','75742','77454','30621','89193',
                          '27369','41232','48567','83041','71948',
                          '37119','68341','14073','16891','62878',
                          '49130','19833','24286','27700','40979',
                          '50412','81504','94835','84844','71954',
                          '39503','57649','18434','24987','12350',
                          '86379','27413','44529','98569','16515',
                          '27287','24255','21094','16005','56436',
                          '91110','68293','56455','54558','10298',
                          '83647','32754','27052','51766','19444',
                          '13869','45645','94791','57631','20712',
                          '37788','41807','46507','21727','71836',
                          '81070','50632','88086','63991','20244',
                          '31655','51782','29818','63792','68605',
                          '94898','36430','57025','20601','82080',
                          '33869','22728','35834','29086','92645',
                          '98584','98072','11652','78093','57553',
                          '43830','71144','53565','18700','90209',
                          '71256','38353','54364','28571','96560',
                          '57839','56355','50679','45266','84680',
                          '34306','34972','48530','30106','15371',
                          '92380','84247','92292','68852','13338',
                          '34594','82602','70073','98069','85066',
                          '47289','11686','98862','26217','47529',
                          '63294','51793','35926','24227','14196',
                          '24594','32489','99060','49472','43432',
                          '49211','14312','88137','47369','56877',
                          '20534','81755','15794','12318','21060',
                          '73134','41255','63073','81003','73873',
                          '66057','51184','51195','45676','92696',
                          '70450','90669','98338','25264','38919',
                          '59226','58581','60298','17895','19489',
                          '52301','80846','95464','68770','51634',
                          '19988','18367','18421','11618','67975',
                          '25494','41352','95430','15734','62585',
                          '97173','33773','10425','75675','53535',
                          '17879','41967','12197','67998','79658',
                          '59130','72592','14851','43933','68101',
                          '50636','25717','71286','24660','58058',
                          '72991','95042','15543','33122','69280',
                          '11912','59386','27642','65177','17672',
                          '33467','64592','36335','54010','18767',
                          '63193','42361','49254','33113','33159',
                          '36479','59080','11855','81963','31016',
                          '49140','29392','41836','32958','53163',
                          '13844','73146','23952','65148','93498',
                          '14530','46131','58454','13376','13378',
                          '83986','12320','17193','59852','46081',
                          '98533','52389','13086','68843','31013',
                          '13261','60560','13443','45533','83583',
                          '11489','58218','19753','22911','25115',
                          '86709','27156','32669','13123','51933',
                          '39214','41331','66943','14155','69998',
                          '49101','70070','35076','14242','73021',
                          '59494','15782','29752','37914','74686',
                          '83086','34473','15751','81084','49230',
                          '91894','60624','17819','28810','63180',
                          '56224','39459','55233','75752','43639',
                          '55349','86057','62361','50788','31830',
                          '58062','18218','85761','60083','45484',
                          '21204','90229','70041','41162','35390',
                          '16364','39500','68908','26689','52868',
                          '81335','40146','11340','61527','61794',
                          '71997','30415','59004','29450','58117',
                          '69952','33562','83833','27385','61860',
                          '96435','48333','23065','32961','84919',
                          '61997','99132','22815','56600','68730',
                          '48017','95694','32919','88217','27116',
                          '28239','58032','18884','16791','21343',
                          '97462','18569','75660','15475')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100

# end query 8 in stream 0 using template query8.tpl
---- PLAN
Max Per-Host Resource Reservation: Memory=80.84MB Threads=1
Per-Host Resource Estimates: Memory=295MB
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=294.92MB mem-reservation=80.84MB thread-reservation=1 runtime-filters-memory=5.00MB
|  max-parallelism=1 segment-costs=[2623717, 10622426, 32505, 1107336837, 18, 20]
PLAN-ROOT SINK
|  output exprs: tpcds_partitioned_parquet_snap.store.s_store_name, sum(tpcds_partitioned_parquet_snap.store_sales.ss_net_profit)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=20
|
17:TOP-N [LIMIT=100]
|  order by: tpcds_partitioned_parquet_snap.store.s_store_name ASC NULLS LAST
|  mem-estimate=320B mem-reservation=0B thread-reservation=0
|  tuple-ids=18 row-size=32B cardinality=10 cost=18
|  in pipelines: 17(GETNEXT), 16(OPEN)
|
16:AGGREGATE [FINALIZE]
|  output: sum(tpcds_partitioned_parquet_snap.store_sales.ss_net_profit)
|  group by: tpcds_partitioned_parquet_snap.store.s_store_name
|  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=17 row-size=32B cardinality=10 cost=234995169
|  in pipelines: 16(GETNEXT), 00(OPEN)
|
15:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk = tpcds_partitioned_parquet_snap.store.s_store_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk = tpcds_partitioned_parquet_snap.store.s_store_sk
|  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.store.s_store_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.store.s_store_sk
|  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  tuple-ids=0,2,14,15 row-size=81B cardinality=803.40M cost=351660331
|  in pipelines: 00(GETNEXT), 12(OPEN)
|
|--14:HASH JOIN [INNER JOIN]
|  |  hash predicates: substr(CA_ZIP, 1, 2) = substr(tpcds_partitioned_parquet_snap.store.s_zip, 1, 2)
|  |  fk/pk conjuncts: assumed fk/pk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=14,15 row-size=57B cardinality=11.19K cost=5031
|  |  in pipelines: 12(GETNEXT), 13(OPEN)
|  |
|  |--13:SCAN HDFS [tpcds_partitioned_parquet_snap.store]
|  |     HDFS partitions=1/1 files=1 size=119.76KB
|  |     predicates: substr(tpcds_partitioned_parquet_snap.store.s_zip, CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL, tpcds_partitioned_parquet_snap.store.s_store_sk IS NOT NULL
|  |     stored statistics:
|  |       table: rows=1.35K size=119.76KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1.35K
|  |     parquet dictionary predicates: substr(tpcds_partitioned_parquet_snap.store.s_zip, CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL, tpcds_partitioned_parquet_snap.store.s_store_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=24.00KB thread-reservation=0
|  |     tuple-ids=15 row-size=37B cardinality=135 cost=327
|  |     in pipelines: 13(GETNEXT)
|  |
|  12:AGGREGATE [FINALIZE]
|  |  output: count()
|  |  group by: CA_ZIP
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=14 row-size=20B cardinality=11.19K cost=32441
|  |  in pipelines: 12(GETNEXT), 07(OPEN), 11(OPEN)
|  |
|  03:UNION
|  |  pass-through-operands: 07
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=13 row-size=12B cardinality=11.19K cost=64
|  |  in pipelines: 07(GETNEXT), 11(GETNEXT)
|  |
|  |--11:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: substr(tpcds_partitioned_parquet_snap.customer_address_0.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT))
|  |  |  having: count() > CAST(10 AS BIGINT)
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=12 row-size=20B cardinality=1.02K cost=1013098
|  |  |  in pipelines: 11(GETNEXT), 09(OPEN)
|  |  |
|  |  10:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk = tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk
|  |  |  fk/pk conjuncts: none
|  |  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk, RF007[min_max] <- tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk
|  |  |  mem-estimate=78.04MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=10,8 row-size=38B cardinality=3.37M cost=2976328
|  |  |  in pipelines: 09(GETNEXT), 08(OPEN)
|  |  |
|  |  |--08:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_address]
|  |  |     HDFS partitions=1/1 files=1 size=307.36MB
|  |  |     predicates: substr(substr(tpcds_partitioned_parquet_snap.customer_address_0.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)), CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL, tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk IS NOT NULL
|  |  |     stored statistics:
|  |  |       table: rows=15.00M size=307.36MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.58M
|  |  |     parquet dictionary predicates: substr(substr(tpcds_partitioned_parquet_snap.customer_address_0.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)), CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL, tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk IS NOT NULL
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=8 row-size=21B cardinality=1.50M cost=2787000
|  |  |     in pipelines: 08(GETNEXT)
|  |  |
|  |  09:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     predicates: tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag = 'Y', tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL
|  |     runtime filters: RF007[min_max] -> tpcds_partitioned_parquet_snap.customer.c_current_addr_sk, RF006[bloom] -> tpcds_partitioned_parquet_snap.customer.c_current_addr_sk
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag = 'Y'
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag = 'Y', tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=10 row-size=17B cardinality=3.37M(filtered from 14.47M) cost=3846000
|  |     in pipelines: 09(GETNEXT)
|  |
|  07:AGGREGATE [FINALIZE]
|  |  group by: substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT))
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=10.17K cost=465267
|  |  in pipelines: 07(GETNEXT), 04(OPEN)
|  |
|  06:HASH JOIN [LEFT SEMI JOIN]
|  |  hash predicates: substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, 1, 5) = EXPR$0
|  |  runtime filters: RF004[bloom] <- EXPR$0
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4 row-size=17B cardinality=1.50M cost=656950
|  |  in pipelines: 04(GETNEXT)
|  |
|  |--05:UNION
|  |     constant-operands=400
|  |     mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |     tuple-ids=6 row-size=12B cardinality=400 cost=0
|  |     in pipelines: <none>
|  |
|  04:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_address]
|     HDFS partitions=1/1 files=1 size=307.36MB
|     predicates: substr(substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)), CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL
|     runtime filters: RF004[bloom] -> substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, 1, 5)
|     stored statistics:
|       table: rows=15.00M size=307.36MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1.58M
|     parquet dictionary predicates: substr(substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)), CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=4 row-size=17B cardinality=1.50M cost=1501500
|     in pipelines: 04(GETNEXT)
|
02:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=24B cardinality=803.40M cost=351649329
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--01:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1998 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1998 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1998 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=186 cost=18780
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
   partition predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk IS NOT NULL
   HDFS partitions=1823/1824 files=1823 size=389.69GB
   predicates: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk IS NOT NULL
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_store_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_store_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1823/1823 rows=8.25G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=12.24M est-scan-range=186(filtered from 1823)
   parquet dictionary predicates: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk IS NOT NULL
   mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
   tuple-ids=0 row-size=12B cardinality=803.40M(filtered from 7.88G) cost=169007870
   in pipelines: 00(GETNEXT)
---- DISTRIBUTEDPLAN
Max Per-Host Resource Reservation: Memory=191.77MB Threads=28
Per-Host Resource Estimates: Memory=813MB
F13:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[23] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
PLAN-ROOT SINK
|  output exprs: tpcds_partitioned_parquet_snap.store.s_store_name, sum(tpcds_partitioned_parquet_snap.store_sales.ss_net_profit)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=20
|
32:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: tpcds_partitioned_parquet_snap.store.s_store_name ASC NULLS LAST
|  limit: 100
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=18 row-size=32B cardinality=10 cost=3
|  in pipelines: 17(GETNEXT)
|
F12:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.store.s_store_name)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=14.22MB mem-reservation=1.94MB thread-reservation=1
max-parallelism=10 segment-costs=[686, 18, 11] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
17:TOP-N [LIMIT=100]
|  order by: tpcds_partitioned_parquet_snap.store.s_store_name ASC NULLS LAST
|  mem-estimate=320B mem-reservation=0B thread-reservation=0
|  tuple-ids=18 row-size=32B cardinality=10 cost=18
|  in pipelines: 17(GETNEXT), 31(OPEN)
|
31:AGGREGATE [FINALIZE]
|  output: sum:merge(tpcds_partitioned_parquet_snap.store_sales.ss_net_profit)
|  group by: tpcds_partitioned_parquet_snap.store.s_store_name
|  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=17 row-size=32B cardinality=10 cost=377
|  in pipelines: 31(GETNEXT), 00(OPEN)
|
30:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.store.s_store_name)]
|  mem-estimate=4.22MB mem-reservation=0B thread-reservation=0
|  tuple-ids=17 row-size=32B cardinality=1.20K cost=309
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
Per-Instance Resources: mem-estimate=27.40MB mem-reservation=2.50MB thread-reservation=1
max-parallelism=120 segment-costs=[1107304428, 3086] cpu-comparison-result=120 [max(120 (self) vs 53 (sum children))]
16:AGGREGATE [STREAMING]
|  output: sum(tpcds_partitioned_parquet_snap.store_sales.ss_net_profit)
|  group by: tpcds_partitioned_parquet_snap.store.s_store_name
|  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=17 row-size=32B cardinality=1.20K cost=234998272
|  in pipelines: 00(GETNEXT)
|
15:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=00
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk = tpcds_partitioned_parquet_snap.store.s_store_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk = tpcds_partitioned_parquet_snap.store.s_store_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  tuple-ids=0,2,14,15 row-size=81B cardinality=803.40M cost=351649143
|  in pipelines: 00(GETNEXT), 27(OPEN)
|
|--F14:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=36.74MB mem-reservation=35.50MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[26048] cpu-comparison-result=42 [max(10 (self) vs 42 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.store.s_store_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.store.s_store_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.store.s_store_sk
|  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=11188
|  |
|  29:EXCHANGE [BROADCAST]
|  |  mem-estimate=1.24MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=14,15 row-size=57B cardinality=11.19K cost=14860
|  |  in pipelines: 27(GETNEXT)
|  |
|  F10:PLAN FRAGMENT [HASH(CA_ZIP)] hosts=10 instances=10
|  Per-Instance Resources: mem-estimate=128.26MB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[34713, 7099] cpu-comparison-result=42 [max(10 (self) vs 42 (sum children))]
|  14:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: substr(CA_ZIP, 1, 2) = substr(tpcds_partitioned_parquet_snap.store.s_zip, 1, 2)
|  |  fk/pk conjuncts: assumed fk/pk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=14,15 row-size=57B cardinality=11.19K cost=4896
|  |  in pipelines: 27(GETNEXT), 13(OPEN)
|  |
|  |--F15:PLAN FRAGMENT [HASH(CA_ZIP)] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=1.95MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[305]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: substr(tpcds_partitioned_parquet_snap.store.s_zip, 1, 2)
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=135
|  |  |
|  |  28:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=15 row-size=37B cardinality=135 cost=170
|  |  |  in pipelines: 13(GETNEXT)
|  |  |
|  |  F11:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.16MB mem-reservation=24.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[343]
|  |  13:SCAN HDFS [tpcds_partitioned_parquet_snap.store, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=119.76KB
|  |     predicates: substr(tpcds_partitioned_parquet_snap.store.s_zip, CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL, tpcds_partitioned_parquet_snap.store.s_store_sk IS NOT NULL
|  |     stored statistics:
|  |       table: rows=1.35K size=119.76KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1.35K
|  |     parquet dictionary predicates: substr(tpcds_partitioned_parquet_snap.store.s_zip, CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL, tpcds_partitioned_parquet_snap.store.s_store_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=24.00KB thread-reservation=0
|  |     tuple-ids=15 row-size=37B cardinality=135 cost=327
|  |     in pipelines: 13(GETNEXT)
|  |
|  27:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: CA_ZIP
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=14 row-size=20B cardinality=11.19K cost=32441
|  |  in pipelines: 27(GETNEXT), 21(OPEN), 25(OPEN)
|  |
|  26:EXCHANGE [HASH(CA_ZIP)]
|  |  mem-estimate=261.85KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=14 row-size=20B cardinality=11.19K cost=2272
|  |  in pipelines: 21(GETNEXT), 25(GETNEXT)
|  |
|  F09:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  Per-Instance Resources: mem-estimate=139.37MB mem-reservation=35.94MB thread-reservation=1
|  max-parallelism=10 segment-costs=[73182, 76925, 32505, 20174] cpu-comparison-result=31 [max(10 (self) vs 31 (sum children))]
|  12:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: CA_ZIP
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=14 row-size=20B cardinality=11.19K cost=32441
|  |  in pipelines: 21(GETNEXT), 25(GETNEXT)
|  |
|  03:UNION
|  |  pass-through-operands: 21
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=13 row-size=12B cardinality=11.19K cost=64
|  |  in pipelines: 21(GETNEXT), 25(GETNEXT)
|  |
|  |--25:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: substr(tpcds_partitioned_parquet_snap.customer_address_0.ca_zip, 1, 5)
|  |  |  having: count() > CAST(10 AS BIGINT)
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=12 row-size=20B cardinality=1.02K cost=56268
|  |  |  in pipelines: 25(GETNEXT), 09(OPEN)
|  |  |
|  |  24:EXCHANGE [HASH(substr(tpcds_partitioned_parquet_snap.customer_address_0.ca_zip, 1, 5))]
|  |  |  mem-estimate=438.65KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=12 row-size=20B cardinality=101.71K cost=20657
|  |  |  in pipelines: 09(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=21.14MB mem-reservation=2.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[3366580, 183403] cpu-comparison-result=20 [max(20 (self) vs 20 (sum children))]
|  |  11:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: substr(tpcds_partitioned_parquet_snap.customer_address_0.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT))
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=12 row-size=20B cardinality=101.71K cost=1251758
|  |  |  in pipelines: 09(GETNEXT)
|  |  |
|  |  10:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=03
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk = tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk
|  |  |  fk/pk conjuncts: none
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=10,8 row-size=38B cardinality=3.37M cost=1476328
|  |  |  in pipelines: 09(GETNEXT), 08(OPEN)
|  |  |
|  |  |--F17:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=13.75MB mem-reservation=10.50MB thread-reservation=1 runtime-filters-memory=2.00MB
|  |  |  |  max-parallelism=10 segment-costs=[1811550]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk
|  |  |  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk, RF007[min_max] <- tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk
|  |  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0 cost=1500000
|  |  |  |
|  |  |  23:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk)]
|  |  |  |  mem-estimate=3.25MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=8 row-size=21B cardinality=1.50M cost=311550
|  |  |  |  in pipelines: 08(GETNEXT)
|  |  |  |
|  |  |  F06:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.98MB mem-reservation=128.00KB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[5588400]
|  |  |  08:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_address, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=307.36MB
|  |  |     predicates: substr(substr(tpcds_partitioned_parquet_snap.customer_address_0.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)), CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL, tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk IS NOT NULL
|  |  |     stored statistics:
|  |  |       table: rows=15.00M size=307.36MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.58M
|  |  |     parquet dictionary predicates: substr(substr(tpcds_partitioned_parquet_snap.customer_address_0.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)), CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL, tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk IS NOT NULL
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=8 row-size=21B cardinality=1.50M cost=2787000
|  |  |     in pipelines: 08(GETNEXT)
|  |  |
|  |  22:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)]
|  |  |  mem-estimate=10.21MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=10 row-size=17B cardinality=3.37M(filtered from 14.47M) cost=638494
|  |  |  in pipelines: 09(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
|  |  Per-Instance Resources: mem-estimate=16.82MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[9276407]
|  |  09:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     predicates: tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag = 'Y', tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL
|  |     runtime filters: RF007[min_max] -> tpcds_partitioned_parquet_snap.customer.c_current_addr_sk, RF006[bloom] -> tpcds_partitioned_parquet_snap.customer.c_current_addr_sk
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag = 'Y'
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag = 'Y', tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=10 row-size=17B cardinality=3.37M(filtered from 14.47M) cost=3846000
|  |     in pipelines: 09(GETNEXT)
|  |
|  21:AGGREGATE [FINALIZE]
|  |  group by: substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, 1, 5)
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=10.17K cost=56268
|  |  in pipelines: 21(GETNEXT), 04(OPEN)
|  |
|  20:EXCHANGE [HASH(substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, 1, 5))]
|  |  mem-estimate=279.19KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=101.71K cost=16914
|  |  in pipelines: 04(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=2.12MB thread-reservation=1
|  max-parallelism=10 segment-costs=[2861978, 131002] cpu-comparison-result=11 [max(10 (self) vs 11 (sum children))]
|  07:AGGREGATE [STREAMING]
|  |  group by: substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT))
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=101.71K cost=703928
|  |  in pipelines: 04(GETNEXT)
|  |
|  06:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash-table-id=02
|  |  hash predicates: substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, 1, 5) = EXPR$0
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4 row-size=17B cardinality=1.50M cost=656550
|  |  in pipelines: 04(GETNEXT)
|  |
|  |--F16:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=2.95MB mem-reservation=2.94MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[930]
|  |  JOIN BUILD
|  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  build expressions: EXPR$0
|  |  |  runtime filters: RF004[bloom] <- EXPR$0
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=400
|  |  |
|  |  19:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=6 row-size=12B cardinality=400 cost=530
|  |  |  in pipelines: <none>
|  |  |
|  |  F03:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=64.00KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[21]
|  |  05:UNION
|  |     constant-operands=400
|  |     mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |     tuple-ids=6 row-size=12B cardinality=400 cost=0
|  |     in pipelines: <none>
|  |
|  04:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_address, RANDOM]
|     HDFS partitions=1/1 files=1 size=307.36MB
|     predicates: substr(substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)), CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL
|     runtime filters: RF004[bloom] -> substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, 1, 5)
|     stored statistics:
|       table: rows=15.00M size=307.36MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1.58M
|     parquet dictionary predicates: substr(substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)), CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=4 row-size=17B cardinality=1.50M cost=1501500
|     in pipelines: 04(GETNEXT)
|
02:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=04
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=24B cardinality=803.40M cost=351649143
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--F18:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=24.27MB mem-reservation=24.25MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[426]
|  JOIN BUILD
|  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=186
|  |
|  18:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=186 cost=240
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[18790]
|  01:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1998 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1998 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1998 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=186 cost=18780
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   partition predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk IS NOT NULL
   HDFS partitions=1823/1824 files=1823 size=389.69GB
   predicates: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk IS NOT NULL
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_store_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_store_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1823/1823 rows=8.25G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=12.24M est-scan-range=186(filtered from 1823)
   parquet dictionary predicates: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk IS NOT NULL
   mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
   tuple-ids=0 row-size=12B cardinality=803.40M(filtered from 7.88G) cost=169007870
   in pipelines: 00(GETNEXT)
---- PARALLELPLANS
Max Per-Host Resource Reservation: Memory=191.77MB Threads=28
Per-Host Resource Estimates: Memory=813MB
F13:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.02MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[23] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
PLAN-ROOT SINK
|  output exprs: tpcds_partitioned_parquet_snap.store.s_store_name, sum(tpcds_partitioned_parquet_snap.store_sales.ss_net_profit)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=20
|
32:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: tpcds_partitioned_parquet_snap.store.s_store_name ASC NULLS LAST
|  limit: 100
|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  tuple-ids=18 row-size=32B cardinality=10 cost=3
|  in pipelines: 17(GETNEXT)
|
F12:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.store.s_store_name)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=14.22MB mem-reservation=1.94MB thread-reservation=1
max-parallelism=10 segment-costs=[686, 18, 11] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
17:TOP-N [LIMIT=100]
|  order by: tpcds_partitioned_parquet_snap.store.s_store_name ASC NULLS LAST
|  mem-estimate=320B mem-reservation=0B thread-reservation=0
|  tuple-ids=18 row-size=32B cardinality=10 cost=18
|  in pipelines: 17(GETNEXT), 31(OPEN)
|
31:AGGREGATE [FINALIZE]
|  output: sum:merge(tpcds_partitioned_parquet_snap.store_sales.ss_net_profit)
|  group by: tpcds_partitioned_parquet_snap.store.s_store_name
|  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=17 row-size=32B cardinality=10 cost=377
|  in pipelines: 31(GETNEXT), 00(OPEN)
|
30:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.store.s_store_name)]
|  mem-estimate=4.22MB mem-reservation=0B thread-reservation=0
|  tuple-ids=17 row-size=32B cardinality=1.20K cost=309
|  in pipelines: 00(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
Per-Instance Resources: mem-estimate=27.40MB mem-reservation=2.50MB thread-reservation=1
max-parallelism=120 segment-costs=[1107304428, 3086] cpu-comparison-result=120 [max(120 (self) vs 53 (sum children))]
16:AGGREGATE [STREAMING]
|  output: sum(tpcds_partitioned_parquet_snap.store_sales.ss_net_profit)
|  group by: tpcds_partitioned_parquet_snap.store.s_store_name
|  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=17 row-size=32B cardinality=1.20K cost=234998272
|  in pipelines: 00(GETNEXT)
|
15:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=00
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk = tpcds_partitioned_parquet_snap.store.s_store_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk = tpcds_partitioned_parquet_snap.store.s_store_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  tuple-ids=0,2,14,15 row-size=81B cardinality=803.40M cost=351649143
|  in pipelines: 00(GETNEXT), 27(OPEN)
|
|--F14:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=36.74MB mem-reservation=35.50MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[26048] cpu-comparison-result=42 [max(10 (self) vs 42 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.store.s_store_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.store.s_store_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.store.s_store_sk
|  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=11188
|  |
|  29:EXCHANGE [BROADCAST]
|  |  mem-estimate=1.24MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=14,15 row-size=57B cardinality=11.19K cost=14860
|  |  in pipelines: 27(GETNEXT)
|  |
|  F10:PLAN FRAGMENT [HASH(CA_ZIP)] hosts=10 instances=10
|  Per-Instance Resources: mem-estimate=128.26MB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[34713, 7099] cpu-comparison-result=42 [max(10 (self) vs 42 (sum children))]
|  14:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: substr(CA_ZIP, 1, 2) = substr(tpcds_partitioned_parquet_snap.store.s_zip, 1, 2)
|  |  fk/pk conjuncts: assumed fk/pk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=14,15 row-size=57B cardinality=11.19K cost=4896
|  |  in pipelines: 27(GETNEXT), 13(OPEN)
|  |
|  |--F15:PLAN FRAGMENT [HASH(CA_ZIP)] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=1.95MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[305]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: substr(tpcds_partitioned_parquet_snap.store.s_zip, 1, 2)
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=135
|  |  |
|  |  28:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=15 row-size=37B cardinality=135 cost=170
|  |  |  in pipelines: 13(GETNEXT)
|  |  |
|  |  F11:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.16MB mem-reservation=24.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[343]
|  |  13:SCAN HDFS [tpcds_partitioned_parquet_snap.store, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=119.76KB
|  |     predicates: substr(tpcds_partitioned_parquet_snap.store.s_zip, CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL, tpcds_partitioned_parquet_snap.store.s_store_sk IS NOT NULL
|  |     stored statistics:
|  |       table: rows=1.35K size=119.76KB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1.35K
|  |     parquet dictionary predicates: substr(tpcds_partitioned_parquet_snap.store.s_zip, CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL, tpcds_partitioned_parquet_snap.store.s_store_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=24.00KB thread-reservation=0
|  |     tuple-ids=15 row-size=37B cardinality=135 cost=327
|  |     in pipelines: 13(GETNEXT)
|  |
|  27:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: CA_ZIP
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=14 row-size=20B cardinality=11.19K cost=32441
|  |  in pipelines: 27(GETNEXT), 21(OPEN), 25(OPEN)
|  |
|  26:EXCHANGE [HASH(CA_ZIP)]
|  |  mem-estimate=261.85KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=14 row-size=20B cardinality=11.19K cost=2272
|  |  in pipelines: 21(GETNEXT), 25(GETNEXT)
|  |
|  F09:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  Per-Instance Resources: mem-estimate=139.37MB mem-reservation=35.94MB thread-reservation=1
|  max-parallelism=10 segment-costs=[73182, 76925, 32505, 20174] cpu-comparison-result=31 [max(10 (self) vs 31 (sum children))]
|  12:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: CA_ZIP
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=14 row-size=20B cardinality=11.19K cost=32441
|  |  in pipelines: 21(GETNEXT), 25(GETNEXT)
|  |
|  03:UNION
|  |  pass-through-operands: 21
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=13 row-size=12B cardinality=11.19K cost=64
|  |  in pipelines: 21(GETNEXT), 25(GETNEXT)
|  |
|  |--25:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: substr(tpcds_partitioned_parquet_snap.customer_address_0.ca_zip, 1, 5)
|  |  |  having: count() > CAST(10 AS BIGINT)
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=12 row-size=20B cardinality=1.02K cost=56268
|  |  |  in pipelines: 25(GETNEXT), 09(OPEN)
|  |  |
|  |  24:EXCHANGE [HASH(substr(tpcds_partitioned_parquet_snap.customer_address_0.ca_zip, 1, 5))]
|  |  |  mem-estimate=438.65KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=12 row-size=20B cardinality=101.71K cost=20657
|  |  |  in pipelines: 09(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=21.14MB mem-reservation=2.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[3366580, 183403] cpu-comparison-result=20 [max(20 (self) vs 20 (sum children))]
|  |  11:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: substr(tpcds_partitioned_parquet_snap.customer_address_0.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT))
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=12 row-size=20B cardinality=101.71K cost=1251758
|  |  |  in pipelines: 09(GETNEXT)
|  |  |
|  |  10:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=03
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.customer.c_current_addr_sk = tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk
|  |  |  fk/pk conjuncts: none
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=10,8 row-size=38B cardinality=3.37M cost=1476328
|  |  |  in pipelines: 09(GETNEXT), 08(OPEN)
|  |  |
|  |  |--F17:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=13.75MB mem-reservation=10.50MB thread-reservation=1 runtime-filters-memory=2.00MB
|  |  |  |  max-parallelism=10 segment-costs=[1811550]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk
|  |  |  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk, RF007[min_max] <- tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk
|  |  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0 cost=1500000
|  |  |  |
|  |  |  23:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk)]
|  |  |  |  mem-estimate=3.25MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=8 row-size=21B cardinality=1.50M cost=311550
|  |  |  |  in pipelines: 08(GETNEXT)
|  |  |  |
|  |  |  F06:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.98MB mem-reservation=128.00KB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[5588400]
|  |  |  08:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_address, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=307.36MB
|  |  |     predicates: substr(substr(tpcds_partitioned_parquet_snap.customer_address_0.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)), CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL, tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk IS NOT NULL
|  |  |     stored statistics:
|  |  |       table: rows=15.00M size=307.36MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.58M
|  |  |     parquet dictionary predicates: substr(substr(tpcds_partitioned_parquet_snap.customer_address_0.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)), CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL, tpcds_partitioned_parquet_snap.customer_address_0.ca_address_sk IS NOT NULL
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=8 row-size=21B cardinality=1.50M cost=2787000
|  |  |     in pipelines: 08(GETNEXT)
|  |  |
|  |  22:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer.c_current_addr_sk)]
|  |  |  mem-estimate=10.21MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=10 row-size=17B cardinality=3.37M(filtered from 14.47M) cost=638494
|  |  |  in pipelines: 09(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Host Shared Resources: mem-estimate=2.00MB mem-reservation=2.00MB thread-reservation=0 runtime-filters-memory=2.00MB
|  |  Per-Instance Resources: mem-estimate=16.82MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[9276407]
|  |  09:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     predicates: tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag = 'Y', tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL
|  |     runtime filters: RF007[min_max] -> tpcds_partitioned_parquet_snap.customer.c_current_addr_sk, RF006[bloom] -> tpcds_partitioned_parquet_snap.customer.c_current_addr_sk
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag = 'Y'
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag = 'Y', tpcds_partitioned_parquet_snap.customer.c_current_addr_sk IS NOT NULL
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=10 row-size=17B cardinality=3.37M(filtered from 14.47M) cost=3846000
|  |     in pipelines: 09(GETNEXT)
|  |
|  21:AGGREGATE [FINALIZE]
|  |  group by: substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, 1, 5)
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=10.17K cost=56268
|  |  in pipelines: 21(GETNEXT), 04(OPEN)
|  |
|  20:EXCHANGE [HASH(substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, 1, 5))]
|  |  mem-estimate=279.19KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=101.71K cost=16914
|  |  in pipelines: 04(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=26.62MB mem-reservation=2.12MB thread-reservation=1
|  max-parallelism=10 segment-costs=[2861978, 131002] cpu-comparison-result=11 [max(10 (self) vs 11 (sum children))]
|  07:AGGREGATE [STREAMING]
|  |  group by: substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT))
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=101.71K cost=703928
|  |  in pipelines: 04(GETNEXT)
|  |
|  06:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash-table-id=02
|  |  hash predicates: substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, 1, 5) = EXPR$0
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4 row-size=17B cardinality=1.50M cost=656550
|  |  in pipelines: 04(GETNEXT)
|  |
|  |--F16:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=2.95MB mem-reservation=2.94MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[930]
|  |  JOIN BUILD
|  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  build expressions: EXPR$0
|  |  |  runtime filters: RF004[bloom] <- EXPR$0
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=400
|  |  |
|  |  19:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=6 row-size=12B cardinality=400 cost=530
|  |  |  in pipelines: <none>
|  |  |
|  |  F03:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=64.00KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[21]
|  |  05:UNION
|  |     constant-operands=400
|  |     mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |     tuple-ids=6 row-size=12B cardinality=400 cost=0
|  |     in pipelines: <none>
|  |
|  04:SCAN HDFS [tpcds_partitioned_parquet_snap.customer_address, RANDOM]
|     HDFS partitions=1/1 files=1 size=307.36MB
|     predicates: substr(substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)), CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL
|     runtime filters: RF004[bloom] -> substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, 1, 5)
|     stored statistics:
|       table: rows=15.00M size=307.36MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1.58M
|     parquet dictionary predicates: substr(substr(tpcds_partitioned_parquet_snap.customer_address.ca_zip, CAST(1 AS BIGINT), CAST(5 AS BIGINT)), CAST(1 AS BIGINT), CAST(2 AS BIGINT)) IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=4 row-size=17B cardinality=1.50M cost=1501500
|     in pipelines: 04(GETNEXT)
|
02:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=04
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=24B cardinality=803.40M cost=351649143
|  in pipelines: 00(GETNEXT), 01(OPEN)
|
|--F18:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=24.27MB mem-reservation=24.25MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[426]
|  JOIN BUILD
|  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=23.25MB mem-reservation=23.25MB spill-buffer=64.00KB thread-reservation=0 cost=186
|  |
|  18:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=186 cost=240
|  |  in pipelines: 01(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[18790]
|  01:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1998 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1998 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = CAST(1998 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_qoy = CAST(2 AS INT), tpcds_partitioned_parquet_snap.date_dim.d_date_sk IS NOT NULL
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=186 cost=18780
|     in pipelines: 01(GETNEXT)
|
00:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   partition predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk IS NOT NULL
   HDFS partitions=1823/1824 files=1823 size=389.69GB
   predicates: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk IS NOT NULL
   runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_store_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_store_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1823/1823 rows=8.25G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=12.24M est-scan-range=186(filtered from 1823)
   parquet dictionary predicates: tpcds_partitioned_parquet_snap.store_sales.ss_store_sk IS NOT NULL
   mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
   tuple-ids=0 row-size=12B cardinality=803.40M(filtered from 7.88G) cost=169007870
   in pipelines: 00(GETNEXT)
====
