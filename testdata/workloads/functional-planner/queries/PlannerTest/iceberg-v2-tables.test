SELECT count(*) from iceberg_v2_no_deletes
---- PLAN
PLAN-ROOT SINK
|
00:UNION
   constant-operands=1
   row-size=8B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
00:UNION
   constant-operands=1
   row-size=8B cardinality=1
====
SELECT count(*) from iceberg_v2_no_deletes where i > 1
---- PLAN
PLAN-ROOT SINK
|
01:AGGREGATE [FINALIZE]
|  output: count(*)
|  row-size=8B cardinality=1
|
00:SCAN HDFS [functional_parquet.iceberg_v2_no_deletes]
   HDFS partitions=1/1 files=1 size=625B
   predicates: i > 1
   Iceberg snapshot id: 728158873687794725
   row-size=4B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
03:AGGREGATE [FINALIZE]
|  output: count:merge(*)
|  row-size=8B cardinality=1
|
02:EXCHANGE [UNPARTITIONED]
|
01:AGGREGATE
|  output: count(*)
|  row-size=8B cardinality=1
|
00:SCAN HDFS [functional_parquet.iceberg_v2_no_deletes]
   HDFS partitions=1/1 files=1 size=625B
   predicates: i > 1
   Iceberg snapshot id: 728158873687794725
   row-size=4B cardinality=1
====
SELECT count(*) from iceberg_v2_delete_positional;
---- PLAN
PLAN-ROOT SINK
|
03:AGGREGATE [FINALIZE]
|  output: count(*)
|  row-size=8B cardinality=1
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  row-size=20B cardinality=2
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_positional-position-delete]
|     HDFS partitions=1/1 files=1 size=1.54KB
|     Iceberg snapshot id: 5725822353600261755
|     row-size=182B cardinality=1
|
00:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional]
   HDFS partitions=1/1 files=1 size=662B
   Iceberg snapshot id: 5725822353600261755
   row-size=20B cardinality=3
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
06:AGGREGATE [FINALIZE]
|  output: count:merge(*)
|  row-size=8B cardinality=1
|
05:EXCHANGE [UNPARTITIONED]
|
03:AGGREGATE
|  output: count(*)
|  row-size=8B cardinality=1
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  row-size=20B cardinality=2
|
|--04:EXCHANGE [DIRECTED]
|  |
|  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_positional-position-delete]
|     HDFS partitions=1/1 files=1 size=1.54KB
|     Iceberg snapshot id: 5725822353600261755
|     row-size=182B cardinality=1
|
00:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional]
   HDFS partitions=1/1 files=1 size=662B
   Iceberg snapshot id: 5725822353600261755
   row-size=20B cardinality=3
====
SELECT * from iceberg_v2_delete_positional;
---- PLAN
PLAN-ROOT SINK
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  row-size=40B cardinality=2
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_positional-position-delete]
|     HDFS partitions=1/1 files=1 size=1.54KB
|     Iceberg snapshot id: 5725822353600261755
|     row-size=182B cardinality=1
|
00:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional]
   HDFS partitions=1/1 files=1 size=662B
   Iceberg snapshot id: 5725822353600261755
   row-size=40B cardinality=3
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
04:EXCHANGE [UNPARTITIONED]
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  row-size=40B cardinality=2
|
|--03:EXCHANGE [DIRECTED]
|  |
|  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_positional-position-delete]
|     HDFS partitions=1/1 files=1 size=1.54KB
|     Iceberg snapshot id: 5725822353600261755
|     row-size=182B cardinality=1
|
00:SCAN HDFS [functional_parquet.iceberg_v2_delete_positional]
   HDFS partitions=1/1 files=1 size=662B
   Iceberg snapshot id: 5725822353600261755
   row-size=40B cardinality=3
====
SELECT * from iceberg_v2_positional_delete_all_rows;
---- PLAN
PLAN-ROOT SINK
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  row-size=36B cardinality=1
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete]
|     HDFS partitions=1/1 files=1 size=2.60KB
|     Iceberg snapshot id: 444149380144800647
|     row-size=246B cardinality=3
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 444149380144800647
   row-size=36B cardinality=3
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
04:EXCHANGE [UNPARTITIONED]
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  row-size=36B cardinality=1
|
|--03:EXCHANGE [DIRECTED]
|  |
|  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete]
|     HDFS partitions=1/1 files=1 size=2.60KB
|     Iceberg snapshot id: 444149380144800647
|     row-size=246B cardinality=3
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 444149380144800647
   row-size=36B cardinality=3
====
SELECT * from iceberg_v2_no_deletes limit 1
---- PLAN
PLAN-ROOT SINK
|
00:SCAN HDFS [functional_parquet.iceberg_v2_no_deletes]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 728158873687794725
   limit: 1
   row-size=16B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
01:EXCHANGE [UNPARTITIONED]
|  limit: 1
|
00:SCAN HDFS [functional_parquet.iceberg_v2_no_deletes]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 728158873687794725
   limit: 1
   row-size=16B cardinality=1
====
SELECT * from iceberg_v2_positional_delete_all_rows limit 1
---- PLAN
PLAN-ROOT SINK
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  limit: 1
|  row-size=36B cardinality=1
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete]
|     HDFS partitions=1/1 files=1 size=2.60KB
|     Iceberg snapshot id: 444149380144800647
|     row-size=246B cardinality=3
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 444149380144800647
   row-size=36B cardinality=3
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
04:EXCHANGE [UNPARTITIONED]
|  limit: 1
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  limit: 1
|  row-size=36B cardinality=1
|
|--03:EXCHANGE [DIRECTED]
|  |
|  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_delete_all_rows-position-delete]
|     HDFS partitions=1/1 files=1 size=2.60KB
|     Iceberg snapshot id: 444149380144800647
|     row-size=246B cardinality=3
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_delete_all_rows]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 444149380144800647
   row-size=36B cardinality=3
====
SELECT * from iceberg_v2_positional_not_all_data_files_have_delete_files limit 1
---- PLAN
PLAN-ROOT SINK
|
04:UNION
|  pass-through-operands: all
|  limit: 1
|  row-size=36B cardinality=1
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  row-size=36B cardinality=2
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     row-size=36B cardinality=6
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   row-size=36B cardinality=4
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
06:EXCHANGE [UNPARTITIONED]
|  limit: 1
|
04:UNION
|  pass-through-operands: all
|  limit: 1
|  row-size=36B cardinality=1
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  row-size=36B cardinality=2
|  |
|  |--05:EXCHANGE [DIRECTED]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     row-size=36B cardinality=6
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   row-size=36B cardinality=4
====
SELECT * from iceberg_v2_positional_not_all_data_files_have_delete_files
---- PLAN
PLAN-ROOT SINK
|
04:UNION
|  pass-through-operands: all
|  row-size=36B cardinality=6
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  row-size=36B cardinality=2
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     row-size=36B cardinality=6
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   row-size=36B cardinality=4
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
06:EXCHANGE [UNPARTITIONED]
|
04:UNION
|  pass-through-operands: all
|  row-size=36B cardinality=6
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  row-size=36B cardinality=2
|  |
|  |--05:EXCHANGE [DIRECTED]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     row-size=36B cardinality=6
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   row-size=36B cardinality=4
====
SELECT count(*) from iceberg_v2_positional_not_all_data_files_have_delete_files for system_version as of 7490459762454857930;
---- PLAN
PLAN-ROOT SINK
|
00:UNION
   constant-operands=1
   row-size=8B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
00:UNION
   constant-operands=1
   row-size=8B cardinality=1
====
SELECT count(*) from iceberg_v2_positional_not_all_data_files_have_delete_files for system_version as of 752781918366351945;
---- PLAN
PLAN-ROOT SINK
|
03:AGGREGATE [FINALIZE]
|  output: count(*)
|  row-size=8B cardinality=1
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  row-size=20B cardinality=2
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|     HDFS partitions=1/1 files=1 size=2.63KB
|     Iceberg snapshot id: 752781918366351945
|     row-size=267B cardinality=1
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 752781918366351945
   row-size=20B cardinality=3
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
06:AGGREGATE [FINALIZE]
|  output: count:merge(*)
|  row-size=8B cardinality=1
|
05:EXCHANGE [UNPARTITIONED]
|
03:AGGREGATE
|  output: count(*)
|  row-size=8B cardinality=1
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  row-size=20B cardinality=2
|
|--04:EXCHANGE [DIRECTED]
|  |
|  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|     HDFS partitions=1/1 files=1 size=2.63KB
|     Iceberg snapshot id: 752781918366351945
|     row-size=267B cardinality=1
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 752781918366351945
   row-size=20B cardinality=3
====
SELECT count(*) from iceberg_v2_positional_not_all_data_files_have_delete_files for system_time as of "2022-08-19 13:50:00";
---- PLAN
PLAN-ROOT SINK
|
03:AGGREGATE [FINALIZE]
|  output: count(*)
|  row-size=8B cardinality=1
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  row-size=20B cardinality=2
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|     HDFS partitions=1/1 files=1 size=2.63KB
|     Iceberg snapshot id: 752781918366351945
|     row-size=267B cardinality=1
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 752781918366351945
   row-size=20B cardinality=3
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
06:AGGREGATE [FINALIZE]
|  output: count:merge(*)
|  row-size=8B cardinality=1
|
05:EXCHANGE [UNPARTITIONED]
|
03:AGGREGATE
|  output: count(*)
|  row-size=8B cardinality=1
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  row-size=20B cardinality=2
|
|--04:EXCHANGE [DIRECTED]
|  |
|  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|     HDFS partitions=1/1 files=1 size=2.63KB
|     Iceberg snapshot id: 752781918366351945
|     row-size=267B cardinality=1
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 752781918366351945
   row-size=20B cardinality=3
====
SELECT count(*) from iceberg_v2_positional_not_all_data_files_have_delete_files;
---- PLAN
PLAN-ROOT SINK
|
03:AGGREGATE [FINALIZE]
|  output: count(*)
|  row-size=8B cardinality=1
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  row-size=20B cardinality=2
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|     HDFS partitions=1/1 files=2 size=5.33KB
|     Iceberg snapshot id: 1497619269847778439
|     row-size=267B cardinality=4
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   row-size=20B cardinality=6
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
06:AGGREGATE [FINALIZE]
|  output: count:merge(*)
|  row-size=8B cardinality=1
|
05:EXCHANGE [UNPARTITIONED]
|
03:AGGREGATE
|  output: count(*)
|  row-size=8B cardinality=1
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  row-size=20B cardinality=2
|
|--04:EXCHANGE [DIRECTED]
|  |
|  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|     HDFS partitions=1/1 files=2 size=5.33KB
|     Iceberg snapshot id: 1497619269847778439
|     row-size=267B cardinality=4
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   row-size=20B cardinality=6
====
SELECT * from iceberg_v2_positional_update_all_rows
---- PLAN
PLAN-ROOT SINK
|
04:UNION
|  pass-through-operands: all
|  row-size=36B cardinality=4
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  row-size=36B cardinality=1
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_update_all_rows-position-delete]
|  |     HDFS partitions=1/1 files=1 size=2.60KB
|  |     Iceberg snapshot id: 3877007445826010687
|  |     row-size=246B cardinality=3
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows]
|     HDFS partitions=1/1 files=1 size=625B
|     Iceberg snapshot id: 3877007445826010687
|     row-size=36B cardinality=3
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 3877007445826010687
   row-size=36B cardinality=3
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
06:EXCHANGE [UNPARTITIONED]
|
04:UNION
|  pass-through-operands: all
|  row-size=36B cardinality=4
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  row-size=36B cardinality=1
|  |
|  |--05:EXCHANGE [DIRECTED]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_update_all_rows-position-delete]
|  |     HDFS partitions=1/1 files=1 size=2.60KB
|  |     Iceberg snapshot id: 3877007445826010687
|  |     row-size=246B cardinality=3
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows]
|     HDFS partitions=1/1 files=1 size=625B
|     Iceberg snapshot id: 3877007445826010687
|     row-size=36B cardinality=3
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows]
   HDFS partitions=1/1 files=1 size=625B
   Iceberg snapshot id: 3877007445826010687
   row-size=36B cardinality=3
====
SELECT * from iceberg_v2_partitioned_position_deletes
---- PLAN
PLAN-ROOT SINK
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  row-size=64B cardinality=10
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete]
|     HDFS partitions=1/1 files=3 size=9.47KB
|     Iceberg snapshot id: 8885697082976537578
|     row-size=204B cardinality=10
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes]
   HDFS partitions=1/1 files=3 size=3.48KB
   Iceberg snapshot id: 8885697082976537578
   row-size=64B cardinality=20
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
04:EXCHANGE [UNPARTITIONED]
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  row-size=64B cardinality=10
|
|--03:EXCHANGE [DIRECTED]
|  |
|  01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete]
|     HDFS partitions=1/1 files=3 size=9.47KB
|     Iceberg snapshot id: 8885697082976537578
|     row-size=204B cardinality=10
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes]
   HDFS partitions=1/1 files=3 size=3.48KB
   Iceberg snapshot id: 8885697082976537578
   row-size=64B cardinality=20
====
SELECT * from iceberg_v2_positional_not_all_data_files_have_delete_files
WHERE i > 2
---- PLAN
PLAN-ROOT SINK
|
04:UNION
|  pass-through-operands: all
|  row-size=36B cardinality=2
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  row-size=36B cardinality=1
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     predicates: i > 2
|     Iceberg snapshot id: 1497619269847778439
|     row-size=36B cardinality=1
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   predicates: i > 2
   Iceberg snapshot id: 1497619269847778439
   row-size=36B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
06:EXCHANGE [UNPARTITIONED]
|
04:UNION
|  pass-through-operands: all
|  row-size=36B cardinality=2
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  row-size=36B cardinality=1
|  |
|  |--05:EXCHANGE [DIRECTED]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     predicates: i > 2
|     Iceberg snapshot id: 1497619269847778439
|     row-size=36B cardinality=1
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   predicates: i > 2
   Iceberg snapshot id: 1497619269847778439
   row-size=36B cardinality=1
====
select * from iceberg_v2_positional_not_all_data_files_have_delete_files for system_version as of 1497619269847778439
minus
select * from iceberg_v2_positional_not_all_data_files_have_delete_files for system_version as of 4363979609026842966;
---- PLAN
PLAN-ROOT SINK
|
07:HASH JOIN [LEFT ANTI JOIN]
|  hash predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  row-size=16B cardinality=6
|
|--06:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=1 size=625B
|     Iceberg snapshot id: 4363979609026842966
|     row-size=16B cardinality=3
|
05:AGGREGATE [FINALIZE]
|  group by: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  row-size=16B cardinality=6
|
04:UNION
|  pass-through-operands: all
|  row-size=36B cardinality=6
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  row-size=36B cardinality=2
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     row-size=36B cardinality=6
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   row-size=36B cardinality=4
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
12:EXCHANGE [UNPARTITIONED]
|
07:HASH JOIN [LEFT ANTI JOIN, PARTITIONED]
|  hash predicates: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  row-size=16B cardinality=6
|
|--11:EXCHANGE [HASH(functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i,functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s)]
|  |
|  06:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=1 size=625B
|     Iceberg snapshot id: 4363979609026842966
|     row-size=16B cardinality=3
|
10:AGGREGATE [FINALIZE]
|  group by: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  row-size=16B cardinality=6
|
09:EXCHANGE [HASH(functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i,functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s)]
|
05:AGGREGATE [STREAMING]
|  group by: functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.i, functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files.s
|  row-size=16B cardinality=6
|
04:UNION
|  pass-through-operands: all
|  row-size=36B cardinality=6
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  row-size=36B cardinality=2
|  |
|  |--08:EXCHANGE [DIRECTED]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     row-size=36B cardinality=6
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   row-size=36B cardinality=4
====
with v as (select i + 1000 as ii, upper(s) as ss from iceberg_v2_positional_not_all_data_files_have_delete_files)
select * from v where ii > 1003;
---- PLAN
PLAN-ROOT SINK
|
04:UNION
|  pass-through-operands: all
|  row-size=36B cardinality=2
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  row-size=36B cardinality=1
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     predicates: i + 1000 > 1003
|     Iceberg snapshot id: 1497619269847778439
|     row-size=36B cardinality=1
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   predicates: i + 1000 > 1003
   Iceberg snapshot id: 1497619269847778439
   row-size=36B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
06:EXCHANGE [UNPARTITIONED]
|
04:UNION
|  pass-through-operands: all
|  row-size=36B cardinality=2
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  row-size=36B cardinality=1
|  |
|  |--05:EXCHANGE [DIRECTED]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     predicates: i + 1000 > 1003
|     Iceberg snapshot id: 1497619269847778439
|     row-size=36B cardinality=1
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   predicates: i + 1000 > 1003
   Iceberg snapshot id: 1497619269847778439
   row-size=36B cardinality=1
====
select *
from iceberg_v2_positional_not_all_data_files_have_delete_files
where i = (select max(i) from iceberg_v2_positional_update_all_rows);
---- PLAN
PLAN-ROOT SINK
|
11:HASH JOIN [LEFT SEMI JOIN]
|  hash predicates: i = max(i)
|  runtime filters: RF000 <- max(i)
|  row-size=36B cardinality=6
|
|--10:AGGREGATE [FINALIZE]
|  |  output: max(i)
|  |  row-size=4B cardinality=1
|  |
|  09:UNION
|  |  pass-through-operands: all
|  |  row-size=24B cardinality=4
|  |
|  |--07:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  |  row-size=24B cardinality=1
|  |  |
|  |  |--06:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows-POSITION-DELETE-06 functional_parquet.iceberg_v2_positional_update_all_rows-position-delete]
|  |  |     HDFS partitions=1/1 files=1 size=2.60KB
|  |  |     Iceberg snapshot id: 3877007445826010687
|  |  |     row-size=246B cardinality=3
|  |  |
|  |  05:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows]
|  |     HDFS partitions=1/1 files=1 size=625B
|  |     Iceberg snapshot id: 3877007445826010687
|  |     row-size=24B cardinality=3
|  |
|  08:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows]
|     HDFS partitions=1/1 files=1 size=625B
|     Iceberg snapshot id: 3877007445826010687
|     row-size=24B cardinality=3
|
04:UNION
|  pass-through-operands: all
|  row-size=36B cardinality=6
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  row-size=36B cardinality=2
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     runtime filters: RF000 -> i
|     Iceberg snapshot id: 1497619269847778439
|     row-size=36B cardinality=6
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   runtime filters: RF000 -> i
   Iceberg snapshot id: 1497619269847778439
   row-size=36B cardinality=4
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
17:EXCHANGE [UNPARTITIONED]
|
11:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  hash predicates: i = max(i)
|  runtime filters: RF000 <- max(i)
|  row-size=36B cardinality=6
|
|--16:EXCHANGE [BROADCAST]
|  |
|  15:AGGREGATE [FINALIZE]
|  |  output: max:merge(i)
|  |  row-size=4B cardinality=1
|  |
|  14:EXCHANGE [UNPARTITIONED]
|  |
|  10:AGGREGATE
|  |  output: max(i)
|  |  row-size=4B cardinality=1
|  |
|  09:UNION
|  |  pass-through-operands: all
|  |  row-size=24B cardinality=4
|  |
|  |--07:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  |  row-size=24B cardinality=1
|  |  |
|  |  |--13:EXCHANGE [DIRECTED]
|  |  |  |
|  |  |  06:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows-POSITION-DELETE-06 functional_parquet.iceberg_v2_positional_update_all_rows-position-delete]
|  |  |     HDFS partitions=1/1 files=1 size=2.60KB
|  |  |     Iceberg snapshot id: 3877007445826010687
|  |  |     row-size=246B cardinality=3
|  |  |
|  |  05:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows]
|  |     HDFS partitions=1/1 files=1 size=625B
|  |     Iceberg snapshot id: 3877007445826010687
|  |     row-size=24B cardinality=3
|  |
|  08:SCAN HDFS [functional_parquet.iceberg_v2_positional_update_all_rows]
|     HDFS partitions=1/1 files=1 size=625B
|     Iceberg snapshot id: 3877007445826010687
|     row-size=24B cardinality=3
|
04:UNION
|  pass-through-operands: all
|  row-size=36B cardinality=6
|
|--02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  row-size=36B cardinality=2
|  |
|  |--12:EXCHANGE [DIRECTED]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     runtime filters: RF000 -> i
|     Iceberg snapshot id: 1497619269847778439
|     row-size=36B cardinality=6
|
03:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   runtime filters: RF000 -> i
   Iceberg snapshot id: 1497619269847778439
   row-size=36B cardinality=4
====
select * from iceberg_v2_partitioned_position_deletes where action = 'download' and id > 0;
---- PLAN
PLAN-ROOT SINK
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  row-size=64B cardinality=1
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete]
|     HDFS partitions=1/1 files=1 size=3.18KB
|     Iceberg snapshot id: 8885697082976537578
|     row-size=207B cardinality=2
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes]
   HDFS partitions=1/1 files=1 size=1.17KB
   predicates: id > 0
   Iceberg snapshot id: 8885697082976537578
   skipped Iceberg predicates: action = 'download'
   row-size=64B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
04:EXCHANGE [UNPARTITIONED]
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  row-size=64B cardinality=1
|
|--03:EXCHANGE [DIRECTED]
|  |
|  01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete]
|     HDFS partitions=1/1 files=1 size=3.18KB
|     Iceberg snapshot id: 8885697082976537578
|     row-size=207B cardinality=2
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes]
   HDFS partitions=1/1 files=1 size=1.17KB
   predicates: id > 0
   Iceberg snapshot id: 8885697082976537578
   skipped Iceberg predicates: action = 'download'
   row-size=64B cardinality=1
====
select * from iceberg_v2_partitioned_position_deletes
where action = 'download' and user = 'Lisa';
---- PLAN
PLAN-ROOT SINK
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  row-size=64B cardinality=1
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete]
|     HDFS partitions=1/1 files=1 size=3.18KB
|     Iceberg snapshot id: 8885697082976537578
|     row-size=207B cardinality=2
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes]
   HDFS partitions=1/1 files=1 size=1.17KB
   predicates: `user` = 'Lisa'
   Iceberg snapshot id: 8885697082976537578
   skipped Iceberg predicates: action = 'download'
   row-size=64B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
04:EXCHANGE [UNPARTITIONED]
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  row-size=64B cardinality=1
|
|--03:EXCHANGE [DIRECTED]
|  |
|  01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete]
|     HDFS partitions=1/1 files=1 size=3.18KB
|     Iceberg snapshot id: 8885697082976537578
|     row-size=207B cardinality=2
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes]
   HDFS partitions=1/1 files=1 size=1.17KB
   predicates: `user` = 'Lisa'
   Iceberg snapshot id: 8885697082976537578
   skipped Iceberg predicates: action = 'download'
   row-size=64B cardinality=1
====
select event_time, action from iceberg_partitioned where (action = 'click' or action = 'view') and id > 0;
---- PLAN
PLAN-ROOT SINK
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=14 size=15.93KB
   predicates: id > 0
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: action IN ('click', 'view')
   row-size=32B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
01:EXCHANGE [UNPARTITIONED]
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=14 size=15.93KB
   predicates: id > 0
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: action IN ('click', 'view')
   row-size=32B cardinality=1
====
select event_time, action from iceberg_partitioned where action in ('click', 'view') and id > 0;
---- PLAN
PLAN-ROOT SINK
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=14 size=15.93KB
   predicates: id > 0
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: action IN ('click', 'view')
   row-size=32B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
01:EXCHANGE [UNPARTITIONED]
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=14 size=15.93KB
   predicates: id > 0
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: action IN ('click', 'view')
   row-size=32B cardinality=1
====
select event_time, action from iceberg_partitioned where (event_time='2020-01-01 11:00:00' or action = 'click') and id > 0;
---- PLAN
PLAN-ROOT SINK
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=6 size=6.85KB
   predicates: id > 0
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: (event_time = TIMESTAMP '2020-01-01 11:00:00' OR action = 'click')
   row-size=32B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
01:EXCHANGE [UNPARTITIONED]
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=6 size=6.85KB
   predicates: id > 0
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: (event_time = TIMESTAMP '2020-01-01 11:00:00' OR action = 'click')
   row-size=32B cardinality=1
====
select event_time, action from iceberg_partitioned where (event_time='2020-01-01 11:00:00' or action = 'click' or action = 'view') and id > 0;
---- PLAN
PLAN-ROOT SINK
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=14 size=15.93KB
   predicates: id > 0
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: (event_time = TIMESTAMP '2020-01-01 11:00:00' OR action = 'click' OR action = 'view')
   row-size=32B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
01:EXCHANGE [UNPARTITIONED]
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=14 size=15.93KB
   predicates: id > 0
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: (event_time = TIMESTAMP '2020-01-01 11:00:00' OR action = 'click' OR action = 'view')
   row-size=32B cardinality=1
====
select event_time, action from iceberg_partitioned where (event_time='2020-01-01 11:00:00' or action in ('click', 'view')) and id > 0;
---- PLAN
PLAN-ROOT SINK
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=14 size=15.93KB
   predicates: id > 0
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: (event_time = TIMESTAMP '2020-01-01 11:00:00' OR action IN ('click', 'view'))
   row-size=32B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
01:EXCHANGE [UNPARTITIONED]
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=14 size=15.93KB
   predicates: id > 0
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: (event_time = TIMESTAMP '2020-01-01 11:00:00' OR action IN ('click', 'view'))
   row-size=32B cardinality=1
====
select event_time, action from iceberg_partitioned where (event_time='2020-01-01 11:00:00' or action > 'a') and id > 0;
---- PLAN
PLAN-ROOT SINK
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=20 size=22.90KB
   predicates: id > 0
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: (event_time = TIMESTAMP '2020-01-01 11:00:00' OR action > 'a')
   row-size=32B cardinality=2
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
01:EXCHANGE [UNPARTITIONED]
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=20 size=22.90KB
   predicates: id > 0
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: (event_time = TIMESTAMP '2020-01-01 11:00:00' OR action > 'a')
   row-size=32B cardinality=2
====
# All predicates are pushed down to Iceberg and won't filter any further rows. Skip pushing it to Scan node.
select event_time, action from iceberg_partitioned where event_time='2020-01-01 11:00:00';
---- PLAN
PLAN-ROOT SINK
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=0 size=0B
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: event_time = TIMESTAMP '2020-01-01 11:00:00'
   row-size=28B cardinality=0
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
01:EXCHANGE [UNPARTITIONED]
|
00:SCAN HDFS [functional_parquet.iceberg_partitioned]
   HDFS partitions=1/1 files=0 size=0B
   Iceberg snapshot id: 8270633197658268308
   skipped Iceberg predicates: event_time = TIMESTAMP '2020-01-01 11:00:00'
   row-size=28B cardinality=0
====
# Similar as above but on a table with positional deletes on all data files.
select * from iceberg_v2_partitioned_position_deletes where action = 'download';
---- PLAN
PLAN-ROOT SINK
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  row-size=64B cardinality=4
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete]
|     HDFS partitions=1/1 files=1 size=3.18KB
|     Iceberg snapshot id: 8885697082976537578
|     row-size=207B cardinality=2
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes]
   HDFS partitions=1/1 files=1 size=1.17KB
   Iceberg snapshot id: 8885697082976537578
   skipped Iceberg predicates: action = 'download'
   row-size=64B cardinality=6
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
04:EXCHANGE [UNPARTITIONED]
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  row-size=64B cardinality=4
|
|--03:EXCHANGE [DIRECTED]
|  |
|  01:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes-POSITION-DELETE-01 functional_parquet.iceberg_v2_partitioned_position_deletes-position-delete]
|     HDFS partitions=1/1 files=1 size=3.18KB
|     Iceberg snapshot id: 8885697082976537578
|     row-size=207B cardinality=2
|
00:SCAN HDFS [functional_parquet.iceberg_v2_partitioned_position_deletes]
   HDFS partitions=1/1 files=1 size=1.17KB
   Iceberg snapshot id: 8885697082976537578
   skipped Iceberg predicates: action = 'download'
   row-size=64B cardinality=6
====
with u1 as (select count(*) from iceberg_v2_positional_not_all_data_files_have_delete_files),
u2 as (select -1 as c),
u3 as (select count(*) from iceberg_v2_positional_not_all_data_files_have_delete_files) select * from u1, u2, u3;
---- PLAN
PLAN-ROOT SINK
|
10:NESTED LOOP JOIN [CROSS JOIN]
|  row-size=17B cardinality=1
|
|--08:AGGREGATE [FINALIZE]
|  |  output: count(*)
|  |  row-size=8B cardinality=1
|  |
|  07:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  row-size=20B cardinality=2
|  |
|  |--06:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-06 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  05:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     row-size=20B cardinality=6
|
09:NESTED LOOP JOIN [CROSS JOIN]
|  row-size=9B cardinality=1
|
|--04:UNION
|     constant-operands=1
|     row-size=1B cardinality=1
|
03:AGGREGATE [FINALIZE]
|  output: count(*)
|  row-size=8B cardinality=1
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  row-size=20B cardinality=2
|
|--01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|     HDFS partitions=1/1 files=2 size=5.33KB
|     Iceberg snapshot id: 1497619269847778439
|     row-size=267B cardinality=4
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   row-size=20B cardinality=6
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
10:NESTED LOOP JOIN [CROSS JOIN, BROADCAST]
|  row-size=17B cardinality=1
|
|--18:EXCHANGE [UNPARTITIONED]
|  |
|  17:AGGREGATE [FINALIZE]
|  |  output: count:merge(*)
|  |  row-size=8B cardinality=1
|  |
|  16:EXCHANGE [UNPARTITIONED]
|  |
|  08:AGGREGATE
|  |  output: count(*)
|  |  row-size=8B cardinality=1
|  |
|  07:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  row-size=20B cardinality=2
|  |
|  |--15:EXCHANGE [DIRECTED]
|  |  |
|  |  06:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-06 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|  |     HDFS partitions=1/1 files=2 size=5.33KB
|  |     Iceberg snapshot id: 1497619269847778439
|  |     row-size=267B cardinality=4
|  |
|  05:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
|     HDFS partitions=1/1 files=2 size=1.22KB
|     Iceberg snapshot id: 1497619269847778439
|     row-size=20B cardinality=6
|
09:NESTED LOOP JOIN [CROSS JOIN, BROADCAST]
|  row-size=9B cardinality=1
|
|--14:EXCHANGE [UNPARTITIONED]
|  |
|  04:UNION
|     constant-operands=1
|     row-size=1B cardinality=1
|
13:AGGREGATE [FINALIZE]
|  output: count:merge(*)
|  row-size=8B cardinality=1
|
12:EXCHANGE [UNPARTITIONED]
|
03:AGGREGATE
|  output: count(*)
|  row-size=8B cardinality=1
|
02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  row-size=20B cardinality=2
|
|--11:EXCHANGE [DIRECTED]
|  |
|  01:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-POSITION-DELETE-01 functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files-position-delete]
|     HDFS partitions=1/1 files=2 size=5.33KB
|     Iceberg snapshot id: 1497619269847778439
|     row-size=267B cardinality=4
|
00:SCAN HDFS [functional_parquet.iceberg_v2_positional_not_all_data_files_have_delete_files]
   HDFS partitions=1/1 files=2 size=1.22KB
   Iceberg snapshot id: 1497619269847778439
   row-size=20B cardinality=6
====
select * from functional_parquet.iceberg_v2_delete_equality;
---- PLAN
PLAN-ROOT SINK
|
04:UNION
|  pass-through-operands: all
|  row-size=28B cardinality=3
|
|--02:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality.id IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality-equality-delete-01.id
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality-equality-delete-01.iceberg__data__sequence__number
|  |  row-size=28B cardinality=1
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality-equality-delete-01]
|  |     HDFS partitions=1/1 files=1 size=457B
|  |     Iceberg snapshot id: 5763349507283783091
|  |     row-size=16B cardinality=1
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality]
|     HDFS partitions=1/1 files=1 size=709B
|     Iceberg snapshot id: 5763349507283783091
|     row-size=28B cardinality=1
|
03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality]
   HDFS partitions=1/1 files=2 size=1.41KB
   Iceberg snapshot id: 5763349507283783091
   row-size=28B cardinality=2
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
06:EXCHANGE [UNPARTITIONED]
|
04:UNION
|  pass-through-operands: all
|  row-size=28B cardinality=3
|
|--02:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality.id IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality-equality-delete-01.id
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality-equality-delete-01.iceberg__data__sequence__number
|  |  row-size=28B cardinality=1
|  |
|  |--05:EXCHANGE [BROADCAST]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality-equality-delete-01]
|  |     HDFS partitions=1/1 files=1 size=457B
|  |     Iceberg snapshot id: 5763349507283783091
|  |     row-size=16B cardinality=1
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality]
|     HDFS partitions=1/1 files=1 size=709B
|     Iceberg snapshot id: 5763349507283783091
|     row-size=28B cardinality=1
|
03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality]
   HDFS partitions=1/1 files=2 size=1.41KB
   Iceberg snapshot id: 5763349507283783091
   row-size=28B cardinality=2
====
select * from functional_parquet.iceberg_v2_delete_equality for system_version as of 5763349507283783091;
---- PLAN
PLAN-ROOT SINK
|
04:UNION
|  pass-through-operands: all
|  row-size=28B cardinality=3
|
|--02:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality.id IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality-equality-delete-01.id
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality-equality-delete-01.iceberg__data__sequence__number
|  |  row-size=28B cardinality=1
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality-equality-delete-01]
|  |     HDFS partitions=1/1 files=1 size=457B
|  |     Iceberg snapshot id: 5763349507283783091
|  |     row-size=16B cardinality=1
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality]
|     HDFS partitions=1/1 files=1 size=709B
|     Iceberg snapshot id: 5763349507283783091
|     row-size=28B cardinality=1
|
03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality]
   HDFS partitions=1/1 files=2 size=1.41KB
   Iceberg snapshot id: 5763349507283783091
   row-size=28B cardinality=2
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
06:EXCHANGE [UNPARTITIONED]
|
04:UNION
|  pass-through-operands: all
|  row-size=28B cardinality=3
|
|--02:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality.id IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality-equality-delete-01.id
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality-equality-delete-01.iceberg__data__sequence__number
|  |  row-size=28B cardinality=1
|  |
|  |--05:EXCHANGE [BROADCAST]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality-equality-delete-01]
|  |     HDFS partitions=1/1 files=1 size=457B
|  |     Iceberg snapshot id: 5763349507283783091
|  |     row-size=16B cardinality=1
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality]
|     HDFS partitions=1/1 files=1 size=709B
|     Iceberg snapshot id: 5763349507283783091
|     row-size=28B cardinality=1
|
03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality]
   HDFS partitions=1/1 files=2 size=1.41KB
   Iceberg snapshot id: 5763349507283783091
   row-size=28B cardinality=2
====
# Table has both equality and positional delete files. Equality fields are (i int, d date).
select * from functional_parquet.iceberg_v2_delete_both_eq_and_pos;
---- PLAN
PLAN-ROOT SINK
|
06:UNION
|  pass-through-operands: all
|  row-size=48B cardinality=3
|
|--04:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_both_eq_and_pos.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03.d, functional_parquet.iceberg_v2_delete_both_eq_and_pos.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03.i
|  |  other join predicates: functional_parquet.iceberg_v2_delete_both_eq_and_pos.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03.iceberg__data__sequence__number
|  |  row-size=48B cardinality=1
|  |
|  |--03:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03]
|  |     HDFS partitions=1/1 files=1 size=657B
|  |     Iceberg snapshot id: 911559291487642581
|  |     row-size=16B cardinality=2
|  |
|  02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  row-size=48B cardinality=1
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_both_eq_and_pos-position-delete]
|  |     HDFS partitions=1/1 files=1 size=1.57KB
|  |     Iceberg snapshot id: 911559291487642581
|  |     row-size=187B cardinality=1
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos]
|     HDFS partitions=1/1 files=1 size=898B
|     Iceberg snapshot id: 911559291487642581
|     row-size=48B cardinality=2
|
05:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos]
   HDFS partitions=1/1 files=1 size=885B
   Iceberg snapshot id: 911559291487642581
   row-size=48B cardinality=2
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
09:EXCHANGE [UNPARTITIONED]
|
06:UNION
|  pass-through-operands: all
|  row-size=48B cardinality=3
|
|--04:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_both_eq_and_pos.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03.d, functional_parquet.iceberg_v2_delete_both_eq_and_pos.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03.i
|  |  other join predicates: functional_parquet.iceberg_v2_delete_both_eq_and_pos.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03.iceberg__data__sequence__number
|  |  row-size=48B cardinality=1
|  |
|  |--08:EXCHANGE [BROADCAST]
|  |  |
|  |  03:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_both_eq_and_pos-equality-delete-03]
|  |     HDFS partitions=1/1 files=1 size=657B
|  |     Iceberg snapshot id: 911559291487642581
|  |     row-size=16B cardinality=2
|  |
|  02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  row-size=48B cardinality=1
|  |
|  |--07:EXCHANGE [DIRECTED]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_both_eq_and_pos-position-delete]
|  |     HDFS partitions=1/1 files=1 size=1.57KB
|  |     Iceberg snapshot id: 911559291487642581
|  |     row-size=187B cardinality=1
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos]
|     HDFS partitions=1/1 files=1 size=898B
|     Iceberg snapshot id: 911559291487642581
|     row-size=48B cardinality=2
|
05:SCAN HDFS [functional_parquet.iceberg_v2_delete_both_eq_and_pos]
   HDFS partitions=1/1 files=1 size=885B
   Iceberg snapshot id: 911559291487642581
   row-size=48B cardinality=2
====
# Partitioned table with equality deletes.
select * from functional_parquet.iceberg_v2_delete_equality_partitioned
---- PLAN
PLAN-ROOT SINK
|
04:UNION
|  pass-through-operands: all
|  row-size=28B cardinality=8
|
|--02:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_partitioned.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.d, functional_parquet.iceberg_v2_delete_equality_partitioned.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_partitioned.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.iceberg__data__sequence__number
|  |  row-size=28B cardinality=5
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_partitioned-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01]
|  |     HDFS partitions=1/1 files=2 size=1.33KB
|  |     Iceberg snapshot id: 4821964189199835313
|  |     row-size=24B cardinality=3
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_partitioned]
|     HDFS partitions=1/1 files=2 size=1.76KB
|     Iceberg snapshot id: 4821964189199835313
|     row-size=28B cardinality=5
|
03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_partitioned]
   HDFS partitions=1/1 files=2 size=1.71KB
   Iceberg snapshot id: 4821964189199835313
   row-size=28B cardinality=3
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
07:EXCHANGE [UNPARTITIONED]
|
04:UNION
|  pass-through-operands: all
|  row-size=28B cardinality=8
|
|--02:HASH JOIN [LEFT ANTI JOIN, PARTITIONED]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_partitioned.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.d, functional_parquet.iceberg_v2_delete_equality_partitioned.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_partitioned.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.iceberg__data__sequence__number
|  |  row-size=28B cardinality=5
|  |
|  |--06:EXCHANGE [HASH(functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.d,functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01.s)]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_partitioned-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality_partitioned-equality-delete-01]
|  |     HDFS partitions=1/1 files=2 size=1.33KB
|  |     Iceberg snapshot id: 4821964189199835313
|  |     row-size=24B cardinality=3
|  |
|  05:EXCHANGE [HASH(functional_parquet.iceberg_v2_delete_equality_partitioned.d,functional_parquet.iceberg_v2_delete_equality_partitioned.s)]
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_partitioned]
|     HDFS partitions=1/1 files=2 size=1.76KB
|     Iceberg snapshot id: 4821964189199835313
|     row-size=28B cardinality=5
|
03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_partitioned]
   HDFS partitions=1/1 files=2 size=1.71KB
   Iceberg snapshot id: 4821964189199835313
   row-size=28B cardinality=3
====
# Table has some equality delete files with different equality field ID lists. These have
# separate HASH JOINs. The equality delete file SCANs with higher cardinality happen
# earlier.
select * from functional_parquet.iceberg_v2_delete_equality_multi_eq_ids;
---- PLAN
PLAN-ROOT SINK
|
08:UNION
|  pass-through-operands: all
|  row-size=24B cardinality=10
|
|--06:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-05.i
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-05.iceberg__data__sequence__number
|  |  row-size=24B cardinality=8
|  |
|  |--05:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-05 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-05]
|  |     HDFS partitions=1/1 files=1 size=444B
|  |     Iceberg snapshot id: 4077234998626563290
|  |     row-size=12B cardinality=1
|  |
|  04:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.iceberg__data__sequence__number
|  |  row-size=24B cardinality=8
|  |
|  |--03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03]
|  |     HDFS partitions=1/1 files=1 size=473B
|  |     Iceberg snapshot id: 4077234998626563290
|  |     row-size=20B cardinality=2
|  |
|  02:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.i, functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.iceberg__data__sequence__number
|  |  row-size=24B cardinality=8
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01]
|  |     HDFS partitions=1/1 files=1 size=726B
|  |     Iceberg snapshot id: 4077234998626563290
|  |     row-size=24B cardinality=2
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids]
|     HDFS partitions=1/1 files=3 size=1.99KB
|     Iceberg snapshot id: 4077234998626563290
|     row-size=24B cardinality=8
|
07:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids]
   HDFS partitions=1/1 files=1 size=713B
   Iceberg snapshot id: 4077234998626563290
   row-size=24B cardinality=2
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
12:EXCHANGE [UNPARTITIONED]
|
08:UNION
|  pass-through-operands: all
|  row-size=24B cardinality=10
|
|--06:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-05.i
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-05.iceberg__data__sequence__number
|  |  row-size=24B cardinality=8
|  |
|  |--11:EXCHANGE [BROADCAST]
|  |  |
|  |  05:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-05 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-05]
|  |     HDFS partitions=1/1 files=1 size=444B
|  |     Iceberg snapshot id: 4077234998626563290
|  |     row-size=12B cardinality=1
|  |
|  04:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.iceberg__data__sequence__number
|  |  row-size=24B cardinality=8
|  |
|  |--10:EXCHANGE [BROADCAST]
|  |  |
|  |  03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03]
|  |     HDFS partitions=1/1 files=1 size=473B
|  |     Iceberg snapshot id: 4077234998626563290
|  |     row-size=20B cardinality=2
|  |
|  02:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.i, functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.iceberg__data__sequence__number
|  |  row-size=24B cardinality=8
|  |
|  |--09:EXCHANGE [BROADCAST]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01]
|  |     HDFS partitions=1/1 files=1 size=726B
|  |     Iceberg snapshot id: 4077234998626563290
|  |     row-size=24B cardinality=2
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids]
|     HDFS partitions=1/1 files=3 size=1.99KB
|     Iceberg snapshot id: 4077234998626563290
|     row-size=24B cardinality=8
|
07:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids]
   HDFS partitions=1/1 files=1 size=713B
   Iceberg snapshot id: 4077234998626563290
   row-size=24B cardinality=2
====
# Similar as above but doing time travel to a snapshot where we don't have delete files
# for [i,s].
select * from functional_parquet.iceberg_v2_delete_equality_multi_eq_ids for system_version as of 5777805847908928861;
---- PLAN
PLAN-ROOT SINK
|
06:UNION
|  pass-through-operands: all
|  row-size=24B cardinality=8
|
|--04:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.i
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.iceberg__data__sequence__number
|  |  row-size=24B cardinality=4
|  |
|  |--03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03]
|  |     HDFS partitions=1/1 files=1 size=444B
|  |     Iceberg snapshot id: 5777805847908928861
|  |     row-size=12B cardinality=1
|  |
|  02:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.iceberg__data__sequence__number
|  |  row-size=24B cardinality=4
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01]
|  |     HDFS partitions=1/1 files=1 size=473B
|  |     Iceberg snapshot id: 5777805847908928861
|  |     row-size=20B cardinality=2
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids]
|     HDFS partitions=1/1 files=2 size=1.33KB
|     Iceberg snapshot id: 5777805847908928861
|     row-size=24B cardinality=4
|
05:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids]
   HDFS partitions=1/1 files=1 size=673B
   Iceberg snapshot id: 5777805847908928861
   row-size=24B cardinality=4
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
09:EXCHANGE [UNPARTITIONED]
|
06:UNION
|  pass-through-operands: all
|  row-size=24B cardinality=8
|
|--04:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.i
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03.iceberg__data__sequence__number
|  |  row-size=24B cardinality=4
|  |
|  |--08:EXCHANGE [BROADCAST]
|  |  |
|  |  03:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-03]
|  |     HDFS partitions=1/1 files=1 size=444B
|  |     Iceberg snapshot id: 5777805847908928861
|  |     row-size=12B cardinality=1
|  |
|  02:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_equality_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01.iceberg__data__sequence__number
|  |  row-size=24B cardinality=4
|  |
|  |--07:EXCHANGE [BROADCAST]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_delete_equality_multi_eq_ids-equality-delete-01]
|  |     HDFS partitions=1/1 files=1 size=473B
|  |     Iceberg snapshot id: 5777805847908928861
|  |     row-size=20B cardinality=2
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids]
|     HDFS partitions=1/1 files=2 size=1.33KB
|     Iceberg snapshot id: 5777805847908928861
|     row-size=24B cardinality=4
|
05:SCAN HDFS [functional_parquet.iceberg_v2_delete_equality_multi_eq_ids]
   HDFS partitions=1/1 files=1 size=673B
   Iceberg snapshot id: 5777805847908928861
   row-size=24B cardinality=4
====
# Table has both positional and equality delete files where some equality delete files
# have different equality field ID lists. First the join for the positional deletes is
# executed and then the joins for the different equality field id lists.
select * from functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids;
---- PLAN
PLAN-ROOT SINK
|
08:UNION
|  pass-through-operands: all
|  row-size=48B cardinality=6
|
|--06:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05.d, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05.iceberg__data__sequence__number
|  |  row-size=48B cardinality=4
|  |
|  |--05:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-EQUALITY-DELETE-05 functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05]
|  |     HDFS partitions=1/1 files=1 size=663B
|  |     Iceberg snapshot id: 152862018760071153
|  |     row-size=24B cardinality=2
|  |
|  04:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03.i, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03.iceberg__data__sequence__number
|  |  row-size=48B cardinality=4
|  |
|  |--03:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03]
|  |     HDFS partitions=1/1 files=1 size=656B
|  |     Iceberg snapshot id: 152862018760071153
|  |     row-size=24B cardinality=2
|  |
|  02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN]
|  |  row-size=48B cardinality=4
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-position-delete]
|  |     HDFS partitions=1/1 files=1 size=1.59KB
|  |     Iceberg snapshot id: 152862018760071153
|  |     row-size=192B cardinality=1
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids]
|     HDFS partitions=1/1 files=2 size=1.68KB
|     Iceberg snapshot id: 152862018760071153
|     row-size=48B cardinality=5
|
07:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids]
   HDFS partitions=1/1 files=1 size=853B
   Iceberg snapshot id: 152862018760071153
   row-size=48B cardinality=2
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
12:EXCHANGE [UNPARTITIONED]
|
08:UNION
|  pass-through-operands: all
|  row-size=48B cardinality=6
|
|--06:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05.d, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05.iceberg__data__sequence__number
|  |  row-size=48B cardinality=4
|  |
|  |--11:EXCHANGE [BROADCAST]
|  |  |
|  |  05:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-EQUALITY-DELETE-05 functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-05]
|  |     HDFS partitions=1/1 files=1 size=663B
|  |     Iceberg snapshot id: 152862018760071153
|  |     row-size=24B cardinality=2
|  |
|  04:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03.i, functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.s IS NOT DISTINCT FROM functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03.s
|  |  other join predicates: functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids.iceberg__data__sequence__number < functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03.iceberg__data__sequence__number
|  |  row-size=48B cardinality=4
|  |
|  |--10:EXCHANGE [BROADCAST]
|  |  |
|  |  03:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-EQUALITY-DELETE-03 functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-equality-delete-03]
|  |     HDFS partitions=1/1 files=1 size=656B
|  |     Iceberg snapshot id: 152862018760071153
|  |     row-size=24B cardinality=2
|  |
|  02:DELETE EVENTS ICEBERG DELETE [ICEBERG DELETE JOIN, DIRECTED]
|  |  row-size=48B cardinality=4
|  |
|  |--09:EXCHANGE [DIRECTED]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-POSITION-DELETE-01 functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids-position-delete]
|  |     HDFS partitions=1/1 files=1 size=1.59KB
|  |     Iceberg snapshot id: 152862018760071153
|  |     row-size=192B cardinality=1
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids]
|     HDFS partitions=1/1 files=2 size=1.68KB
|     Iceberg snapshot id: 152862018760071153
|     row-size=48B cardinality=5
|
07:SCAN HDFS [functional_parquet.iceberg_v2_delete_pos_and_multi_eq_ids]
   HDFS partitions=1/1 files=1 size=853B
   Iceberg snapshot id: 152862018760071153
   row-size=48B cardinality=2
====
select count(*) from functional_parquet.iceberg_spark_compaction_with_dangling_delete;
---- PLAN
PLAN-ROOT SINK
|
00:UNION
   constant-operands=1
   row-size=8B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
00:UNION
   constant-operands=1
   row-size=8B cardinality=1
====
select count(*) from functional_parquet.iceberg_spark_compaction_with_dangling_delete for system_time as of "2024-03-22 19:04:00";
---- PLAN
PLAN-ROOT SINK
|
00:UNION
   constant-operands=1
   row-size=8B cardinality=1
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
00:UNION
   constant-operands=1
   row-size=8B cardinality=1
====
# Query a table that has schema evolution and equality deletes.
select * from functional_parquet.iceberg_v2_equality_delete_schema_evolution;
---- PLAN
PLAN-ROOT SINK
|
04:UNION
|  pass-through-operands: all
|  row-size=32B cardinality=6
|
|--02:HASH JOIN [LEFT ANTI JOIN]
|  |  hash predicates: functional_parquet.iceberg_v2_equality_delete_schema_evolution.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01.d, functional_parquet.iceberg_v2_equality_delete_schema_evolution.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01.i
|  |  other join predicates: functional_parquet.iceberg_v2_equality_delete_schema_evolution.iceberg__data__sequence__number < functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01.iceberg__data__sequence__number
|  |  row-size=32B cardinality=4
|  |
|  |--01:SCAN HDFS [functional_parquet.iceberg_v2_equality_delete_schema_evolution-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01]
|  |     HDFS partitions=1/1 files=3 size=1.97KB
|  |     Iceberg snapshot id: 5816823095034839884
|  |     row-size=16B cardinality=3
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_equality_delete_schema_evolution]
|     HDFS partitions=1/1 files=2 size=1.63KB
|     Iceberg snapshot id: 5816823095034839884
|     row-size=32B cardinality=4
|
03:SCAN HDFS [functional_parquet.iceberg_v2_equality_delete_schema_evolution]
   HDFS partitions=1/1 files=2 size=1.90KB
   Iceberg snapshot id: 5816823095034839884
   row-size=32B cardinality=2
---- DISTRIBUTEDPLAN
PLAN-ROOT SINK
|
06:EXCHANGE [UNPARTITIONED]
|
04:UNION
|  pass-through-operands: all
|  row-size=32B cardinality=6
|
|--02:HASH JOIN [LEFT ANTI JOIN, BROADCAST]
|  |  hash predicates: functional_parquet.iceberg_v2_equality_delete_schema_evolution.d IS NOT DISTINCT FROM functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01.d, functional_parquet.iceberg_v2_equality_delete_schema_evolution.i IS NOT DISTINCT FROM functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01.i
|  |  other join predicates: functional_parquet.iceberg_v2_equality_delete_schema_evolution.iceberg__data__sequence__number < functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01.iceberg__data__sequence__number
|  |  row-size=32B cardinality=4
|  |
|  |--05:EXCHANGE [BROADCAST]
|  |  |
|  |  01:SCAN HDFS [functional_parquet.iceberg_v2_equality_delete_schema_evolution-EQUALITY-DELETE-01 functional_parquet.iceberg_v2_equality_delete_schema_evolution-equality-delete-01]
|  |     HDFS partitions=1/1 files=3 size=1.97KB
|  |     Iceberg snapshot id: 5816823095034839884
|  |     row-size=16B cardinality=3
|  |
|  00:SCAN HDFS [functional_parquet.iceberg_v2_equality_delete_schema_evolution]
|     HDFS partitions=1/1 files=2 size=1.63KB
|     Iceberg snapshot id: 5816823095034839884
|     row-size=32B cardinality=4
|
03:SCAN HDFS [functional_parquet.iceberg_v2_equality_delete_schema_evolution]
   HDFS partitions=1/1 files=2 size=1.90KB
   Iceberg snapshot id: 5816823095034839884
   row-size=32B cardinality=2
====
