====
---- QUERY
# Basic ROLLUP.
select int_col, string_col, bool_col, count(*)
from alltypesagg
group by rollup(1, 2, 3)
order by count(*) desc, 1, 2, 3
limit 20
---- RESULTS
NULL,'NULL',NULL,11000
10,'10',true,20
10,'10',NULL,20
10,'NULL',NULL,20
20,'20',true,20
20,'20',NULL,20
20,'NULL',NULL,20
30,'30',true,20
30,'30',NULL,20
30,'NULL',NULL,20
40,'40',true,20
40,'40',NULL,20
40,'NULL',NULL,20
50,'50',true,20
50,'50',NULL,20
50,'NULL',NULL,20
60,'60',true,20
60,'60',NULL,20
60,'NULL',NULL,20
70,'70',true,20
---- TYPES
INT,STRING,BOOLEAN,BIGINT
====
---- QUERY
# Basic CUBE
select int_col, string_col, bool_col, count(*)
from alltypesagg
group by cube(1, 2, 3)
order by count(*) desc, 1, 2, 3
limit 20
---- RESULTS
NULL,'NULL',NULL,11000
NULL,'NULL',true,6000
NULL,'NULL',false,5000
10,'10',true,20
10,'10',NULL,20
10,'NULL',true,20
10,'NULL',NULL,20
20,'20',true,20
20,'20',NULL,20
20,'NULL',true,20
20,'NULL',NULL,20
30,'30',true,20
30,'30',NULL,20
30,'NULL',true,20
30,'NULL',NULL,20
40,'40',true,20
40,'40',NULL,20
40,'NULL',true,20
40,'NULL',NULL,20
50,'50',true,20
---- TYPES
INT,STRING,BOOLEAN,BIGINT
====
---- QUERY
# Basic GROUPING SETS
select int_col, string_col, bool_col, count(*)
from alltypesagg
group by grouping sets((int_col), (string_col), (int_col, bool_col))
order by count(*) desc, 1, 2, 3
limit 20
---- RESULTS
10,'NULL',true,20
10,'NULL',NULL,20
20,'NULL',true,20
20,'NULL',NULL,20
30,'NULL',true,20
30,'NULL',NULL,20
40,'NULL',true,20
40,'NULL',NULL,20
50,'NULL',true,20
50,'NULL',NULL,20
60,'NULL',true,20
60,'NULL',NULL,20
70,'NULL',true,20
70,'NULL',NULL,20
80,'NULL',true,20
80,'NULL',NULL,20
90,'NULL',true,20
90,'NULL',NULL,20
100,'NULL',true,20
100,'NULL',NULL,20
---- TYPES
INT,STRING,BOOLEAN,BIGINT
====
---- QUERY
# Output should contain a row for both the NULL value in
# int_col and the rollup of all values in int_col.
select year, int_col, count(*)
from alltypesagg
group by rollup(year, int_col)
order by 2 desc, 1, 3
limit 10
---- RESULTS
2010,NULL,20
2010,NULL,11000
NULL,NULL,11000
2010,999,10
2010,998,10
2010,997,10
2010,996,10
2010,995,10
2010,994,10
2010,993,10
---- TYPES
INT, INT, BIGINT
====
---- QUERY
# Output should contain a row for both the NULL value in
# int_col and the rollup of all values in int_col.
select year, int_col, count(*)
from alltypesagg
group by rollup(year, int_col)
having int_col is NULL
---- RESULTS
NULL,NULL,11000
2010,NULL,20
2010,NULL,11000
---- TYPES
INT, INT, BIGINT
====
---- QUERY
# Correlated subquery with rollup. Results are the same as
# if rollup was not present.
select id
from functional.alltypesagg a
where exists
  (select id
   from functional.alltypestiny b
   where a.tinyint_col = b.tinyint_col and a.string_col = b.string_col
   group by rollup(id, int_col, bool_col))
  and tinyint_col < 10
---- RESULTS
1
1001
2001
3001
4001
5001
6001
7001
8001
9001
---- TYPES
INT
====
