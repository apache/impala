<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2022"><meta name="DC.rights.owner" content="(C) Copyright 2022"><meta name="DC.Type" content="concept"><meta name="DC.Relation" scheme="URI" content="../topics/impala_fault_tolerance.html"><meta name="prodname" content="Impala"><meta name="version" content="Impala 3.4.x"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="transparent_query_retries"><link rel="stylesheet" type="text/css" href="../css/commonltr.css"><link rel="stylesheet" type="text/css" href="../css/dita-ot-doc.css"><title>Impala Transparent Query Retries</title></head><body id="transparent_query_retries"><header role="banner"><!--
The DITA Open Toolkit is licensed for use under the the Apache
Software Foundation License v2.0.

A copy of the Apache Software Foundation License 2.0 is
available at http://opensource.org/licenses/apache2.0.php

This statement must be included in any copies of DITA Open
Toolkit code.
--><div class="header">
  <p>Apache Impala</p>
  <hr>
</div></header><nav role="toc"><ul><li><a href="../topics/impala_intro.html">Introducing Apache Impala</a></li><li><a href="../topics/impala_concepts.html">Concepts and Architecture</a></li><li><a href="../topics/impala_planning.html">Deployment Planning</a></li><li><a href="../topics/impala_install.html">Installing Impala</a></li><li><a href="../topics/impala_config.html">Managing Impala</a></li><li><a href="../topics/impala_upgrading.html">Upgrading Impala</a></li><li><a href="../topics/impala_processes.html">Starting Impala</a></li><li><a href="../topics/impala_tutorial.html">Tutorials</a></li><li><a href="../topics/impala_admin.html">Administration</a></li><li><a href="../topics/impala_security.html">Impala Security</a></li><li><a href="../topics/impala_langref.html">SQL Reference</a></li><li><a href="../topics/impala_performance.html">Performance Tuning</a></li><li><a href="../topics/impala_scalability.html">Scalability Considerations</a></li><li><a href="../topics/impala_resource_management.html">Resource Management</a></li><li><a href="../topics/impala_partitioning.html">Partitioning</a></li><li><a href="../topics/impala_file_formats.html">File Formats</a></li><li><a href="../topics/impala_kudu.html">Using Impala to Query Kudu Tables</a></li><li><a href="../topics/impala_hbase.html">HBase Tables</a></li><li><a href="../topics/impala_iceberg.html">Iceberg Tables</a></li><li><a href="../topics/impala_s3.html">S3 Tables</a></li><li><a href="../topics/impala_adls.html">ADLS Tables</a></li><li><a href="../topics/impala_isilon.html">Isilon Storage</a></li><li><a href="../topics/impala_logging.html">Logging</a></li><li><a href="../topics/impala_client.html">Client Access</a></li><li><a href="../topics/impala_fault_tolerance.html">Fault Tolerance</a><ul><li class="active"><a href="../topics/impala_transparent_query_retries.html">Impala Transparent Query Retries</a></li><li><a href="../topics/impala_node_blacklisting.html">Impala Node Blacklisting</a></li></ul></li><li><a href="../topics/impala_troubleshooting.html">Troubleshooting Impala</a></li><li><a href="../topics/impala_ports.html">Ports Used by Impala</a></li><li><a href="../topics/impala_reserved_words.html">Impala Reserved Words</a></li><li><a href="../topics/impala_faq.html">Impala Frequently Asked Questions</a></li><li><a href="../topics/impala_release_notes.html">Impala Release Notes</a></li></ul></nav><main role="main"><article role="article" aria-labelledby="ariaid-title1">
  <h1 class="title topictitle1" id="ariaid-title1">Impala Transparent Query Retries</h1>
  <div class="body conbody">
    <p class="p">Transparent query retries will automatically retry any queries that fail
      due to cluster membership changes. A cluster membership change typically
      entails a node leaving the cluster before it crashed or for some other
      reason stopped responding to statestore heartbeats.</p>
    <p class="p">Traditionally, if a query runs on a node in the Impala cluster, and that
      node crashes, then the query will fail and it is up to the user to retry
      the query. With transparent query retries, the query will be automatically
      retried.</p>
    <ul class="ul">
      <li class="li">Queries are only retried if the query failed due to a cluster membership
        change. Trivial failures, like SQL parsing exceptions are <strong class="ph b">not</strong>
        retried.</li>
      <li class="li">Cluster membership changes fall into two categories: membership updates
        from the statestore or node blacklisting events. <p class="p">impalads periodically
        send heartbeats to the statestore, if an impalad stops sending heartbeats
        to the statestore then that impalad is removed from the cluster
        membership</p><p class="p">Node blacklisting events occur when a query fails and as
        a result, an impalad in the cluster is added to the Coordinator's node
        blacklist. In this scenario, the query is retried.</p></li>
      <li class="li">For most users, query retries will be completely transparent, but
        users who want to know why a retry was necessary can use runtime profiles.
        Each query attempt is modelled as a completely new query. Thus, each query
        attempt has its own runtime profiles. Users can look through the profiles
        of the failed query attempts to determine why the query was retried.</li>
    </ul>
    <p class="p">Transparent query retries are turned off by default, but can be enabled via
      the <code class="ph codeph">RETRY_FAILED_QUERIES</code> query option.</p>
    <section class="section">
      <p class="p"><strong class="ph b">Related information:</strong>
        <a class="xref" href="impala_retry_failed_queries.html#RETRY_FAILED_QUERIES">RETRY_FAILED_QUERIES Query Option</a></p>
    </section>
  </div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../topics/impala_fault_tolerance.html">Impala Fault Tolerance</a></div></div></nav></article></main></body></html>