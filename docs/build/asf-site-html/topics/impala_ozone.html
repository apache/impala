<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2024"><meta name="DC.rights.owner" content="(C) Copyright 2024"><meta name="DC.Type" content="concept"><meta name="prodname" content="Impala"><meta name="prodname" content="Impala"><meta name="version" content="Impala 3.4.x"><meta name="version" content="Impala 3.4.x"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="impala_ozone"><link rel="stylesheet" type="text/css" href="../css/commonltr.css"><link rel="stylesheet" type="text/css" href="../css/dita-ot-doc.css"><title>Using Impala with Apache Ozone Storage</title></head><body id="impala_ozone"><header role="banner"><!--
The DITA Open Toolkit is licensed for use under the the Apache
Software Foundation License v2.0.

A copy of the Apache Software Foundation License 2.0 is
available at http://opensource.org/licenses/apache2.0.php

This statement must be included in any copies of DITA Open
Toolkit code.
--><div class="header">
  <p>Apache Impala</p>
  <hr>
</div></header><nav role="toc"><ul><li><a href="../topics/impala_intro.html">Introducing Apache Impala</a></li><li><a href="../topics/impala_concepts.html">Concepts and Architecture</a></li><li><a href="../topics/impala_planning.html">Deployment Planning</a></li><li><a href="../topics/impala_install.html">Installing Impala</a></li><li><a href="../topics/impala_config.html">Managing Impala</a></li><li><a href="../topics/impala_upgrading.html">Upgrading Impala</a></li><li><a href="../topics/impala_processes.html">Starting Impala</a></li><li><a href="../topics/impala_tutorial.html">Tutorials</a></li><li><a href="../topics/impala_admin.html">Administration</a></li><li><a href="../topics/impala_security.html">Impala Security</a></li><li><a href="../topics/impala_langref.html">SQL Reference</a></li><li><a href="../topics/impala_performance.html">Performance Tuning</a></li><li><a href="../topics/impala_scalability.html">Scalability Considerations</a></li><li><a href="../topics/impala_resource_management.html">Resource Management</a></li><li><a href="../topics/impala_partitioning.html">Partitioning</a></li><li><a href="../topics/impala_file_formats.html">File Formats</a></li><li><a href="../topics/impala_kudu.html">Using Impala to Query Kudu Tables</a></li><li><a href="../topics/impala_hbase.html">HBase Tables</a></li><li><a href="../topics/impala_iceberg.html">Iceberg Tables</a></li><li><a href="../topics/impala_s3.html">S3 Tables</a></li><li><a href="../topics/impala_adls.html">ADLS Tables</a></li><li><a href="../topics/impala_isilon.html">Isilon Storage</a></li><li class="active"><a href="../topics/impala_ozone.html">Ozone Storage</a></li><li><a href="../topics/impala_logging.html">Logging</a></li><li><a href="../topics/impala_client.html">Client Access</a></li><li><a href="../topics/impala_fault_tolerance.html">Fault Tolerance</a></li><li><a href="../topics/impala_troubleshooting.html">Troubleshooting Impala</a></li><li><a href="../topics/impala_ports.html">Ports Used by Impala</a></li><li><a href="../topics/impala_reserved_words.html">Impala Reserved Words</a></li><li><a href="../topics/impala_faq.html">Impala Frequently Asked Questions</a></li><li><a href="../topics/impala_release_notes.html">Impala Release Notes</a></li></ul></nav><main role="main"><article role="article" aria-labelledby="ariaid-title1">

  <h1 class="title topictitle1" id="ariaid-title1">Using Impala with Apache Ozone Storage</h1>

  

  

  <div class="body conbody">

    <p class="p">
      
      You can use Impala to query data files that reside on Apache Ozone distributed storage,
      rather than in HDFS. The combination of the Impala query engine and Apache Ozone storage
      is certified on <span class="keyword">Impala 4.2</span> or higher.
    </p>

    <p class="p">
      For more information on Ozone, see <a class="xref" href="https://ozone.apache.org" target="_blank">the Apache Ozone site</a>.
    </p>

    <p class="p">
      The typical use case for Impala and Ozone together is to use Ozone for the default
      filesystem, replacing HDFS entirely. In this configuration, when you create a database,
      table, or partition, the data always resides on Ozone storage and you do not need to
      specify any special <code class="ph codeph">LOCATION</code> attribute. If you do specify a
      <code class="ph codeph">LOCATION</code> attribute, its value refers to a path within the Ozone
      filesystem. For example:
    </p>

<pre class="pre codeblock"><code>-- If the default filesystem is Ozone, all Impala data resides there
-- and all Impala databases and tables are located there.
CREATE TABLE t1 (x INT, s STRING);

-- You can specify LOCATION for database, table, or partition,
-- using values from the Ozone filesystem.
CREATE DATABASE d1 LOCATION '/some/path/on/ozone/server/d1.db';
CREATE TABLE d1.t2 (a TINYINT, b BOOLEAN);
</code></pre>

    <p class="p">
      Impala can write to, delete, and rename data files and database, table, and partition
      directories on Ozone storage. Therefore, Impala statements such as <code class="ph codeph">CREATE
      TABLE</code>, <code class="ph codeph">DROP TABLE</code>, <code class="ph codeph">CREATE DATABASE</code>,
      <code class="ph codeph">DROP DATABASE</code>, <code class="ph codeph">ALTER TABLE</code>, and <code class="ph codeph">INSERT</code>
      work the same with Ozone storage as with HDFS.
    </p>

    <p class="p">
      Ozone supports multiple protocols: <code class="ph codeph">ofs</code>, <code class="ph codeph">o3fs</code>, and
      <code class="ph codeph">s3a</code>. Impala supports reading <code class="ph codeph">ofs</code> and <code class="ph codeph">o3fs</code>.
      Impala can also read <code class="ph codeph">s3a</code> (see <a class="xref" href="impala_s3.html#s3">Using Impala with Amazon S3 Object Store</a>). However
      <code class="ph codeph">ofs</code> is their newer protocol, and the only one Impala supports as a default
      filesystem. We recommend using it for <a class="xref" href="impala_ddl.html#ddl">DDL Statements</a> to avoid access
      limitations, and for <a class="xref" href="impala_dml.html#dml">DML Statements</a> and
      <a class="xref" href="impala_select.html#select">SELECT Statement</a> for performance.
    </p>

    <p class="p">
        Because Apache Ozone storage buckets use a global value for the block size rather than
        a configurable value for each file, the <code class="ph codeph">PARQUET_FILE_SIZE</code> query option
        has no effect when Impala inserts data into a table or partition residing on Ozone
        storage.
      </p>

    <p class="p">
      Impala's spill-to-disk feature may be configured to use Ozone storage by specifying a full
      URI (e.g. <code class="ph codeph">ofs://host:port/volume/bucket/key</code>) for the spill location. See
      <a class="xref" href="impala_disk_space.html#disk_space">Managing Disk Space for Impala Data</a> for details on configuring remote
      spill-to-disk.
    </p>



  </div>

</article></main></body></html>