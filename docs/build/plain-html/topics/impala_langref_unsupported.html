<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2024" />
<meta name="DC.rights.owner" content="(C) Copyright 2024" />
<meta name="DC.Type" content="concept" />
<meta name="DC.Title" content="SQL Differences Between Impala and Hive" />
<meta name="DC.Relation" scheme="URI" content="../topics/impala_langref.html" />
<meta name="prodname" content="Impala" />
<meta name="prodname" content="Impala" />
<meta name="version" content="Impala 3.4.x" />
<meta name="version" content="Impala 3.4.x" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="langref_hiveql_delta" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>SQL Differences Between Impala and Hive</title>
</head>
<body id="langref_hiveql_delta">


  <h1 class="title topictitle1" id="ariaid-title1">SQL Differences Between Impala and Hive</h1>

  

  <div class="body conbody">

    <p class="p">
      
      
      Impala's SQL syntax follows the SQL-92 standard, and includes many industry extensions in areas such as
      built-in functions. See <a class="xref" href="impala_porting.html#porting">Porting SQL from Other Database Systems to Impala</a> for a general discussion of adapting SQL
      code from a variety of database systems to Impala.
    </p>


    <p class="p">
      Because Impala and Hive share the same metastore database and their tables are often used interchangeably,
      the following section covers differences between Impala and Hive in detail.
    </p>


    <p class="p toc inpage"></p>

  </div>


  <div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../topics/impala_langref.html">Impala SQL Language Reference</a></div>
</div>
</div><div class="topic concept nested1" aria-labelledby="ariaid-title2" id="langref_hiveql_unsupported">

    <h2 class="title topictitle2" id="ariaid-title2">HiveQL Features not Available in Impala</h2>


    <div class="body conbody">

      <p class="p">
        The current release of Impala does not support the following SQL features that you might be familiar with
        from HiveQL:
      </p>


      

      <ul class="ul">


        <li class="li">
          Extensibility mechanisms such as <code class="ph codeph">TRANSFORM</code>, custom file formats, or custom SerDes.
        </li>


        <li class="li">
          The <code class="ph codeph">DATE</code> data type.
        </li>


        <li class="li"> XML functions. </li>


        <li class="li">
          Certain aggregate functions from HiveQL: <code class="ph codeph">covar_pop</code>, <code class="ph codeph">covar_samp</code>,
          <code class="ph codeph">corr</code>, <code class="ph codeph">percentile</code>, <code class="ph codeph">percentile_approx</code>,
          <code class="ph codeph">histogram_numeric</code>, <code class="ph codeph">collect_set</code>; Impala supports the set of aggregate
          functions listed in <a class="xref" href="impala_aggregate_functions.html#aggregate_functions">Impala Aggregate Functions</a> and analytic
          functions listed in <a class="xref" href="impala_analytic_functions.html#analytic_functions">Impala Analytic Functions</a>.
        </li>


        <li class="li">
          Sampling.
        </li>


        <li class="li">
          Lateral views. In <span class="keyword">Impala 2.3</span> and higher, Impala supports queries on complex types
          (<code class="ph codeph">STRUCT</code>, <code class="ph codeph">ARRAY</code>, or <code class="ph codeph">MAP</code>), using join notation
          rather than the <code class="ph codeph">EXPLODE()</code> keyword.
          See <a class="xref" href="impala_complex_types.html#complex_types">Complex Types (Impala 2.3 or higher only)</a> for details about Impala support for complex types.
        </li>

      </ul>


      <div class="p">
        User-defined functions (UDFs) are supported starting in Impala 1.2. See <a class="xref" href="impala_udf.html#udfs">User-Defined Functions (UDFs)</a>
        for full details on Impala UDFs.
        <ul class="ul">
          <li class="li">
            <p class="p">
              Impala supports high-performance UDFs written in C++, as well as reusing some Java-based Hive UDFs.
            </p>

          </li>


          <li class="li">
            <p class="p">
              Impala supports scalar UDFs and user-defined aggregate functions (UDAFs). Impala does not currently
              support user-defined table generating functions (UDTFs).
            </p>

          </li>


          <li class="li">
            <p class="p">
              Only Impala-supported column types are supported in Java-based UDFs.
            </p>

          </li>


          <li class="li">
            <p class="p">
        The Hive <code class="ph codeph">current_user()</code> function cannot be called from a Java UDF
        through Impala.
      </p>

          </li>

        </ul>

      </div>


      <p class="p">
        Impala does not currently support these HiveQL statements:
      </p>


      <ul class="ul">
        <li class="li">
          <code class="ph codeph">ANALYZE TABLE</code> (the Impala equivalent is <code class="ph codeph">COMPUTE STATS</code>)
        </li>


        <li class="li">
          <code class="ph codeph">DESCRIBE COLUMN</code>
        </li>


        <li class="li">
          <code class="ph codeph">DESCRIBE DATABASE</code>
        </li>


        <li class="li">
          <code class="ph codeph">EXPORT TABLE</code>
        </li>


        <li class="li">
          <code class="ph codeph">IMPORT TABLE</code>
        </li>


        <li class="li">
          <code class="ph codeph">SHOW TABLE EXTENDED</code>
        </li>


        <li class="li">
          <code class="ph codeph">SHOW TBLPROPERTIES</code>
        </li>


        <li class="li">
          <code class="ph codeph">SHOW INDEXES</code>
        </li>


        <li class="li">
          <code class="ph codeph">SHOW COLUMNS</code>
        </li>


        <li class="li">
          <code class="ph codeph">INSERT OVERWRITE DIRECTORY</code>; use <code class="ph codeph">INSERT OVERWRITE <var class="keyword varname">table_name</var></code>
          or <code class="ph codeph">CREATE TABLE AS SELECT</code> to materialize query results into the HDFS directory associated
          with an Impala table.
        </li>

      </ul>

      <p class="p">
        Impala respects the <code class="ph codeph">serialization.null.format</code> table
        property only for TEXT tables and ignores the property for Parquet and
        other formats. Hive respects the <code class="ph codeph">serialization.null.format</code>
        property for Parquet and other formats and converts matching values
        to NULL during the scan. See <a class="xref" href="impala_txtfile.html">Using Text Data Files with Impala Tables</a> for
        using the table property in Impala.
      </p>

    </div>

  </div>


  <div class="topic concept nested1" aria-labelledby="ariaid-title3" id="langref_hiveql_semantics">

    <h2 class="title topictitle2" id="ariaid-title3">Semantic Differences Between Impala and HiveQL Features</h2>


    <div class="body conbody">

      <p class="p">
        This section covers instances where Impala and Hive have similar functionality, sometimes including the
        same syntax, but there are differences in the runtime semantics of those features.
      </p>


      <p class="p">
        <strong class="ph b">Security:</strong>
      </p>


      <p class="p">
        Impala utilizes the <a class="xref" href="http://sentry.apache.org/" target="_blank">Apache
        Ranger </a> authorization framework, which provides fine-grained role-based access control
        to protect data against unauthorized access or tampering.
      </p>


      <p class="p">
        The Hive component now includes Ranger-enabled <code class="ph codeph">GRANT</code>,
        <code class="ph codeph">REVOKE</code>, and <code class="ph codeph">CREATE/DROP ROLE</code> statements. Earlier Hive releases had a
        privilege system with <code class="ph codeph">GRANT</code> and <code class="ph codeph">REVOKE</code> statements that were primarily
        intended to prevent accidental deletion of data, rather than a security mechanism to protect against
        malicious users.
      </p>


      <p class="p">
        Impala can make use of privileges set up through Hive <code class="ph codeph">GRANT</code> and <code class="ph codeph">REVOKE</code> statements.
        Impala has its own <code class="ph codeph">GRANT</code> and <code class="ph codeph">REVOKE</code> statements in Impala 2.0 and higher.
        See <a class="xref" href="impala_authorization.html#authorization">Impala Authorization</a> for the details of authorization in Impala.
      </p>


      <p class="p">
        <strong class="ph b">SQL statements and clauses:</strong>
      </p>


      <p class="p">
        The semantics of Impala SQL statements varies from HiveQL in some cases where they use similar SQL
        statement and clause names:
      </p>


      <ul class="ul">
        <li class="li">
          Impala uses different syntax and names for query hints, <code class="ph codeph">[SHUFFLE]</code> and
          <code class="ph codeph">[NOSHUFFLE]</code> rather than <code class="ph codeph">MapJoin</code> or <code class="ph codeph">StreamJoin</code>. See
          <a class="xref" href="impala_joins.html#joins">Joins in Impala SELECT Statements</a> for the Impala details.
        </li>


        <li class="li">
          Impala does not expose MapReduce specific features of <code class="ph codeph">SORT BY</code>, <code class="ph codeph">DISTRIBUTE
          BY</code>, or <code class="ph codeph">CLUSTER BY</code>.
        </li>


        <li class="li">
          Impala does not require queries to include a <code class="ph codeph">FROM</code> clause.
        </li>

      </ul>


      <p class="p">
        <strong class="ph b">Data types:</strong>
      </p>


      <ul class="ul">
        <li class="li"> Impala supports a limited set of implicit casts. This can help
          avoid undesired results from unexpected casting behavior. <ul class="ul">
            <li class="li"> Impala does not implicitly cast between string and numeric or
              Boolean types. Always use <code class="ph codeph">CAST()</code> for these
              conversions. </li>

            <li class="li"> Impala does perform implicit casts among the numeric types,
              when going from a smaller or less precise type to a larger or more
              precise one. For example, Impala will implicitly convert a
                <code class="ph codeph">SMALLINT</code> to a <code class="ph codeph">BIGINT</code> or
                <code class="ph codeph">FLOAT</code>, but to convert from
                <code class="ph codeph">DOUBLE</code> to <code class="ph codeph">FLOAT</code> or
                <code class="ph codeph">INT</code> to <code class="ph codeph">TINYINT</code> requires a call
              to <code class="ph codeph">CAST()</code> in the query. </li>

            <li class="li"> Impala does perform implicit casts from string to timestamp.
              Impala has a restricted set of literal formats for the
                <code class="ph codeph">TIMESTAMP</code> data type and the
                <code class="ph codeph">from_unixtime()</code> format string; see <a class="xref" href="impala_timestamp.html#timestamp">TIMESTAMP Data Type</a> for details. </li>

          </ul>
<p class="p"> See the topics under <a class="xref" href="impala_datatypes.html#datatypes">Data Types</a> for full details on
            implicit and explicit casting for each data type, and <a class="xref" href="impala_conversion_functions.html#conversion_functions">Impala Type Conversion Functions</a> for
            details about the <code class="ph codeph">CAST()</code> function. </p>

        </li>


        <li class="li">
          Impala does not store or interpret timestamps using the local timezone, to avoid undesired results from
          unexpected time zone issues. Timestamps are stored and interpreted relative to UTC. This difference can
          produce different results for some calls to similarly named date/time functions between Impala and Hive.
          See <a class="xref" href="impala_datetime_functions.html#datetime_functions">Impala Date and Time Functions</a> for details about the Impala
          functions. See <a class="xref" href="impala_timestamp.html#timestamp">TIMESTAMP Data Type</a> for a discussion of how Impala handles
          time zones, and configuration options you can use to make Impala match the Hive behavior more closely
          when dealing with Parquet-encoded <code class="ph codeph">TIMESTAMP</code> data or when converting between
          the local time zone and UTC.
        </li>


        <li class="li">
          The Impala <code class="ph codeph">TIMESTAMP</code> type can represent dates ranging from 1400-01-01 to 9999-12-31.
          This is different from the Hive date range, which is 0000-01-01 to 9999-12-31.
        </li>


        <li class="li">
          <p class="p">
        Impala does not return column overflows as <code class="ph codeph">NULL</code>, so that customers can
        distinguish between <code class="ph codeph">NULL</code> data and overflow conditions similar to how
        they do so with traditional database systems. Impala returns the largest or smallest
        value in the range for the type. For example, valid values for a
        <code class="ph codeph">tinyint</code> range from -128 to 127. In Impala, a <code class="ph codeph">tinyint</code>
        with a value of -200 returns -128 rather than <code class="ph codeph">NULL</code>. A
        <code class="ph codeph">tinyint</code> with a value of 200 returns 127.
      </p>

        </li>


      </ul>


      <p class="p">
        <strong class="ph b">Miscellaneous features:</strong>
      </p>


      <ul class="ul">
        <li class="li">
          Impala does not provide virtual columns.
        </li>


        <li class="li">
          Impala does not expose locking.
        </li>


        <li class="li">
          Impala does not expose some configuration properties.
        </li>

      </ul>

    </div>

  </div>

</body>
</html>