<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2019" />
<meta name="DC.rights.owner" content="(C) Copyright 2019" />
<meta name="DC.Type" content="concept" />
<meta name="DC.Title" content="Components of the Impala Server" />
<meta name="DC.Relation" scheme="URI" content="../topics/impala_concepts.html" />
<meta name="prodname" content="Impala" />
<meta name="prodname" content="Impala" />
<meta name="prodname" content="Impala" />
<meta name="prodname" content="Impala" />
<meta name="prodname" content="Impala" />
<meta name="version" content="Impala 3.3.x" />
<meta name="version" content="Impala 3.3.x" />
<meta name="version" content="Impala 3.3.x" />
<meta name="version" content="Impala 3.3.x" />
<meta name="version" content="Impala 3.3.x" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="intro_components" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Components of the Impala Server</title>
</head>
<body id="intro_components">


  <h1 class="title topictitle1" id="ariaid-title1">Components of the Impala Server</h1>

  
  

  <div class="body conbody">

    <p class="p"> The Impala server is a distributed, massively parallel processing (MPP)
      database engine. It consists of different daemon processes that run on
      specific hosts within your cluster. </p>


    <p class="p toc inpage"></p>

  </div>


  <div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../topics/impala_concepts.html">Impala Concepts and Architecture</a></div>
</div>
</div><div class="topic concept nested1" aria-labelledby="ariaid-title2" id="intro_impalad">

    <h2 class="title topictitle2" id="ariaid-title2">The Impala Daemon</h2>


    <div class="body conbody">

      <div class="p"> The core Impala component is the Impala daemon, physically represented
        by the <code class="ph codeph">impalad</code> process. A few of the key functions that
        an Impala daemon performs are:<ul class="ul">
          <li class="li">Reads and writes to data files.</li>

          <li class="li">Accepts queries transmitted from the <code class="ph codeph">impala-shell</code>
            command, Hue, JDBC, or ODBC.</li>

          <li class="li">Parallelizes the queries and distributes work across the
            cluster.</li>

          <li class="li">Transmits intermediate query results back to the central
            coordinator. </li>

        </ul>
</div>

      <div class="p">Impala daemons can be deployed in one of the following ways:<ul class="ul">
          <li class="li">HDFS and Impala are co-located, and each Impala daemon runs on the
            same host as a DataNode.</li>

          <li class="li">Impala is deployed separately in a compute cluster and reads
            remotely from HDFS, S3, ADLS, etc.</li>

        </ul>
</div>


      <p class="p"> The Impala daemons are in constant communication with StateStore, to
        confirm which daemons are healthy and can accept new work. </p>


      <p class="p"> They also receive broadcast messages from the
          <span class="keyword cmdname">catalogd</span> daemon (introduced in Impala 1.2) whenever
        any Impala daemon in the cluster creates, alters, or drops any type of
        object, or when an <code class="ph codeph">INSERT</code> or <code class="ph codeph">LOAD DATA</code>
        statement is processed through Impala. This background communication
        minimizes the need for <code class="ph codeph">REFRESH</code> or <code class="ph codeph">INVALIDATE
          METADATA</code> statements that were needed to coordinate metadata
        across Impala daemons prior to Impala 1.2. </p>


      <p class="p">
        In <span class="keyword">Impala 2.9</span> and higher, you can control which hosts act as query coordinators
        and which act as query executors, to improve scalability for highly concurrent workloads on large clusters.
        See <a class="xref" href="impala_dedicated_coordinator.html">How to Configure Impala with Dedicated Coordinators</a> for details.
      </p>


      <p class="p">
        <strong class="ph b">Related information:</strong> <a class="xref" href="impala_config_options.html#config_options">Modifying Impala Startup Options</a>,
        <a class="xref" href="impala_processes.html#processes">Starting Impala</a>, <a class="xref" href="impala_timeouts.html#impalad_timeout">Setting the Idle Query and Idle Session Timeouts for impalad</a>,
        <a class="xref" href="impala_ports.html#ports">Ports Used by Impala</a>, <a class="xref" href="impala_proxy.html#proxy">Using Impala through a Proxy for High Availability</a>
      </p>

    </div>

  </div>


  <div class="topic concept nested1" aria-labelledby="ariaid-title3" id="intro_statestore">

    <h2 class="title topictitle2" id="ariaid-title3">The Impala Statestore</h2>


    <div class="body conbody">

      <p class="p"> The Impala component known as the StateStore checks on the health of
        all Impala daemons in a cluster, and continuously relays its findings to
        each of those daemons. It is physically represented by a daemon process
        named <code class="ph codeph">statestored</code>. You only need such a process on one
        host in a cluster. If an Impala daemon goes offline due to hardware
        failure, network error, software issue, or other reason, the StateStore
        informs all the other Impala daemons so that future queries can avoid
        making requests to the unreachable Impala daemon. </p>


      <p class="p"> Because the StateStore's purpose is to help when things go wrong and
        to broadcast metadata to coordinators, it is not always critical to the
        normal operation of an Impala cluster. If the StateStore is not running
        or becomes unreachable, the Impala daemons continue running and
        distributing work among themselves as usual when working with the data
        known to Impala. The cluster just becomes less robust if other Impala
        daemons fail, and metadata becomes less consistent as it changes while
        the StateStore is offline. When the StateStore comes back online, it
        re-establishes communication with the Impala daemons and resumes its
        monitoring and broadcasting functions. </p>


      <p class="p"> If you issue a DDL statement while the StateStore is down, the queries
        that access the new object the DDL created will fail. </p>


      <p class="p">
        Most considerations for load balancing and high availability apply to the
        <span class="keyword cmdname">impalad</span> daemon. The <span class="keyword cmdname">statestored</span> and
        <span class="keyword cmdname">catalogd</span> daemons do not have special requirements for high
        availability, because problems with those daemons do not result in data loss. If those
        daemons become unavailable due to an outage on a particular host, you can stop the
        Impala service, delete the <span class="ph uicontrol">Impala StateStore</span> and
        <span class="ph uicontrol">Impala Catalog Server</span> roles, add the roles on a different host,
        and restart the Impala service.
      </p>


      <p class="p">
        <strong class="ph b">Related information:</strong>
      </p>


      <p class="p">
        <a class="xref" href="impala_scalability.html#statestore_scalability">Scalability Considerations for the Impala Statestore</a>,
        <a class="xref" href="impala_config_options.html#config_options">Modifying Impala Startup Options</a>, <a class="xref" href="impala_processes.html#processes">Starting Impala</a>,
        <a class="xref" href="impala_timeouts.html#statestore_timeout">Increasing the Statestore Timeout</a>, <a class="xref" href="impala_ports.html#ports">Ports Used by Impala</a>
      </p>

    </div>

  </div>


  <div class="topic concept nested1" aria-labelledby="ariaid-title4" id="intro_catalogd">

    <h2 class="title topictitle2" id="ariaid-title4">The Impala Catalog Service</h2>


    <div class="body conbody">

      <p class="p"> The Impala component known as the Catalog Service relays the metadata
        changes from Impala SQL statements to all the Impala daemons in a
        cluster. It is physically represented by a daemon process named
          <code class="ph codeph">catalogd</code>. You only need such a process on one host in
        a cluster. Because the requests are passed through the StateStore
        daemon, it makes sense to run the <span class="keyword cmdname">statestored</span> and
          <span class="keyword cmdname">catalogd</span> services on the same host. </p>


      <p class="p"> The catalog service avoids the need to issue <code class="ph codeph">REFRESH</code>
        and <code class="ph codeph">INVALIDATE METADATA</code> statements when the metadata
        changes are performed by statements issued through Impala. When you
        create a table, load data, and so on through Hive, you do need to issue
          <code class="ph codeph">REFRESH</code> or <code class="ph codeph">INVALIDATE METADATA</code> on an
        Impala daemon before executing a query there. </p>


      <p class="p">
        This feature touches a number of aspects of Impala:
      </p>


      <ul class="ul" id="intro_catalogd__catalogd_xrefs">
        <li class="li">
          <p class="p">
            See <a class="xref" href="impala_install.html#install">Installing Impala</a>, <a class="xref" href="impala_upgrading.html#upgrading">Upgrading Impala</a> and
            <a class="xref" href="impala_processes.html#processes">Starting Impala</a>, for usage information for the
            <span class="keyword cmdname">catalogd</span> daemon.
          </p>

        </li>


        <li class="li">
          <p class="p"> The <code class="ph codeph">REFRESH</code> and <code class="ph codeph">INVALIDATE
              METADATA</code> statements are not needed when the
              <code class="ph codeph">CREATE TABLE</code>, <code class="ph codeph">INSERT</code>, or other
            table-changing or data-changing operation is performed through
            Impala. These statements are still needed if such operations are
            done through Hive or by manipulating data files directly in HDFS,
            but in those cases the statements only need to be issued on one
            Impala daemon rather than on all daemons. See <a class="xref" href="impala_refresh.html#refresh">REFRESH Statement</a> and <a class="xref" href="impala_invalidate_metadata.html#invalidate_metadata">INVALIDATE METADATA Statement</a> for
            the latest usage information for those statements. </p>

        </li>

      </ul>


      <div class="p">
        Use <code class="ph codeph">‑‑load_catalog_in_background</code> option to control when the
        metadata of a table is loaded.
        <ul class="ul">
          <li class="li">
            If set to <code class="ph codeph">false</code>, the metadata of a table is loaded when it is
            referenced for the first time. This means that the first run of a particular query
            can be slower than subsequent runs. Starting in Impala 2.2, the default for
            <code class="ph codeph">‑‑load_catalog_in_background</code> is <code class="ph codeph">false</code>.
          </li>


          <li class="li">
            If set to <code class="ph codeph">true</code>, the catalog service attempts to load metadata for a
            table even if no query needed that metadata. So metadata will possibly be already
            loaded when the first query that would need it is run. However, for the following
            reasons, we recommend not to set the option to <code class="ph codeph">true</code>.
            <ul class="ul">
              <li class="li">
                Background load can interfere with query-specific metadata loading. This can
                happen on startup or after invalidating metadata, with a duration depending on
                the amount of metadata, and can lead to a seemingly random long running queries
                that are difficult to diagnose.
              </li>


              <li class="li">
                Impala may load metadata for tables that are possibly never used, potentially
                increasing catalog size and consequently memory usage for both catalog service
                and Impala Daemon.
              </li>

            </ul>

          </li>

        </ul>

      </div>


      <p class="p">
        Most considerations for load balancing and high availability apply to the
        <span class="keyword cmdname">impalad</span> daemon. The <span class="keyword cmdname">statestored</span> and
        <span class="keyword cmdname">catalogd</span> daemons do not have special requirements for high
        availability, because problems with those daemons do not result in data loss. If those
        daemons become unavailable due to an outage on a particular host, you can stop the
        Impala service, delete the <span class="ph uicontrol">Impala StateStore</span> and
        <span class="ph uicontrol">Impala Catalog Server</span> roles, add the roles on a different host,
        and restart the Impala service.
      </p>


      <div class="note note"><span class="notetitle">Note:</span> 
        <p class="p">
        In Impala 1.2.4 and higher, you can specify a table name with <code class="ph codeph">INVALIDATE
        METADATA</code> after the table is created in Hive, allowing you to make individual
        tables visible to Impala without doing a full reload of the catalog metadata. Impala
        1.2.4 also includes other changes to make the metadata broadcast mechanism faster and
        more responsive, especially during Impala startup. See
        <a class="xref" href="../shared/../topics/impala_new_features.html#new_features_124">New Features in Impala 1.2.4</a> for details.
      </p>

      </div>


      <p class="p">
        <strong class="ph b">Related information:</strong> <a class="xref" href="impala_config_options.html#config_options">Modifying Impala Startup Options</a>,
        <a class="xref" href="impala_processes.html#processes">Starting Impala</a>, <a class="xref" href="impala_ports.html#ports">Ports Used by Impala</a>
      </p>

    </div>

  </div>

</body>
</html>